<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Ricardo Pérez López">
  <title>Programación orientada a objetos (II)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=1280">
  <link rel="stylesheet" href="./reveal.js/dist/reset.css">
  <link rel="stylesheet" href="./reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #268bd2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #cb4b16; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #d33682; } /* BaseN */
    code span.bu { color: #4070a0; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #dc322f; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #93a1a1; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #6c71c4; } /* DataType */
    code span.dv { color: #d33682; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #d33682; } /* Float */
    code span.fu { color: #4070a0; } /* Function */
    code span.im { font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #268bd2; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #a57800; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #2aa198; } /* SpecialString */
    code span.st { color: #2aa198; } /* String */
    code span.va { color: #6c71c4; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="./reveal.js/dist/theme/solarized.css" id="theme">
  <link rel="stylesheet" href="custom.css"/>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
  <style type="text/css">
      #header-left {
          position: absolute;
          font-size: 25%;
          top: 0%;
          left: 0%;
          margin-left: 10px;
          margin-top: 10px;
      }
      #header-right {
          position: absolute;
          font-size: 25%;
          top: 0%;
          right: 0%;
          margin-right: 10px;
          margin-top: 10px;
      }
      #footer-left {
          position: absolute;
          font-size: 25%;
          bottom: 0%;
          left: 0%;
          margin-left: 10px;
          margin-bottom: 10px;
      }
  </style>
</head>
<body>
<div id="hidden" style="display:none;">
    <div id="header">
        <div id="header-left"></div>
        <div id="header-right"></div>
        <div id="footer-left"></div>
    </div>
</div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Programación orientada a objetos (II)</h1>
  <p class="author">Ricardo Pérez López</p>
  <p class="date">IES Doñana, curso 2025/2026</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<ul>
<li><a href="#/identidad-e-igualdad"
id="/toc-identidad-e-igualdad"><span class="toc-section-number">1</span>
Identidad e igualdad</a></li>
<li><a href="#/encapsulación" id="/toc-encapsulación"><span
class="toc-section-number">2</span> Encapsulación</a></li>
<li><a href="#/miembros-de-clase" id="/toc-miembros-de-clase"><span
class="toc-section-number">3</span> Miembros de clase</a></li>
<li><a href="#/clases-genéricas-y-métodos-genéricos"
id="/toc-clases-genéricas-y-métodos-genéricos"><span
class="toc-section-number">4</span> Clases genéricas y métodos
genéricos</a></li>
</ul>
</nav>
</section>

<section>
<section id="identidad-e-igualdad" class="title-slide slide level1"
data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span>
Identidad e igualdad</h1>

</section>
<section id="identidad" class="title-slide slide level2"
data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span>
Identidad</h2>
<ul>
<li><p>Ya hemos dicho que los objetos tienen existencia propia e
independiente.</p></li>
<li><p>La <strong>identidad</strong> describe la propiedad que tienen
los objetos de distinguirse de los demás objetos.</p></li>
</ul>
<div class="caja centered">
<p>Dos objetos del mismo tipo son <strong>idénticos</strong> si un
cambio en cualquiera de los dos objetos provoca también el mismo cambio
en el otro objeto.</p>
</div>
<ul>
<li><p>Dicho de otra forma: dos objetos son idénticos si son
intercambiables en el código fuente del programa sin que se vea afectado
el comportamiento del mismo.</p></li>
<li><p>Intuitivamente, se refiere al hecho de que los dos objetos sean
en realidad <strong><em>el mismo</em> objeto</strong>.</p></li>
<li><p>Es evidente que <strong>dos objetos de distinto tipo no pueden
ser idénticos</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.1">

<ul>
<li><p>Cuando introducimos mutabilidad y estado en nuestro modelo
computacional, muchos conceptos que antes eran sencillos se vuelven
problemáticos.</p></li>
<li><p>Entre ellos, el problema de determinar si dos objetos son «el
mismo objeto», es decir, si son <em>idénticos</em>.</p></li>
<li><p>De hecho, el problema de la identidad no se da con objetos
inmutables.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.2">

<ul>
<li><p>Por ejemplo, supongamos que hacemos:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> restador(cantidad):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> aux(otro):</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> otro <span class="op">-</span> cantidad</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aux</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>res1 <span class="op">=</span> restador(<span class="dv">25</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>res2 <span class="op">=</span> restador(<span class="dv">25</span>)</span></code></pre></div></li>
<li><p>¿Son <code>res1</code> y <code>res2</code> el mismo objeto?</p>
<ul>
<li><p>Es razonable decir que sí, ya que tanto <code>res1</code> como
<code>res2</code> se comportan siempre de la misma forma (las dos son
funciones que restan <code
class="sourceCode python"><span class="dv">25</span></code> a su
argumento).</p></li>
<li><p>De hecho, <code>res1</code> puede sustituirse por
<code>res2</code> (y viceversa) en cualquier lugar del programa sin que
afecte a su funcionamiento.</p></li>
</ul></li>
<li><p>Como los objetos así creados son <strong>inmutables</strong> y se
han creado iguales, no importa demasiado si son el mismo objeto o
no.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.3">

<ul>
<li><p>En cambio, supongamos que hacemos dos llamadas a <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dep2 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div></li>
<li><p>¿Son <code>dep1</code> y <code>dep2</code> el mismo objeto?</p>
<ul>
<li><p>Evidentemente no, ya que podemos obtener resultados distintos al
enviarles el mismo mensaje (uno que sabemos que no cambia el estado del
objeto):</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.retirar(<span class="dv">20</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dv">80</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.saldo()  <span class="co"># Mensaje que no cambia el estado del objeto</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dv">80</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.saldo()  <span class="co"># El mismo mensaje, da un resultado distinto en dep2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code></pre></div></li>
<li><p>Incluso aunque podamos pensar que <code>dep1</code> y
<code>dep2</code> son «iguales», en el sentido de que ambos han sido
creados evaluando la misma expresión (<code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>),
no podemos sustituir <code>dep1</code> por <code>dep2</code> (o
viceversa) en ninguna parte del programa sin afectar a su
funcionamiento.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.4">

<ul>
<li><p>Es otra forma de decir que, en general, <strong>los objetos no
tienen transparencia referencial</strong>, ya que se pierde en el
momento en que incorporamos <strong>estado y mutabilidad</strong> en
nuestro modelo computacional.</p></li>
<li><p>Pero al perder la transparencia referencial, se vuelve más
difícil de definir de una manera formal y rigurosa qué es lo que
significa que dos objetos sean «el mismo objeto».</p></li>
<li><p>De hecho, el significado de «el mismo» en el mundo real que
estamos modelando con nuestro programa es ya bastante difícil de
entender.</p></li>
<li><p>En general, sólo podemos determinar si dos objetos aparentemente
idénticos son realmente «el mismo objeto» modificando uno de ellos y
observando a continuación si el otro ha cambiado de la misma
forma.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.5">

<ul>
<li><p>Pero la única manera de saber si un objeto ha «cambiado» es
observando el «mismo» objeto dos veces, en dos momentos diferentes, y
comprobando si ha cambiado alguna propiedad del objeto de la primera
observación a la segunda.</p></li>
<li><p>Por tanto, no podemos determinar si ha habido un «cambio» si no
podemos determinar a priori si dos objetos son «el mismo», y no podemos
determinar si son el mismo si no podemos observar los efectos de ese
cambio.</p></li>
<li><p>Esto nos lleva a una definición circular, donde un término
depende del otro y viceversa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.6">

<ul>
<li><p>Por ejemplo, supongamos que Pedro y Pablo tienen un depósito con
100 € cada uno.</p></li>
<li><p>Si los creamos así:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dep_Pedro <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dep_Pablo <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div>
<p>estaremos creando dos depósitos separados e independientes.</p>
<p>Por tanto, las operaciones realizadas en el depósito de Pedro no
afectarán al de Pablo, y viceversa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.7">

<ul>
<li><p>En cambio, si los creamos así:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dep_Pedro <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dep_Pablo <span class="op">=</span> dep_Pedro</span></code></pre></div>
<p>estamos definiendo a <code>dep_Pablo</code> para que sea exactamente
el mismo objeto que <code>dep_Pedro</code>.</p>
<p>Por tanto, ahora Pedro y Pablo son cotitulares de un mismo depósito
compartido, y si Pedro hace una retirada de efectivo a través de
<code>dep_Pedro</code>, Pablo observará que hay menos dinero en
<code>dep_Pablo</code> (porque son <em>el mismo</em> depósito).</p></li>
</ul>
<!--

- Hay una enorme diferencia entre crearlos así:

  ```python
  dep_Pedro = Deposito(100)
  dep_Pablo = Deposito(100)
  ```

  y crearlos así:

  ```python
  dep_Pedro = Deposito(100)
  dep_Pablo = dep_Pedro
  ```

- En el primer caso, los dos depósitos son distintos.

  - Por tanto, las operaciones
    realizadas en el depósito de Pedro no afectarán al de Pablo, y viceversa.

- En el segundo caso, en cambio, hemos definido a `dep_Pablo` para que sea
  exactamente la misma cosa que `dep_Pedro`.

  - Por tanto, ahora Pedro y Pablo son cotitulares de un mismo depósito
    compartido, y si Pedro hace una retirada de efectivo a través de `dep_Pedro`,
    Pablo observará que hay menos dinero en `dep_Pablo` (porque son _el mismo_
    depósito).

-->
</section>
<section class="slide level5" data-number="1.1.0.0.8">

<ul>
<li><p>Estas dos situaciones, similares pero distintas, pueden provocar
confusión al crear modelos computacionales.</p></li>
<li><p>En concreto, con el depósito compartido puede ser especialmente
confuso el hecho de que haya un objeto (el depósito) con dos nombres
distintos (<code>dep_Pedro</code> y <code>dep_Pablo</code>).</p></li>
<li><p>Si estamos buscando todos los sitios de nuestro programa donde
pueda cambiarse el depósito de <code>dep_Pedro</code>, tendremos que
recordar buscar también los sitios donde se cambie a
<code>dep_Pablo</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.9">

<ul>
<li><p>Los problemas de identidad sólo se da cuando permitimos que los
objetos sean mutables.</p></li>
<li><p>Si Pedro y Pablo sólo pudieran comprobar los saldos de sus
depósitos y no pudieran realizar operaciones que cambiaran sus fondos,
entonces no haría falta comprobar si los dos depósitos son realmente dos
objetos separados o si por el contrario son el mismo depósito. Daría
igual.</p></li>
<li><p>En general, siempre que no se puedan modificar los objetos,
podemos suponer que un objeto compuesto se define e identifica como la
suma de sus partes.</p></li>
<li><p>Pero esto deja de ser válido cuando incorporamos mutabilidad,
porque entonces un objeto compuesto tiene una «identidad» que es algo
diferente de las partes que lo componen.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.10">

<ul>
<li><p>Por ejemplo, un número racional viene definido por su numerador y
su denominador.</p>
<p>El número racional <span class="math inline">\frac{4}{3}</span> está
completamente determinado por su numerador 4 y su denominador 3. Es eso
y nada más.</p></li>
<li><p>Pero no tiene sentido considerar que un número racional es un
objeto mutable con identidad propia, puesto que si pudiéramos cambiar su
numerador o su denominador ya no tendríamos «el mismo» número racional,
sino que tendríamos otro diferente.</p>
<p>Si al racional <span class="math inline">\frac{4}{3}</span> le
cambiamos el numerador 4 por 5, obtendríamos el nuevo racional <span
class="math inline">\frac{5}{3}</span>, y no tendría sentido decir que
ese nuevo racional es el antiguo racional <span
class="math inline">\frac{4}{3}</span> modificado. Éste ya no
está.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.11">

<ul>
<li><p>En cambio, un depósito sigue siendo «el mismo» depósito aunque
cambiemos sus fondos haciendo una retirada de efectivo.</p></li>
<li><p>Pero también podemos tener dos depósitos distintos con el mismo
estado interno.</p></li>
<li><p>No olvidemos que dos objetos pueden ser <strong>iguales</strong>
y, en cambio, no ser <em>idénticos</em>.</p></li>
<li><p>Esta complicación es consecuencia, no de nuestro lenguaje de
programación, sino de nuestra percepción del depósito bancario como un
objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.12">

<ul>
<li><p>Como usamos <strong>referencias</strong> para referirnos a un
determinado objeto y acceder al mismo, resulta fácil comprobar si dos
objetos son <em>idénticos</em> (es decir, si son el mismo objeto)
simplemente comparando referencias. <strong>Si las referencias son
iguales, es que estamos ante un único objeto.</strong></p></li>
<li><p>Esto es así ya que, por lo general, las referencias se
corresponden con direcciones de memoria. Es decir: una referencia a un
objeto normalmente representa la dirección de memoria donde se empieza a
almacenar dicho objeto.</p></li>
</ul>
<div class="caja">
<p><strong>Resumiendo:</strong></p>
<ul>
<li><p>Cuando preguntamos si dos objetos son <strong>iguales</strong>,
estamos preguntando si <strong><em>parecen</em> el mismo
objeto</strong>, es decir, si tienen la misma forma y el mismo
contenido.</p></li>
<li><p>Cuando preguntamos si son <strong>idénticos</strong>, estamos
preguntando si <strong><em>son</em> el mismo objeto</strong>.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="1.1.0.0.13">

<ul>
<li><p>La forma de comprobar en Python si dos objetos son
<em>idénticos</em> es usar el operador <code>is</code> que ya
conocemos:</p>
<div class="caja centered">
<p>La expresión <span
class="math inline">\underline{\textbf{\textit{o}}\ \texttt{is}\
\textbf{\textit{p}}}</span> devolverá <code>True</code> si tanto
<strong><em>o</em></strong> como <strong><em>p</em></strong> son
referencias al mismo objeto.</p>
</div></li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> dep1</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="kw">is</span> dep2</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
</ul>
</div><div class="column">
<ul>
<li><p>En cambio:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="kw">is</span> dep2</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
</ul>
</div>
</div>
<ul>
<li><p>Como ya estudiamos en su día, la expresión  <span
class="math inline">\underline{\textbf{\textit{o}}\ \ \texttt{is}\ \
\textbf{\textit{p}}}</span>  equivale a:</p>
<div class="centered">
<p><code>id(</code><em>o</em><code>) == id(</code><em>p</em><code>)</code></p>
</div></li>
<li><p>Por tanto, lo que hace es comparar el resultado de la función
<code>id</code>, que devuelve un identificador único (un número) para
cada objeto.</p></li>
<li><p>Ese identificador es la dirección de memoria donde se almacena el
objeto. Por tanto, es la dirección a donde apuntan sus
referencias.</p></li>
</ul>
</section>

<section id="igualdad" class="title-slide slide level2"
data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span>
Igualdad</h2>
<ul>
<li><p>Supongamos que queremos modelar el funcionamiento de una cola
(una estructura de datos en la que los elementos entran por un lado y
salen por el contrario en el orden en que se han introducido).</p></li>
<li><p>El código podría ser el siguiente, utilizando una lista para
almacenar los elementos:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Cola:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, els):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.items <span class="op">=</span> els</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meter(<span class="va">self</span>, el):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.items.append(el)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sacar(<span class="va">self</span>):</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.items) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Cola vacía&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> <span class="va">self</span>.items[<span class="dv">0</span>]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> elementos(<span class="va">self</span>):</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.items</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.1">

<ul>
<li><p>Si hacemos:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cola1 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cola2 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div>
<p>es evidente que <code>cola1</code> y <code>cola2</code> hacen
referencia a objetos separados y, por tanto, <strong>no son
<em>idénticos</em></strong>, ya que no se refieren <em>al mismo</em>
objeto.</p></li>
<li><p>Aunque no son idénticos, sí podemos decir que <strong>son
<em>iguales</em></strong> ya que pertenecen a la misma clase, poseen el
mismo estado interno (el mismo contenido) y se comportan de la misma
forma al recibir la misma secuencia de mensajes en el mismo orden:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.meter(<span class="dv">9</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.elementos()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.sacar()</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.elementos()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.meter(<span class="dv">9</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.elementos()</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.sacar()</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.elementos()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.2">

<ul>
<li><p>Pero si preguntamos al intérprete si son iguales, nos dice que
no:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
<li><p>Esto se debe a que, en ausencia de otra definición de
<em>igualdad</em> y <strong>mientras no se diga lo contrario, dos
objetos de clases <em>definidas por el programador</em> son iguales sólo
si son idénticos</strong>.</p></li>
<li><p>Es decir: por defecto,  <span
class="math inline">\underline{\textbf{\textit{x}}\ \ \texttt{==}\ \
\textbf{\textit{y}}}</span>  sólo si  <span
class="math inline">\underline{\textbf{\textit{x}}\ \ \texttt{is}\ \
\textbf{\textit{y}}}</span>.</p></li>
<li><p>Esto es lo que técnicamente se denomina <strong>igualdad por
identidad</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.3">

<ul>
<li><p>Para cambiar ese comportamiento predeterminado, tendremos que
definir qué significa que dos instancias de nuestra clase son
iguales.</p></li>
<li><p>Por ejemplo: ¿cuándo podemos decir que dos objetos de la clase
<code>Cola</code> son iguales?</p>
<p>Podemos decir que dos colas son iguales cuando tienen el mismo estado
interno. En este caso: <em>dos colas son iguales cuando tienen los
mismos elementos en el mismo orden</em>.</p></li>
<li><p>Es lo que técnicamente se denomina <strong>igualdad
estructural</strong>.</p></li>
</ul>
</section>
<section id="eq__" class="title-slide slide level3" data-number="1.2.1">
<h3 data-number="1.2.1"><span class="header-section-number">1.2.1</span>
<code>__eq__</code></h3>
<ul>
<li><p>Para implementar nuestra propia lógica de igualdad en nuestra
clase, debemos definir en ella el método mágico <code
class="sourceCode python"><span class="fu">__eq__</span></code>.</p></li>
<li><p>Este método se invoca automáticamente cuando se hace una
comparación con el operador <code>==</code> y el operando izquierdo es
una instancia de nuestra clase. El operando derecho se envía como
argumento en la llamada al método.</p></li>
<li><p>Dicho de otra forma:</p>
<ul>
<li><p>Si la clase de <code>cola1</code> tiene definido el método
<code>__eq__</code>, entonces <code>cola1 == cola2</code> equivale a
<code
class="sourceCode python">cola1.<span class="fu">__eq__</span>(cola2)</code>.</p></li>
<li><p>En caso contrario, <code>cola1 == cola2</code> seguirá valiendo
lo mismo que <code
class="sourceCode python">cola1 <span class="kw">is</span> cola2</code>,
como acabamos de ver.</p></li>
</ul></li>
<li><p>No es necesario definir el operador <code>!=</code>, ya que
Python 3 lo define automáticamente a partir del
<code>==</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.1.0.1">

<ul>
<li><p>Para crear una posible implementación del método <code
class="sourceCode python"><span class="fu">__eq__</span></code>, podemos
aprovecharnos del hecho de que dos listas son iguales cuando tienen
exactamente los mismos elementos en el mismo orden (justo lo que
necesitamos para nuestras colas):</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, otro):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(<span class="va">self</span>) <span class="op">!=</span> <span class="bu">type</span>(otro):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">NotImplemented</span>   <span class="co"># no tiene sentido comparar objetos de distinto tipo</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.items <span class="op">==</span> otro.items  <span class="co"># son iguales si tienen los mismos elementos</span></span></code></pre></div>
<p>Se devuelve el valor especial <code
class="sourceCode python"><span class="va">NotImplemented</span></code>
cuando no tiene sentido comparar un objeto de la clase <code>Cola</code>
con un objeto de otro tipo.</p></li>
<li><p>Si introducimos este método dentro de la definición de la clase
<code>Cola</code>, tendremos el resultado deseado:</p></li>
</ul>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">=</span> Cola([<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">7</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2 <span class="op">=</span> Cola([<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">7</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="kw">is</span> cola2</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div>
</div><div class="column">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.sacar()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.sacar()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div>
</div>
</div>
</section>

<section id="hash__" class="title-slide slide level3"
data-number="1.2.2">
<h3 data-number="1.2.2"><span class="header-section-number">1.2.2</span>
<code>__hash__</code></h3>
<ul>
<li><p>Recordemos lo que ya sabemos:</p>
<ul>
<li><p>Existen datos <em>hashables</em> y datos <em>no
hashables</em>.</p></li>
<li><p>Los datos <em>hashables</em> son aquellos que se pueden comparar
entre sí con <code>==</code> y además llevan asociado un número entero
llamado <em>hash</em>.</p></li>
<li><p>Los datos <em>hashables</em> pueden guardarse en un conjunto o
usarse como claves de un diccionario.</p></li>
<li><p>Los datos mutables no pueden ser <em>hashables</em>.</p></li>
<li><p>Si <span class="math inline">x</span> es <em>hashable</em>, <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> debe devolver un número que
nunca cambie durante la vida de <span
class="math inline">x</span>.</p></li>
<li><p>Si <span class="math inline">x</span> no es <em>hashable</em>,
<code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> lanza una excepción <code
class="sourceCode python"><span class="pp">TypeError</span></code>.</p></li>
</ul></li>
<li><p>Lo que hace la función <code
class="sourceCode python"><span class="bu">hash</span></code> es llamar
al método <code
class="sourceCode python"><span class="fu">__hash__</span></code> sobre
su argumento.</p></li>
<li><p>Por tanto, la llamada a <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> es equivalente a hacer <span
class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.1">

<ul>
<li><p>Los métodos <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> están
relacionados entre sí, porque siempre se tiene que cumplir la siguiente
condición:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> debe ser igual que <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Por tanto, siempre se tiene que cumplir que:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <span
class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
<code>==</code> <span class="math inline">y</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>.</p>
</div></li>
<li><p>Lo que equivale también a decir que:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
<code>!=</code> <span class="math inline">y</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>,
entonces <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>.</p>
</div></li>
<li><p>Para ello, debemos tener en cuenta varias consideraciones a la
hora de crear nuestras clases:</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.2">

<ol type="1">
<li><p>Si una clase define su propio método <code
class="sourceCode python"><span class="fu">__hash__</span></code>, debe
definir también un <code
class="sourceCode python"><span class="fu">__eq__</span></code> que vaya
a juego con el <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p>
<p>Por tanto (<em>contrarrecíproco</em> del anterior), si una clase no
define su propio método <code
class="sourceCode python"><span class="fu">__eq__</span></code>, tampoco
debe definir su propio método <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p></li>
<li><p>Las clases definidas por el programador ya traen de serie una
implementación predefinida de <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> que
cumplen que:</p>
<ul>
<li><p><span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span> sólo si <span class="math inline">x</span>
<code class="sourceCode python"><span class="kw">is</span></code> <span
class="math inline">y</span>, como ya vimos antes.</p></li>
<li><p><span class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
devuelve un valor que garantiza que si <span
class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p></li>
</ul>
<p>(Esto se debe a que la clase <em>hereda</em> los métodos <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> de la
clase <code
class="sourceCode python"><span class="bu">object</span></code>, como
veremos en la siguiente unidad.)</p></li>
</ol>
</section>
<section class="slide level5" data-number="1.2.2.0.3">

<ol start="3" type="1">
<li><p>Si una clase no define <code
class="sourceCode python"><span class="fu">__eq__</span></code> pero no
se desea que sus instancias sean <em>hashables</em>, debe definir su
método <code
class="sourceCode python"><span class="fu">__hash__</span></code> como
<code class="sourceCode python"><span class="va">None</span></code>
incluyendo la sentencia:</p>
<div class="centered">
<p><code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code></p>
</div>
<p>en la definición de la clase.</p></li>
<li><p>Si una clase define <code
class="sourceCode python"><span class="fu">__eq__</span></code> pero no
define <code
class="sourceCode python"><span class="fu">__hash__</span></code>, es
como si implícitamente hubiera definido <code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code> (lo hace
el intérprete internamente).</p>
<p>Por tanto, en ese caso sus instancias no serán
<em>hashables</em>.</p></li>
<li><p>Si las instancias de la clase son mutables y ésta define <code
class="sourceCode python"><span class="fu">__eq__</span></code>, lo
normal es que no defina <code
class="sourceCode python"><span class="fu">__hash__</span></code>, ya
que los objetos mutables no son <em>hashables</em>, en general.</p>
<p>No obstante, hay casos particulares de objetos mutables que pueden
ser <em>hashables</em>, como veremos en breve.</p></li>
</ol>
</section>
<section class="slide level5" data-number="1.2.2.0.4">

<ul>
<li><p>Hemos dicho que la condición principal que se tiene que cumplir
es que:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Y, por tanto, se tiene que cuplir su contrarrecíproco, que
es:</p>
<div class="centered">
<p>Si <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>, entonces <span
class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>.</p>
</div></li>
<li><p>Lo cual NO significa que se tenga que cumplir que:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Sin embargo, aunque no sea necesario que se cumpla, a efectos
prácticos sí que resulta conveniente cumplir la condición anterior en la
medida de lo posible, ya que de esta forma ganaremos en eficiencia
cuando intentemos acceder a nuestros objetos de manera directa si los
almacenamos en una colección.</p></li>
<li><p>Por desgracia, resulta prácticamente imposible poder cumplir la
condición anterior para todos los objetos, pero aún así deberíamos
intentar que nuestro algoritmo de <em>hashing</em> cumpla dicha
condición con el mayor número de objetos posible.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.5">

<ul>
<li><p>Cuando esa condición no se cumple, tenemos lo que se llama una
<strong>colisión</strong>.</p></li>
<li><p>Es decir: tenemos una colisión cuando varios objetos distintos
tienen el mismo valor de <em>hash</em>.</p></li>
<li><p>En tal caso, tenemos que:</p>
<div class="centered">
<p><span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, pero <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Como dijimos antes, las colisiones son prácticamente inevitables,
pero hay que procurar implementar nuestro <code
class="sourceCode python"><span class="fu">__hash__</span></code> de
forma que se produzcan lo menos posible, ya que mejora el
rendimiento.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.6">

<ul>
<li><p>Dicho de otra forma, nuestro <code
class="sourceCode python"><span class="fu">__hash__</span></code> debe
cumplir <strong>siempre</strong>:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code></p>
</div>
<p>pero, al mismo tiempo, debe procurar cumplir <strong>siempre que
pueda</strong>:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>En realidad, una buena implementación de <code
class="sourceCode python"><span class="fu">__hash__</span></code> es
aquella que reparte uniformemente los objetos entre los posibles valores
de <em>hash</em>.</p></li>
<li><p>Es decir: la idea principal es que el método <code
class="sourceCode python"><span class="fu">__hash__</span></code> no
asocie muchos objetos a un mismo valor de <em>hash</em> y al mismo
tiempo haya otros valores de <em>hash</em> a los que se les asocien
pocos objetos (o ninguno).</p>
<p>Si muchos objetos tienen el mismo <em>hash</em>, ese reparto no sería
uniforme, sino que estaría muy descompensado, y provocaría un peor
rendimiento en los accesos a los objetos dentro de las
colecciones.</p></li>
<li><p>Por otra parte, el cálculo del <em>hash</em> no debería ser
costoso.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.7">

<ul>
<li><p>Una forma sencilla de crear el <code
class="sourceCode python"><span class="fu">__hash__</span></code> de una
clase sería usar el <code
class="sourceCode python"><span class="bu">hash</span></code> de una
tupla que contenga las variables de estado de la clase (siempre que
estas sean <em>hashables</em> también):</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">hash</span>((<span class="va">self</span>.nombre, <span class="va">self</span>.apellidos))</span></code></pre></div></li>
<li><p>Las colas son mutables y, por tanto, no pueden ser
<em>hashables</em>, así que no definiremos ningún método <code
class="sourceCode python"><span class="fu">__hash__</span></code> en la
clase <code>Cola</code>.</p></li>
<li><p>De esta forma, como sí hemos definido un método <code
class="sourceCode python"><span class="fu">__eq__</span></code> en la
clase, el intérprete automáticamente hará <code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code> y
convertirá a las colas en <em>no hashables</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.8">

<ul>
<li><p>Es importante no romper el contrato entre <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p></li>
<li><p>Es decir, hay que garantizar que si dos objetos son iguales, sus
<em>hash</em> también deben ser iguales.</p></li>
<li><p>De lo contrario, se pueden dar situaciones extrañas:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> random</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Rara:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">return</span> random.randint(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> Rara()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s.add(x)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="kw">in</span> s</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="kw">in</span> s</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.9">

<ul>
<li><p>Aunque los objetos mutables no deberían ser <em>hashables</em>,
existen dos técnicas que nos permiten obtener objetos que sean
simultáneamente mutables y <em>hashables</em>:</p>
<ul>
<li><p>Implementando <strong>igualdad estructural</strong> por
comparación entre atributos inmutables y calculando el <em>hash</em> a
partir de esos atributos.</p></li>
<li><p>Implementando <strong>igualdad por identidad</strong> y
calculando el <em>hash</em> a partir de la identidad del
objeto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.10">

<ul>
<li><p>Si entre los atributos de un objeto hay un subconjunto de ellos
que nunca cambian, se puede implementar <strong>igualidad
estructural</strong> mediante la comparación de esos atributos.</p></li>
<li><p>En tal caso, el <em>hash</em> se puede calcular a partir de esos
atributos que nunca cambian.</p></li>
<li><p>Por ejemplo, si el DNI de una persona nunca cambia, podríamos
usarlo para comprobar si dos personas son iguales y además calcular su
<em>hash</em>:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dni, nombre):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, otro):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(<span class="va">self</span>) <span class="op">!=</span> <span class="bu">type</span>(otro):</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">NotImplemented</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__dni <span class="op">==</span> otro.__dni</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">hash</span>(<span class="va">self</span>.__dni)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span></code></pre></div></li>
<li><p>Así, las instancias de <code>Persona</code> serán mutables y
también <em>hashables</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.2.0.11">

<ul>
<li><p>Por otra parte, como vimos anteriormente, si una clase no
implementa su propia versión de <code
class="sourceCode python"><span class="fu">__eq__</span></code> y no
define <code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code>,
entonces:</p>
<ul>
<li><p>Implementa <strong>igualidad por identidad</strong>, de manera
que dos instancias de la clase serán iguales sólo si son idénticos
(<span class="math inline">\underline{\textbf{\textit{x}}\ \
\texttt{==}\ \ \textbf{\textit{y}}}</span>  sólo si  <span
class="math inline">\underline{\textbf{\textit{x}}\ \ \texttt{is}\ \
\textbf{\textit{y}}}</span>).</p></li>
<li><p>Sus objetos serán <em>hashables</em>.</p></li>
<li><p>El <em>hash</em> de sus instancias se calculará a partir de sus
identidades.</p></li>
</ul></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dni, nombre):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_dni(<span class="va">self</span>, dni):</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span></code></pre></div></li>
<li><p>Esta es otra forma de tener objetos mutables y
<em>hashables</em>.</p></li>
</ul>
</section>


<section id="otros-métodos-mágicos" class="title-slide slide level2"
data-number="1.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span>
Otros métodos mágicos</h2>

</section>
<section id="repr__" class="title-slide slide level3"
data-number="1.3.1">
<h3 data-number="1.3.1"><span class="header-section-number">1.3.1</span>
<code>__repr__</code></h3>
<ul>
<li>Existe una función llamada <code
class="sourceCode python"><span class="bu">repr</span></code> que
devuelve la <strong>expresión canónica</strong> de un valor, es decir,
la cadena de símbolos que mejor <strong>representa</strong> a ese
valor.</li>
</ul>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;5&#39;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div>
</div><div class="column">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="fl">3.50</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;3.5&#39;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">3.5</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fl">3.5</span></span></code></pre></div>
</div>
</div>
<ul>
<li><p>La expresión que vaya en esa cadena debe ser sintáctica y
semánticamente <strong>correcta</strong> según las reglas del
lenguaje.</p></li>
<li><p>Además, esa expresión debe contener toda la información necesaria
para <strong>reconstruir el valor</strong>.</p></li>
<li><p>El intérprete interactivo de Python usa <code
class="sourceCode python"><span class="bu">repr</span></code> cuando le
pedimos que evalúe una expresión:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span>  <span class="co"># devuelve lo mismo que repr(2 + 3) pero sin comillas</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.1">

<ul>
<li><p>Recordemos que no todo valor tiene expresión canónica; por
ejemplo, las funciones:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="bu">max</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&lt;built-in function max&gt;&#39;</span></span></code></pre></div>
<p>En este caso, lo que nos devuelve <code
class="sourceCode python"><span class="bu">repr</span></code> no tiene
la información suficiente como para construir la función <code
class="sourceCode python"><span class="bu">max</span></code>.</p>
<p>De hecho, ni siquiera es una expresión válida en el lenguaje:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="op">&lt;</span>built<span class="op">-</span><span class="kw">in</span> function <span class="bu">max</span><span class="op">&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>built<span class="op">-</span><span class="kw">in</span> function <span class="bu">max</span><span class="op">&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">^</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.2">

<ul>
<li><p>Al aplicar la función <code
class="sourceCode python"><span class="bu">repr</span></code> sobre una
instancia de una clase definida por el programador, obtenemos una
representación que, en general, no es correcta ni contiene la
información suficiente como para representar al objeto o
reconstruirlo.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&lt;__main__.Deposito object at 0x7fed83fd9160&gt;&#39;</span></span></code></pre></div>
<p>Nos devuelve una cadena que que simplemente nos informa de:</p>
<ul>
<li><p>La clase a la que pertenece el objeto, que se obtiene mediante
<code
class="sourceCode python"><span class="bu">type</span>(dep)</code>.</p></li>
<li><p>El <code
class="sourceCode python"><span class="bu">id</span></code> del objeto
en hexadecimal, que se obtiene mediante <code
class="sourceCode python"><span class="bu">hex</span>(<span class="bu">id</span>(dep))</code>.</p></li>
</ul>
<p>Pero esa cadena no contiene ninguna expresión válida en Python y
tampoco nos dice cuántos fondos contiene el depósito, por ejemplo.</p>
<p>Por tanto, con esa cadena no podemos reconstruir el objeto
<code>dep</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.3">

<ul>
<li><p>En este caso, lo ideal sería que <code
class="sourceCode python"><span class="bu">repr</span>(dep)</code>
devolviera una expresión <strong>no ambigua</strong> con la que
pudiéramos <strong>reconstruir</strong> el objeto <code>dep</code> con
toda la información que contiene (su estado interno).</p></li>
<li><p>Es decir, buscamos algo así:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;Deposito(70)&#39;</span></span></code></pre></div></li>
<li><p>En este último caso, la cadena resultante contiene la expresión
<code
class="sourceCode python">Deposito(<span class="dv">70</span>)</code>,
que sí representa adecuadamente al objeto <code>dep</code>:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">==</span> Deposito(<span class="dv">70</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
<li><p>Es importante no confundir la cadena <code
class="sourceCode python"><span class="st">&#39;Deposito(70)&#39;</span></code>
que devuelve <code
class="sourceCode python"><span class="bu">repr</span></code> con la
expresión <code
class="sourceCode python">Deposito(<span class="dv">70</span>)</code>
que lleva dentro.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.4">

<ul>
<li><p>La función <code
class="sourceCode python"><span class="bu">eval</span></code> en Python
evalúa la expresión contenida en una cadena y devuelve el valor
resultante:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="st">&#39;2 + 3 * 5&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span></code></pre></div></li>
<li><p>Sólo se puede aplicar a cadenas:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: <span class="bu">eval</span>() arg <span class="dv">1</span> must be a string, <span class="bu">bytes</span> <span class="kw">or</span> code <span class="bu">object</span></span></code></pre></div></li>
<li><p>Y esas cadenas tienen que ser sintáctica y semánticamente
correctas:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="st">&#39;2 + * 3 5&#39;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;string&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="op">+</span> <span class="op">*</span> <span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">^</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.5">

<ul>
<li><p>Las funciones <code
class="sourceCode python"><span class="bu">eval</span></code> y <code
class="sourceCode python"><span class="bu">repr</span></code> están
relacionadas de forma que <strong>siempre <em>debería</em> cumplirse lo
siguiente</strong>:</p>
<div class="centered">
<p><code>eval(repr(</code><em>v</em><code>))</code> <code>==</code>
<em>v</em></p>
</div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span>)) <span class="op">==</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
<li><p>En cambio, ahora mismo tenemos que:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(dep)) <span class="op">==</span> dep</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;string&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>__main__.Deposito <span class="bu">object</span> at <span class="bn">0x7fed83fd9160</span><span class="op">&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">^</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.6">

<ul>
<li><p>Lo que hace realmente la expresión <code
class="sourceCode python"><span class="bu">repr</span>(v)</code> es
llamar al método <code
class="sourceCode python"><span class="fu">__repr__</span></code> del
objeto <code>v</code>.</p></li>
<li><p>Por tanto, la siguiente expresión:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">repr</span>(v)</span></code></pre></div>
<p>es equivalente a ésta:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>v.<span class="fu">__repr__</span>()</span></code></pre></div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="dv">25</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (<span class="dv">25</span>).<span class="fu">__repr__</span>()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span></code></pre></div></li>
<li><p>Lo que tenemos que hacer es definir adecuadamente un método <code
class="sourceCode python"><span class="fu">__repr__</span></code> en
nuestra clase <code>Deposito</code>.</p></li>
</ul>
</section>
<section id="ejercicio" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol class="example" type="1">
<li>Inténtalo primero.</li>
</ol>
</section>
<section class="slide level5" data-number="1.3.1.0.7">

<ul>
<li><p>En la clase <code>Deposito</code> podríamos hacer algo así:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Deposito(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>fondos<span class="sc">}</span><span class="ss">)&quot;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... resto del código</span></span></code></pre></div></li>
<li><p>De esta forma, conseguimos el efecto deseado:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;Deposito(70)&#39;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(dep)) <span class="op">==</span> dep</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.8">

<ul>
<li><p>Para implementar el método <code
class="sourceCode python"><span class="fu">__repr__</span></code> de la
clase <code>Persona</code>, podríamos probar a hacer:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dni, nombre):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">hash</span>(<span class="va">self</span>.__dni)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__dni<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__nombre<span class="sc">}</span><span class="ss">)&#39;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span></code></pre></div></li>
<li><p>Pero obtendríamos un resultado incorrecto, porque el DNI y el
nombre de la persona deberían ir entre comillas, ya que son cadenas
literales:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Persona(<span class="st">&#39;28373482X&#39;</span>, <span class="st">&#39;Javier Rodríguez&#39;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>Persona(28373482X, Javier Rodríguez)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Persona(28373482X, Javier Rodríguez)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.9">

<ul>
<li><p>La solución sería aplicar la función <code
class="sourceCode python"><span class="bu">repr</span></code> también a
los argumentos del constructor de <code>Persona</code>:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.__dni)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.__nombre)<span class="sc">}</span><span class="ss">)&#39;</span></span></code></pre></div></li>
<li><p>Esto se puede abreviar haciendo uso de la <em>conversión</em>
<code>r</code> en los campos de sustitución de la <em>f-string</em>:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__dni<span class="sc">!r}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__nombre<span class="sc">!r}</span><span class="ss">)&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.10">

<ul>
<li><p>Es importante señalar que <strong>no siempre se puede definir un
<code class="sourceCode python"><span class="fu">__repr__</span></code>
adecuado para un objeto</strong>.</p></li>
<li><p>Esto es así porque no siempre es posible representar con una
expresión todo el estado interno del objeto.</p></li>
<li><p>De hecho, un objeto puede tener estado interno que no siquiera
sea visible ni conocido en el exterior.</p></li>
<li><p>Por ejemplo, si cada objeto de la clase <code>Deposito</code>
guardara un historial de las operaciones que se han ido realizando con
ese depósito, ese historial formaría parte del estado interno del objeto
pero no aparecería como parámetro en el constructor.</p>
<p>Por tanto, no podríamos describir con una expresión <code
class="sourceCode python">Deposito(...)</code> (ni con ninguna otra)
todo el estado interno del objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.11">

<ul>
<li><p>Una forma de solucionar este problema sería hacer que el
constructor de la clase pudiera recibir un parámetro adicional
<em>opcional</em> que contenga ese historial:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos, historial<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> historial <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>           <span class="va">self</span>.historial <span class="op">=</span> []</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">else</span>:</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>           <span class="va">self</span>.historial <span class="op">=</span> historial</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Deposito(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>fondos<span class="sc">!r}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>historial<span class="sc">!r}</span><span class="ss">)&quot;</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... resto del código</span></span></code></pre></div></li>
<li><p>Ese parámetro sólo se usaría en ese caso, es decir, que no
estaría pensado para ser usado de forma habitual al crear objetos
<code>Deposito</code>.</p></li>
</ul>
</section>

<section id="str__" class="title-slide slide level3"
data-number="1.3.2">
<h3 data-number="1.3.2"><span class="header-section-number">1.3.2</span>
<code>__str__</code></h3>
<ul>
<li><p>El método <code
class="sourceCode python"><span class="fu">__str__</span></code> se
invoca automáticamente cuando se necesita convertir un valor al tipo
<code
class="sourceCode python"><span class="bu">str</span></code>.</p></li>
<li><p>Por tanto, la siguiente expresión:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span>(v)</span></code></pre></div>
<p>es equivalente a ésta:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>v.<span class="fu">__str__</span>()</span></code></pre></div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">str</span>(<span class="dv">25</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (<span class="dv">25</span>).<span class="fu">__str__</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span></code></pre></div></li>
<li><p>Existen muchos casos donde es necesario convertir un valor a
cadena, explícita o implícitamente. Por ejemplo, la función <code
class="sourceCode python"><span class="bu">print</span></code> convierte
a cadena su argumento antes de imprimirlo.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.2.0.1">

<ul>
<li><p>Si la clase del objeto <code>v</code> no tiene definido el método
<code class="sourceCode python"><span class="fu">__str__</span></code>,
por defecto se entiende que se tiene <code
class="sourceCode python"><span class="fu">__str__</span></code> = <code
class="sourceCode python"><span class="fu">__repr__</span></code>. Por
tanto, en tal caso se llama en su lugar al método <code
class="sourceCode python"><span class="fu">__repr__</span></code>.</p></li>
<li><p>¿Cuál es la diferencia entre <code
class="sourceCode python"><span class="fu">__repr__</span></code> y
<code
class="sourceCode python"><span class="fu">__str__</span></code>?</p>
<ul>
<li><p>La finalidad de <code
class="sourceCode python"><span class="fu">__repr__</span></code> es ser
<strong>no ambiguo</strong> y deberíamos implementarlo siempre en todas
nuestras clases (cuando sea posible).</p></li>
<li><p>La finalidad de <code
class="sourceCode python"><span class="fu">__str__</span></code> es ser
<strong>legible para el usuario</strong> y no es estrictamente necesario
implementarlo.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.2.0.2">

<ul>
<li><p>Por ejemplo, en el módulo <code
class="sourceCode python">datetime</code> tenemos clases que sirven para
manipular fechas y horas.</p></li>
<li><p>La clase <code class="sourceCode python">date</code> del módulo
<code class="sourceCode python">datetime</code> nos permite crear
objetos que representan fechas:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> datetime</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d <span class="op">=</span> datetime.date(<span class="dv">2020</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span></code></pre></div></li>
<li><p>Al llamar a <code
class="sourceCode python"><span class="bu">repr</span></code> sobre
<code>d</code> obtenemos una representación que nos permite reconstruir
el objeto:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(d)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;datetime.date(2020, 4, 30)&#39;</span></span></code></pre></div></li>
<li><p>Y al llamar a <code
class="sourceCode python"><span class="bu">str</span></code> sobre
<code>d</code> obtenemos una versión más fácil de entender para un ser
humano:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">str</span>(d)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;2020-04-30&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.2.0.3">

<ul>
<li><p>Se puede observar aquí que el intérprete usa <code
class="sourceCode python"><span class="bu">repr</span></code> para
mostrar la forma normal del objeto:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;datetime.date(2020, 4, 30)&#39;</span></span></code></pre></div></li>
<li><p>Y que <code
class="sourceCode python"><span class="bu">print</span></code> usa <code
class="sourceCode python"><span class="bu">str</span></code> para
imprimir el objeto de una forma legible:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(d)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span>04<span class="op">-</span><span class="dv">30</span></span></code></pre></div></li>
<li><p>Recordemos que <code
class="sourceCode python"><span class="bu">print</span></code> imprime
una cadena por la salida (sin comillas) y devuelve <code
class="sourceCode python"><span class="va">None</span></code>.</p></li>
</ul>
</section>

</section>
<section>
<section id="encapsulación" class="title-slide slide level1"
data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span>
Encapsulación</h1>

</section>
<section id="encapsulación-1" class="title-slide slide level2"
data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span>
Encapsulación</h2>
<ul>
<li><p>En programación orientada a objetos, decimos que los objetos
están <strong>encapsulados</strong>.</p></li>
<li><p>La encapsulación es un concepto fundamental en programación
orientada a objetos, aunque no pertenece exclusivamente a este
paradigma.</p></li>
<li><p>Aunque es uno de los conceptos más importantes de la programación
orientación a objetos, no hay un consenso general y universalmente
aceptado sobre su definición.</p></li>
<li><p>Además, es un concepto relacionado con la abstracción y la
ocultación de información, y a veces se confunde con estos, lo que
complica aún más la cosa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.0.0.1">

<ul>
<li><p>Nosotros vamos a estudiar la encapsulación como dos
<strong>mecanismos</strong> distintos pero relacionados:</p>
<ul>
<li><p>Por una parte, la encapsulación es un <strong>mecanismo</strong>
de los lenguajes de programación que permite que <strong>los datos y las
operaciones</strong> que se puedan realizar sobre esos datos <strong>se
agrupen juntos en una sola <em>unidad sintáctica</em></strong>.</p></li>
<li><p>Por otra parte, la encapsulación es un <strong>mecanismo</strong>
de los lenguajes de programación por el cual <strong>sólo se puede
acceder al interior de un objeto mediante las operaciones</strong> que
forman su <strong>barrera de abstracción</strong>, impidiendo acceder
directamente a los datos internos del mismo y garantizando así la
<strong>protección de datos</strong>.</p>
<p>En definitiva, nos referimos a un mecanismo que garantiza que los
objetos actúan como <strong>datos abstractos</strong>.</p></li>
</ul>
<!--
- Por otra parte, la encapsulación es un **principio** según el cual **las
  operaciones** de un objeto representan una **barrera de abstracción** a
  través de la cual el usuario puede manipular el estado interno del objeto,
  de forma que **sólo se pueda acceder al interior del objeto a través de sus
  operaciones**.

  Como principio, por sí solo no es suficiente para garantizar la protección
  de datos ni la ocultación de información, a no ser que se acompañe de otros
  mecanismos que proporcione el lenguaje.
--></li>
<li><p>Vamos a ver cada uno de ellos con más detalle.</p></li>
</ul>
</section>
<section id="la-encapsulación-como-mecanismo-de-agrupamiento"
class="title-slide slide level3" data-number="2.1.1">
<h3 data-number="2.1.1"><span class="header-section-number">2.1.1</span>
La encapsulación como mecanismo de agrupamiento</h3>
<ul>
<li><p>El mecanismo de las <strong>clases</strong> nos permite crear
estructuras que <strong>agrupan datos y operaciones en una misma
unidad</strong>.</p></li>
<li><p>Al instanciar esas clases, aparecen los <strong>objetos</strong>,
que conservan esa misma característica de agrupar datos (estado interno)
y operaciones en una sola cosa.</p></li>
<li><p>De esta forma, las operaciones acompañan a los datos allá donde
vaya el objeto.</p></li>
<li><p>Por tanto, al pasar un objeto a alguna otra parte del programa,
estamos también pasando las operaciones que se pueden realizar sobre ese
objeto, o lo que es lo mismo, los mensajes a los que puede
responder.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.1.0.1">

<ul>
<li><p>En un lenguaje de programación, llamamos <strong>ciudadano de
primera clase</strong> (<em>first-class citizen</em>) a todo aquello
que:</p>
<ul>
<li><p>Puede ser <strong>pasado como argumento</strong> de una
operación.</p></li>
<li><p>Puede ser <strong>devuelto como resultado</strong> de una
operación.</p></li>
<li><p>Puede ser <strong>asignado</strong> a una variable o
<strong>ligado</strong> a un identificador.</p></li>
</ul></li>
<li><p>En definitiva, un ciudadano de primera clase es <strong>un valor
de un determinado tipo</strong>, simple o compuesto.</p></li>
<li><p>Los objetos se pueden manipular (por ejemplo, enviarles mensajes)
a través de las <em>referencias</em>, y éstas se pueden pasar como
argumento, devolver como resultado y asignarse a una variable.</p></li>
<li><p>Por tanto, <strong>los objetos son <em>ciudadanos de primera
clase</em></strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.1.0.2">

<ul>
<li><p>Por ejemplo, si definimos una función que calcula la diferencia
entre los saldos de dos depósitos, podríamos hacer:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diferencia(dep1, dep2):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dep1.saldo() <span class="op">-</span> dep2.saldo()</span></code></pre></div></li>
<li><p>Es decir:</p>
<ul>
<li><p>La función <code>diferencia</code> recibe como argumentos los dos
depósitos (que son objetos), por lo que éstos son ciudadanos de primera
clase.</p></li>
<li><p>Los objetos encapsulan:</p>
<ul>
<li><p>sus <em>datos</em> (su estado interno) y</p></li>
<li><p>sus <em>operaciones</em> (los mensajes a los que puede
responder)</p></li>
</ul>
<p>juntos en una sola unidad sintáctica, a la que podemos acceder usando
una sencilla referencia, como <code>dep1</code> o
<code>dep2</code>.</p></li>
<li><p>Para obtener el saldo no se usa una función externa al objeto,
sino que se le pregunta a este a través de la operación
<code>saldo</code> contenida dentro del objeto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.1.0.3">

<ul>
<li><p>En resumen, decir que los objetos están encapsulados es decir
que:</p>
<ul>
<li><p>Agrupan datos y operaciones en una sola unidad.</p></li>
<li><p>Son ciudadanos de primera clase.</p></li>
<li><p>Es posible manipularlos por completo usando simplemente una
referencia.</p></li>
<li><p>La referencia representa al objeto.</p></li>
</ul></li>
</ul>
</section>

<section id="la-encapsulación-como-mecanismo-de-protección-de-datos"
class="title-slide slide level3" data-number="2.1.2">
<h3 data-number="2.1.2"><span class="header-section-number">2.1.2</span>
La encapsulación como mecanismo de protección de datos</h3>
<ul>
<li><p>Un dato abstracto es aquel que se define en función de las
operaciones que se pueden realizar sobre él.</p></li>
<li><p>Los objetos son datos abstractos y, por tanto, su estado interno
debería manejarse únicamente mediante operaciones definidas a tal
efecto, impidiendo el acceso directo a los atributos internos del
objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.0.1">

<ul>
<li><p>Según esto, podemos imaginar que:</p>
<ul>
<li><p>Los atributos que almacenan el estado interno del objeto están
<em>encapsulados</em> dentro del mismo.</p></li>
<li><p>Las operaciones con las que se puede manipular el objeto
<em>rodean</em> a esos atributos formando una <em>cápsula</em>, de forma
que, para poder acceder al interior, hay que hacerlo necesariamente a
través de esas operaciones.</p></li>
</ul></li>
</ul>
<div class="centered">
<figure>
<img data-src="images/operaciones-capsula.png" class="plain"
style="width:30.0%" alt="Las operaciones forman una cápsula" />
<figcaption aria-hidden="true">Las operaciones forman una
<em>cápsula</em></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.1.2.0.2">

<ul>
<li>Esas operaciones son las que aparecen en la
<strong>especificación</strong> de su tipo abstracto y, por tanto,
definen de qué manera podemos manipular al objeto desde el exterior del
mismo.</li>
</ul>
<div class="centered">
<figure>
<img data-src="images/operaciones-capsula.jpg" style="width:50.0%"
alt="Las operaciones forman una cápsula" />
<figcaption aria-hidden="true">Las operaciones forman una
<em>cápsula</em></figcaption>
</figure>
</div>
</section>
<section id="visibilidad" class="title-slide slide level4"
data-number="2.1.2.1">
<h4 data-number="2.1.2.1"><span
class="header-section-number">2.1.2.1</span> Visibilidad</h4>
<ul>
<li><p>Para garantizar esta restricción de acceso, los lenguajes de
programación a menudo facilitan un mecanismo por el cual el programador
puede definir la <strong>visibilidad</strong> de cada miembro de una
clase.</p></li>
<li><p>De esta forma, el programador puede «marcar» que determinadas
variables de instancia o métodos sólo sean accesibles desde el interior
de esa clase o que, por el contrario, sí se pueda acceder a ellos desde
el exterior de la misma.</p></li>
</ul>
<p><span class="math display">\text{Visibilidad} \begin{cases}
\text{No se puede acceder desde el exterior, o} \\
\text{Sí se puede acceder desde el exterior}
\end{cases}</span></p>
</section>
<section class="slide level5" data-number="2.1.2.1.1">

<ul>
<li><p>Cada una de estas dos posibilidades da lugar a un tipo distinto
de visibilidad:</p>
<ul>
<li><p><strong>Visibilidad <em>privada</em>:</strong> si un miembro
tiene visibilidad privada, sólo podrá accederse a él desde dentro de esa
clase, pero no desde fuera de ella.</p></li>
<li><p><strong>Visibilidad <em>pública</em>:</strong> si un miembro
tiene visibilidad pública, podrá accederse a él tanto desde dentro como
desde fuera de la clase.</p></li>
<li><p>Por tanto, <strong>desde el exterior de un objeto sólo podremos
acceder a los miembros <em>públicos</em> de ese
objeto</strong>.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.1.2">

<div class="centered">
<figure>
<img data-src="images/encapsulacion.png" class="plain"
style="width:60.0%" alt="Miembros públicos y privados" />
<figcaption aria-hidden="true">Miembros <em>públicos</em> y
<em>privados</em></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.1.2.1.3">

<ul>
<li><p>Cada lenguaje de programación tiene su propia manera de
implementar mecanismos de visibilidad.</p></li>
<li><p>En Python, el mecanismo es muy sencillo:</p>
<div class="caja">
<p>Si el nombre de un miembro (de clase o de objeto) definido dentro del
cuerpo de una clase empieza (pero no acaba) por <code>__</code>,
entonces es <em>privado</em>. En caso contrario, es
<em>público</em>.</p>
</div></li>
<li><p>Los <em>métodos mágicos</em> (como <code
class="sourceCode python"><span class="fu">__init__</span></code>, <code
class="sourceCode python"><span class="fu">__eq__</span></code>, etc.)
tienen nombres que empiezan <strong>y acaban</strong> por
<code>__</code>, así que no cumplen la condición anterior y, por tanto,
son <em>públicos</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.1.4">

<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Prueba:</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __uno(<span class="va">self</span>):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método es privado, ya que su nombre empieza por __&quot;</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método es público&quot;</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __tres__(<span class="va">self</span>):</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método también es público, porque su nombre empieza y acaba por __&quot;</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Prueba()</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>p.__uno()    <span class="co"># No funciona, ya que __uno es un método privado</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>p.dos()      <span class="co"># Funciona, ya que el método dos es público</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>p.__tres__() <span class="co"># También funciona</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.1.5">

<ul>
<li><p>Los miembros privados sólo son accesibles desde dentro de la
clase:</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> __uno(<span class="va">self</span>):</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>...         <span class="bu">print</span>(<span class="st">&quot;Este método es privado, ya que su nombre empieza por __&quot;</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>...         <span class="bu">print</span>(<span class="st">&quot;Este método es público&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__uno() <span class="co"># Llama al método privado desde dentro de la clase</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba()</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.__uno()    <span class="co"># No funciona, ya que __uno es un método privado</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Prueba&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;__uno&#39;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.dos()      <span class="co"># Funciona, ya que el método dos es público</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>Este método es público</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>Este método es privado, ya que su nombre empieza por __</span></code></pre></div></li>
<li><p>El método <code>__uno</code> se ha creado dentro de la clase
<code>Prueba</code> y pertenece a la misma clase <code>Prueba</code>,
así que ese método es <em>privado</em>, se puede acceder a él dentro del
cuerpo de la clase <code>Prueba</code>, pero no es visible fuera de
ella.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.1.6">

<ul>
<li><p>Con las variables de instancia ocurre exactamente igual:</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x):</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__x <span class="op">=</span> x       <span class="co"># __init__ puede acceder a __x</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>...                            <span class="co"># ya que los dos están dentro de la misma clase</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba(<span class="dv">1</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.__x   <span class="co"># No funciona, ya que __x es privada</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Prueba&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;__x&#39;</span></span></code></pre></div></li>
<li><p>La variable de instancia <code>__x</code> se ha creado dentro de
la clase <code>Prueba</code> y pertenece a un objeto de la misma clase
<code>Prueba</code>, así que esa variable es <em>privada</em>, se puede
acceder a ella dentro del cuerpo de la clase <code>Prueba</code>, pero
no es visible fuera de ella.</p></li>
</ul>
</section>

<section id="accesores-y-mutadores" class="title-slide slide level4"
data-number="2.1.2.2">
<h4 data-number="2.1.2.2"><span
class="header-section-number">2.1.2.2</span> Accesores y mutadores</h4>
<ul>
<li><p>En muchas ocasiones, ocurre que necesitamos manipular el valor
contenido en una variable de instancia privada, pero desde fuera del
objeto.</p></li>
<li><p>Para ello, necesitamos definir operaciones (métodos) que nos
permitan acceder y/o modificar el valor de la variable de instancia
privada del objeto desde fuera del mismo.</p></li>
<li><p>Estos métodos pueden ser:</p>
<ul>
<li><p><strong>Accesores o <em>getters</em>:</strong> permiten acceder
al valor de una variable de instancia privada desde fuera del
objeto.</p></li>
<li><p><strong>Mutadores o <em>setters</em>:</strong> permiten modificar
el valor de una variable de instancia privada desde fuera del
objeto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.2.1">

<ul>
<li><p>Por ejemplo, si tenemos una variable de instancia privada que
deseamos manipular desde el exterior del objeto, podemos definir una
pareja de métodos <code>get</code> y <code>set</code> de la siguiente
forma:</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x):</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.set_x(x)        <span class="co"># En el constructor aprovechamos el setter</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> get_x(<span class="va">self</span>):         <span class="co"># Este es el getter de la variable __x</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">return</span> <span class="va">self</span>.__x</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> set_x(<span class="va">self</span>, x):      <span class="co"># Este es el setter de la variable __x</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__x <span class="op">=</span> x</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba(<span class="dv">1</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.get_x()                    <span class="co"># Accedemos al valor de __x</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.set_x(<span class="dv">5</span>)                   <span class="co"># Cambiamos el valor de __x</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.get_x()                    <span class="co"># Accedemos de nuevo al valor de __x</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div></li>
<li><p>La pregunta es: ¿qué ganamos con todo esto?</p></li>
</ul>
</section>

<section id="propiedades" class="title-slide slide level4"
data-number="2.1.2.3">
<h4 data-number="2.1.2.3"><span
class="header-section-number">2.1.2.3</span> Propiedades</h4>
<ul>
<li><p>En Python, una <strong>propiedad</strong> (<em>property</em>) es
una forma elegante de definir atributos con <em>getters</em> y
<em>setters</em> sin perder la sintaxis de acceso usando el operador
punto (<code>.</code>).</p></li>
<li><p>Son útiles cuando:</p>
<ul>
<li><p>Quieres validar o transformar el valor al asignarlo.</p></li>
<li><p>Necesitas que un atributo sea de solo lectura.</p></li>
<li><p>Quieres exponer un atributo «calculado» como si fuera
normal.</p></li>
<li><p>Tienes un atributo pero necesitas añadir control.</p></li>
<li><p>Quieres que un atributo calculado se acceda como uno
almacenado.</p></li>
<li><p>No quieres romper la <em>interfaz de la clase</em> (un concepto
que veremos a continuación) si después necesitas validación.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.3.1">

<ul>
<li><p>Definición básica con <code
class="sourceCode python"><span class="at">@property</span></code>:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, edad):</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad   <span class="co"># atributo privado</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> edad(<span class="va">self</span>):</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__edad   <span class="co"># getter</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">@edad.setter</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> edad(<span class="va">self</span>, valor):</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> valor <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;La edad no puede ser negativa&quot;</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> valor  <span class="co"># setter</span></span></code></pre></div></li>
<li><p>Ejemplo de uso:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Persona(<span class="dv">30</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p.edad)   <span class="co"># llama al getter → 30</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>p.edad <span class="op">=</span> <span class="dv">40</span>     <span class="co"># llama al setter</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>p.edad <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>     <span class="co"># ValueError</span></span></code></pre></div></li>
<li><p>Usamos <code>__edad</code> como atributo privado para evitar
recursión y señalar que no debe tocarse desde fuera
(<em>encapsulación</em>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.3.2">

<ul>
<li><p>Propiedad de sólo lectura:</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Circulo:</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, radio):</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.radio <span class="op">=</span> radio</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> area(<span class="va">self</span>):</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pi <span class="op">*</span> <span class="va">self</span>.radio <span class="op">**</span> <span class="dv">2</span></span></code></pre></div></li>
<li><p>Ejemplo de uso:</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Circulo(<span class="dv">3</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(c.area)   <span class="co"># OK</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>c.area <span class="op">=</span> <span class="dv">5</span>      <span class="co"># Error: no tiene setter</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.3.3">

<ul>
<li><p>Usar <code>property()</code> como función en lugar de usar
decoradores:</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, edad):</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_edad(<span class="va">self</span>):</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__edad</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_edad(<span class="va">self</span>, valor):</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> valor <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Edad negativa&quot;</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> valor</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    edad <span class="op">=</span> <span class="bu">property</span>(get_edad, set_edad)</span></code></pre></div></li>
</ul>
</section>

<section id="invariantes-de-clase" class="title-slide slide level4"
data-number="2.1.2.4">
<h4 data-number="2.1.2.4"><span
class="header-section-number">2.1.2.4</span> Invariantes de clase</h4>
<ul>
<li><p>Si necesitamos acceder y/o cambiar el valor de una variable de
instancia desde fuera del objeto, ¿por qué hacerlo privado? ¿Por qué no
simplemente hacerlo público y así evitamos tener que hacer
<em>getters</em> y <em>setters</em>?:</p>
<ul>
<li><p>Las variables de instancia públicas del objeto rompen con los
conceptos de <em>encapsulación</em> y de <em>abstracción de datos</em>,
ya que permite acceder al interior de un objeto directamente, en lugar
de hacerlo a través de operaciones.</p></li>
<li><p>Ya sabemos que con eso se rompe con el principio de
<em>ocultación de información</em>, ya que exponemos públicamente el
tipo y la representación del dato, por lo que nos resultará muy difícil
cambiarlos posteriormente si en el futuro nos hace falta
hacerlo.</p></li>
<li><p>Pero además, los <em>setters</em> nos garantizan que los valores
que se almacenan en una variable de instancia cumplen con las
<strong>condiciones</strong> necesarias.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.4.1">

<div class="caja">
<p>Las condiciones que deben cumplir en todo momento las instancias de
una clase se denominan <strong>invariantes de la clase</strong>.</p>
</div>
</section>
<section class="slide level5" data-number="2.1.2.4.2">

<ul>
<li><p>Por ejemplo: si queremos almacenar los datos de una persona y
queremos garantizar que la edad no sea negativa, podemos hacer:</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;Invariante: todas las personas deben tener edad no negativa.&quot;&quot;&quot;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, nombre, edad):</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_nombre(nombre)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_edad(edad)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_nombre(<span class="va">self</span>):</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__nombre</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_edad(<span class="va">self</span>, edad):</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edad <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;La edad no puede ser negativa&quot;</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Persona(<span class="st">&quot;Manuel&quot;</span>, <span class="dv">30</span>)   <span class="co"># Es correcto</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p.set_nombre())       <span class="co"># Imprime &#39;Manuel&#39;</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>p.set_edad(<span class="dv">25</span>)              <span class="co"># Cambia la edad a 25</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>p.set_edad(<span class="op">-</span><span class="dv">14</span>)             <span class="co"># Provoca un error</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>p.__edad <span class="op">=</span> <span class="op">-</span><span class="dv">14</span>              <span class="co"># Funcionaría si __edad no fuese privada</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.4.3">

<ul>
<li><p>En conclusión, se recomienda:</p>
<ul>
<li><p>Hacer <strong>privados</strong> todos los miembros excepto los
que sean estrictamente necesarios para poder manipular el objeto desde
el exterior del mismo (su <strong><em>interfaz</em></strong>).</p></li>
<li><p>Crear <em>getters</em> y <em>setters</em> para los atributos que
se tengan que manipular desde el exterior del objeto.</p></li>
<li><p>Dejar claros los <em>invariantes</em> de las clases en el código
fuente de las mismas mediante comentarios, y comprobarlos adecuadamente
donde corresponda (en los <em>setters</em>, principalmente).</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.4.4">

<ul>
<li><p>El concepto de invariante de una clase, aunque puede parecer
nuevo, en realidad es el mismo concepto que ya vimos al estudiar las
<strong>abstracciones de datos</strong>.</p></li>
<li><p>Entonces dijimos que una abstracción de datos se define por unas
<strong>operaciones</strong> y por las <strong>propiedades</strong> que
deben cumplir esas operaciones.</p></li>
<li><p>También dijimos que esas propiedades se describen como
<em>ecuaciones</em> en la <strong>especificación</strong> del tipo
abstracto (y, por tanto, se deben cumplir independientemente de la
implementación).</p></li>
</ul>
<div class="caja">
<p>Cuando implementamos un tipo abstracto mediante una clase,
<strong>algunas de esas propiedades se traducen en invariantes</strong>
de la clase.</p>
</div>
</section>
<section class="slide level5" data-number="2.1.2.4.5">

<ul>
<li><p>En cambio, otras de esas propiedades <strong>no serán
<em>invariantes</em> de la clase, sino <em>condiciones</em> que tienen
que cumplir los métodos</strong> (es decir, las operaciones) al entrar o
salir de los mismos.</p></li>
<li><p>Esas condiciones son las que forman la <strong>especificación
funcional</strong> de cada método de la clase.</p></li>
<li><p>Recordemos que una especificación funcional contiene dos
condiciones:</p>
<ul>
<li><p><strong>Precondición</strong>: condición que tiene que cumplir el
método para poder ejecutarse.</p></li>
<li><p><strong>Postcondición</strong>: condición que tiene que cumplir
el método al acabar de ejecutarse.</p></li>
</ul></li>
<li><p>Si se cumple la precondición de un método y éste se ejecuta, al
finalizar su ejecución se debe cumplir su postcondición.</p></li>
<li><p>Forman una especificación porque describen qué tiene que hacer el
método sin entrar a ver el cómo.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.4.6">

<ul>
<li><p>Resumiendo:</p>
<ul>
<li><p>Las clases implementan <strong>tipos abstractos de
datos</strong>.</p></li>
<li><p>Los tipos abstractos de datos se <strong>especifican</strong>
indicando sus <strong>operaciones</strong> y las
<strong>propiedades</strong> que deben cumplir esas
operaciones.</p></li>
<li><p>Esas propiedades se traducirán en:</p>
<ul>
<li><p><strong>Invariantes</strong> de la clase.</p></li>
<li><p><strong>Precondiciones</strong> o
<strong>postcondiciones</strong> de los métodos que implementan las
operaciones del tipo abstracto.</p></li>
</ul></li>
<li><p>El <strong>usuario de la clase</strong> es
<strong>responsable</strong> de garantizar que se cumple la
<strong>precondición</strong> de un método cuando lo invoca.</p></li>
<li><p>La <strong>implementación</strong> de la clase es
<strong>responsable</strong> de garantizar que se cumple en todo momento
las <strong>invariantes</strong> de la clase, así como las
<strong>postcondiciones</strong> de los métodos cuando se les invoca en
un estado que cumple su precondición.</p></li>
</ul></li>
</ul>
</section>

<section id="interfaz-y-especificación-de-una-clase"
class="title-slide slide level4" data-number="2.1.2.5">
<h4 data-number="2.1.2.5"><span
class="header-section-number">2.1.2.5</span> Interfaz y especificación
de una clase</h4>
<ul>
<li><p>La <strong>interfaz de una clase</strong> (o de un objeto de esa
clase) está formada por todo lo que es público y visible desde fuera de
la clase.</p></li>
<li><p>En concreto, la interfaz de una clase indica:</p>
<ul>
<li><p>El <strong>nombre de la clase</strong>.</p></li>
<li><p>El nombre y tipo de las <strong>variables de instancia
públicas</strong>.</p></li>
<li><p>La <strong>signatura</strong> de los <strong>métodos
públicos</strong>.</p></li>
</ul></li>
<li><p>Es un concepto puramente sintáctico, porque describe
<strong>qué</strong> proporciona la clase pero no qué propiedades debe
cumplir (para qué sirve la clase).</p></li>
<li><p>Por tanto, podemos decir que el usuario de la clase no tiene
suficiente con conocer la interfaz de la clase.</p></li>
<li><p>También necesita saber qué hace, y eso no se indica en la
interfaz.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.5.1">

<ul>
<li><p>La <strong>especificación de una clase</strong> representa todo
lo que es necesario conocer para usar la clase (y, por tanto, cualquier
objeto de esa clase).</p></li>
<li><p>Describe qué hace la clase (o el objeto) sin detallar
cómo.</p></li>
<li><p>Tiene un papel similar a la especificación de un tipo abstracto
de datos.</p></li>
<li><p>Está formado por:</p>
<ul>
<li><p>La <strong>interfaz</strong> de la clase.</p></li>
<li><p>Los <strong>invariantes</strong> de la clase.</p></li>
<li><p>La <strong>especificación funcional</strong> (precondición,
postcondición y signatura) de todos los <strong>métodos
públicos</strong> de la clase.</p></li>
<li><p><strong>Documentación adicional</strong> que explique la función
de la clase y sus operaciones, así como posible información extra que
pueda resultar de interés para el usuario de la clase.</p></li>
</ul></li>
</ul>
</section>

<section id="asertos" class="title-slide slide level4"
data-number="2.1.2.6">
<h4 data-number="2.1.2.6"><span
class="header-section-number">2.1.2.6</span> Asertos</h4>
<ul>
<li><p>La <strong>comprobación</strong> continua de las condiciones
(invariantes, precondiciones o postcondiciones) cada vez que se
actualiza el estado interno de un objeto puede dar lugar a
<strong>problemas de rendimiento</strong>, ya que las comprobaciones
consumen tiempo de CPU.</p></li>
<li><p>Una técnica alternativa a la comprobación con sentencias
condicionales (<code
class="sourceCode python"><span class="cf">if</span></code>s) es el uso
de <strong>asertos</strong>.</p></li>
<li><p>Un aserto es una <strong>condición que se debe cumplir en un
determinado punto del programa</strong>, de forma que el programa
abortará en ese punto si no se cumple.</p></li>
<li><p>Para insertar un aserto en un punto del programa, se usa la
sentencia <code
class="sourceCode python"><span class="cf">assert</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.1">

<ul>
<li><p>El código anterior quedaría así usando <code
class="sourceCode python"><span class="cf">assert</span></code>:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="st">Invariante: todas las personas deben tener edad no negativa.</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, nombre, edad):</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_nombre(nombre)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_edad(edad)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_nombre(<span class="va">self</span>):</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__nombre</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_edad(<span class="va">self</span>, edad):</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> edad <span class="op">&gt;=</span> <span class="dv">0</span>      <span class="co"># La edad tiene que ser &gt;= 0</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad</span></code></pre></div></li>
<li><p>El intérprete comprobará el aserto cuando el flujo de control
llegue a la sentencia <code
class="sourceCode python"><span class="cf">assert</span></code> y, en
caso de que no se cumpla, lanzará una excepción de tipo <code
class="sourceCode python"><span class="pp">AssertionError</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.2">

<ul>
<li><p>Lo interesante de los asertos es que podemos pedirle al
intérprete que ignore todas las sentencias <code
class="sourceCode python"><span class="cf">assert</span></code> cuando
ejecute el código.</p></li>
<li><p>Para ello, usamos la opción <code>-O</code> al llamar al
intérprete de Python desde la línea de comandos del sistema
operativo:</p></li>
</ul>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prueba.py</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Antes&quot;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Después&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre
class="sourceCode console"><code class="sourceCode console"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ </span>python prueba.py</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Antes</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  File &quot;prueba.py&quot;, line 2, in <span class="co">&lt;module&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    assert False</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>AssertionError</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="kw">$ </span>python -O prueba.py</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>Antes</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>Después</span></code></pre></div>
<ul>
<li>Con la opción <code>-O</code> (de «<strong>O</strong>ptimizado»)
podemos elegir entre mayor rendimiento o mayor seguridad al ejecutar
nuestros programas.</li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.3">

<ul>
<li><p>Aún así, no siempre es conveniente poder saltarse los asertos. De
hecho, a veces lo mejor sigue siendo comprobar condiciones con un <code
class="sourceCode python"><span class="cf">if</span></code> y lanzar un
error adecuado si la condición no se cumple.</p></li>
<li><p>Por ejemplo, si intentamos retirar fondos de un depósito pero no
hay saldo suficiente, eso se debería comprobar siempre:</p></li>
</ul>
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:                    <span class="co"># Si no hay fondos:</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Fondos insuficientes&quot;</span>)  <span class="co"># Error</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</section>
<section class="slide level5" data-number="2.1.2.6.4">

<ul>
<li><p>¿Cuándo usar asertos y cuándo usar excepciones?</p>
<ul>
<li><p>Las <strong>excepciones</strong> se deben usan para detectar
errores de programación de los <strong>usuarios</strong> del método o
clase.</p></li>
<li><p>Los <strong>asertos</strong> se deben usar para detectar errores
de funcionamiento del <strong>interior</strong> del método o clase, es
decir, errores que haya cometido el <strong>implementador</strong> o
<strong>creador</strong> del método o clase.</p></li>
<li><p>Además, los asertos están pensados para detectar errores muy
anormales que no se espera que se puedan capturar ni gestionar.</p></li>
<li><p>Por eso, el objetivo principal de los asertos es servir al
creador de una clase como mecanismo de comprobación de que su clase
funciona correctamente.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.5">

<ul>
<li><p>Resumiendo:</p>
<ul>
<li><p>Un <strong>invariante de una clase</strong> es una condición que
se debe cumplir durante toda la vida de todas las instancias de una
clase.</p></li>
<li><p>Una <strong>precondición de un método</strong> es una condición
que se debe cumplir justo antes de ejecutar el método.</p></li>
<li><p>Una <strong>postcondición de un método</strong> es una condición
que se debe cumplir justo al finalizar la ejecución del método.</p></li>
<li><p>Un <strong>aserto</strong> es una condición que se debe cumplir
en un determinado punto del programa.</p></li>
<li><p>Para <strong>implementar invariantes de clase, precondiciones o
postcondiciones de métodos</strong> se pueden usar excepciones, asertos
y sentencias <code
class="sourceCode python"><span class="cf">assert</span></code> en
puntos adecuados del código fuente de la clase.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.6">

<p><strong>¡CUIDADO!</strong></p>
<ul>
<li><p>Supogamos que tenemos el siguiente código que implementa
colas:</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Cola:</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;Invariante: self.__cantidad == len(self.__items).&quot;&quot;&quot;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items <span class="op">=</span> []</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meter(<span class="va">self</span>, el):</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items.append(el)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sacar(<span class="va">self</span>):</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.__cantidad <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Cola vacía&quot;</span>)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> <span class="va">self</span>.__items[<span class="dv">0</span>]</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_items(<span class="va">self</span>):</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__items</span></code></pre></div></li>
<li><p>Se supone que la variable de instancia <code>__items</code> es
privada y, por tanto, sólo se puede acceder a ella desde el interior de
la clase.</p></li>
<li><p>El método <code>get_items</code> es un <em>getter</em> para la
variable de instancia <code>__items</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.7">

<ul>
<li><p>En teoría, los únicos métodos con los que podemos modificar el
contenido de la variable de instancia <code>__items</code> son
<code>meter</code> y <code>sacar</code>.</p></li>
<li><p>Sin embargo, podemos hacer así:</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Cola()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>c.meter(<span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>c.meter(<span class="dv">2</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> c.get_items() <span class="co"># Obtenemos la lista contenida en __items</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> l[<span class="dv">0</span>]          <span class="co"># Eliminamos un elemento de la lista desde fuera de la cola</span></span></code></pre></div></li>
<li><p>Esto se debe a que <code>get_items</code> devuelve una referencia
a la lista contenida dentro de la instancia de <code>Cola</code>, con lo
cual podemos modificar la lista desde el exterior sin necesidad de usar
los <em>setters</em>.</p></li>
<li><p>Por tanto, podemos romper los invariantes de la clase, ya que
ahora se cumple que <code>c.__cantidad</code> vale 2 y <code
class="sourceCode python"><span class="bu">len</span></code><code>(c.__items)</code>
vale <code class="sourceCode python"><span class="dv">1</span></code>
(no coinciden).</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.2.6.8">

<ul>
<li><p>Para solucionar el problema, tenemos dos opciones:</p>
<ul>
<li><p>Quitar el método <code>get_items</code> si es posible.</p></li>
<li><p>Si es estrictamente necesario que exista, cambiarlo para que no
devuelva una referencia a la lista, sino una <strong>copia</strong> de
la lista:</p></li>
</ul>
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_items(<span class="va">self</span>):</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.__items[:]</span></code></pre></div></li>
</ul>
</section>

<section id="un-ejemplo-completo" class="title-slide slide level4"
data-number="2.1.2.7">
<h4 data-number="2.1.2.7"><span
class="header-section-number">2.1.2.7</span> Un ejemplo completo</h4>
<ul>
<li>Recordemos la especificación del tipo <em>pila</em>
<strong>inmutable</strong>:</li>
</ul>
<div class="line-block"><strong>espec</strong> <em>pila</em><br />
       <strong>parámetros</strong><br />
             <em>elemento</em><br />
       <strong>operaciones</strong><br />
             <code>pvacia</code> : <span
class="math inline">\longrightarrow</span> <em>pila</em><br />
             <code>apilar</code> : <em>pila</em> <span
class="math inline">\times</span> <em>elemento</em> <span
class="math inline">\longrightarrow</span> <em>pila</em><br />
             <strong>parcial</strong> <code>desapilar</code> :
<em>pila</em> <span class="math inline">\longrightarrow</span>
<em>pila</em><br />
             <strong>parcial</strong> <code>cima</code> : <em>pila</em>
<span class="math inline">\longrightarrow</span> <em>elemento</em><br />
             <code>vacia?</code> : <em>pila</em> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\mathbb{B}</span><br />
       <strong>var</strong><br />
             <span class="math inline">p</span> : <em>pila</em>; <span
class="math inline">x</span> : <em>elemento</em><br />
       <strong>ecuaciones</strong><br />
             <code>cima</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\equiv</span> <span
class="math inline">x</span><br />
             <code>desapilar</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\equiv</span> <span
class="math inline">p</span><br />
             <code>vacia?</code>(<code>pvacia</code>) <span
class="math inline">\equiv</span> <span
class="math inline">V</span><br />
             <code>vacia?</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\equiv</span> <span
class="math inline">F</span><br />
             <code>cima</code>(<code>pvacia</code>) <span
class="math inline">\equiv</span> <strong>error</strong><br />
             <code>desapilar</code>(<code>pvacia</code>) <span
class="math inline">\equiv</span> <strong>error</strong></div>
</section>
<section class="slide level5" data-number="2.1.2.7.1">

<ul>
<li>La especificación del mismo tipo <em>pila</em> pero
<strong>mutable</strong> podría ser:</li>
</ul>
<div class="line-block"><strong>espec</strong> <em>pila</em><br />
       <strong>parámetros</strong><br />
             <em>elemento</em><br />
       <strong>operaciones</strong><br />
             <code>pila</code> : <span
class="math inline">\longrightarrow</span> <em>pila</em><br />
             <code>apilar</code> : <em>pila</em> <span
class="math inline">\times</span> <em>elemento</em> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\emptyset</span><br />
             <strong>parcial</strong> <code>desapilar</code> :
<em>pila</em> <span class="math inline">\longrightarrow</span> <span
class="math inline">\emptyset</span><br />
             <strong>parcial</strong> <code>cima</code> : <em>pila</em>
<span class="math inline">\longrightarrow</span> <em>elemento</em><br />
             <code>vacía?</code> : <em>pila</em> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\mathbb{B}</span><br />
             _ <code>==</code> _ : <em>pila</em> <span
class="math inline">\times</span> <em>pila</em> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\mathbb{B}</span><br />
       <strong>var</strong><br />
             <span class="math inline">p</span>, <span
class="math inline">p_1</span>, <span class="math inline">p_2</span> :
<em>pila</em>; <span class="math inline">x</span> :
<em>elemento</em><br />
       <strong>ecuaciones</strong><br />
             <span class="math inline">p_1</span> <code>==</code> <span
class="math inline">p_2</span> <span class="math inline">\equiv</span>
«<span class="math inline">p_1</span> y <span
class="math inline">p_2</span> tienen los mismos elementos en el mismo
orden»<br />
             <code>vacía?</code>(<span class="math inline">p</span>)
<span class="math inline">\equiv</span> <span
class="math inline">p</span> <code>==</code> <code>pila</code><br />
             <code>apilar</code>(<span class="math inline">p</span>,
<span class="math inline">x</span>)   { Apila el elemento <span
class="math inline">x</span> en la cima de la pila <span
class="math inline">p</span> }<br />
             <code>desapilar</code>(<span class="math inline">p</span>)
  { Saca de la pila <span class="math inline">p</span> el elemento
situado en su cima }<br />
             <code>cima</code>(<span class="math inline">p</span>) <span
class="math inline">\equiv</span> «el último elemento apilado en <span
class="math inline">p</span> y aún no desapilado»<br />
             <code>vacía?</code>(<span class="math inline">p</span>)
<span class="math inline">\Longrightarrow</span>
<code>desapilar</code>(<span class="math inline">p</span>) <span
class="math inline">\equiv</span> <strong>error</strong><br />
             <code>vacía?</code>(<span class="math inline">p</span>)
<span class="math inline">\Longrightarrow</span> <code>cima</code>(<span
class="math inline">p</span>) <span class="math inline">\equiv</span>
<strong>error</strong></div>
</section>
<section class="slide level5" data-number="2.1.2.7.2">

<ul>
<li><p>A veces, la especificación de un tipo abstracto resulta más
conveniente redactarla en lenguaje natural, simplemente porque queda más
fácil de entender o más claro o fácil de leer.</p></li>
<li><p>Por ejemplo, podríamos crear un documento de
<strong>especificación en lenguaje natural</strong> del tipo abstracto
<em>pila</em> explicando qué funcionalidad tiene y las operaciones que
contiene:</p></li>
</ul>
<div class="caja">
<p><strong>Tipo</strong>: <em>pila</em></p>
<ul>
<li><p>Define una pila de elementos, de forma que se van almacenando en
el orden en que han sido introducidos y se van extrayendo en orden
contrario siguiendo una estrategia <em>LIFO</em> (<em>L</em>ast
<em>I</em>n, <em>F</em>irst <em>O</em>ut).</p></li>
<li><p>Los elementos pueden ser de cualquier tipo.</p></li>
<li><p>Dos pilas son iguales si tienen los mismos elementos y en el
mismo orden.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="2.1.2.7.3">

<div class="caja">
<p><strong>Operaciones constructoras y mutadoras:</strong></p>
<ul>
<li><p><code>pila()</code> <span
class="math inline">\longrightarrow</span> <em>pila</em></p>
<p>Crea una pila vacía (es decir, sin elementos) y la devuelve.</p></li>
<li><p><code>apilar(</code><span class="math inline">p</span>:
<em>pila</em>, <span class="math inline">elem</span><code>)</code> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\emptyset</span></p>
<p>Introduce el elemento <span class="math inline">elem</span> encima de
la pila <span class="math inline">p</span>. Ese elemento pasa a estar
ahora en la cima de la pila, por lo que tras su ejecución se debe
cumplir que <code>cima(</code><span
class="math inline">p</span><code>)</code> <code>==</code> <span
class="math inline">elem</span>. La operación no devuelve ningún
resultado.</p></li>
<li><p><code>desapilar(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\emptyset</span></p>
<p>Extrae de la pila <span class="math inline">p</span> el elemento
situado en la cima. Si <span class="math inline">p</span> está vacía, da
error. El elemento que queda ahora en la cima es el que había justo
antes de apilar el elemento recién extraído. La operación no devuelve
ningún resultado.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="2.1.2.7.4">

<div class="caja">
<p><strong>Operaciones selectoras:</strong></p>
<ul>
<li><p><span class="math inline">p_1</span>: <em>pila</em>
<code>==</code> <span class="math inline">p_2</span>: <em>pila</em>
<span class="math inline">\longrightarrow</span> <span
class="math inline">\mathbb{B}</span></p>
<p>Devuelve <span class="math inline">V</span> si <span
class="math inline">p_1</span> y <span class="math inline">p_2</span>
son dos pilas iguales, y <span class="math inline">F</span> en caso
contrario.</p>
<p>Dos pilas son iguales si tienen los mismos elementos y en el mismo
orden.</p></li>
<li><p><code>vacía?(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span
class="math inline">\longrightarrow</span> <span
class="math inline">\mathbb{B}</span></p>
<p>Devuelve <span class="math inline">V</span> si la pila <span
class="math inline">p</span> no tiene elementos, y <span
class="math inline">F</span> en caso contrario.</p></li>
<li><p><code>cima(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span
class="math inline">\longrightarrow</span> <span
class="math inline">cualquiera</span></p>
<p>Devuelve el elemento situado en la cima de la pila. Si la pila está
vacía, da error.</p>
<p>El tipo del dato devuelto es el tipo del elemento que hay en la
cima.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="2.1.2.7.5">

<ul>
<li>Una posible implementación con una clase Python podría ser:</li>
</ul>
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Pila:</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems <span class="op">=</span> []</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, otra):</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="bu">type</span>(<span class="va">self</span>) <span class="op">!=</span> <span class="bu">type</span>(otra):</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>           <span class="cf">return</span> <span class="va">NotImplemented</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems <span class="op">==</span> otra.__elems</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> vacia(<span class="va">self</span>):</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems <span class="op">==</span> []</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> apilar(<span class="va">self</span>, elem):</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems.append(elem)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> desapilar(<span class="va">self</span>):</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="va">self</span>.vacia():</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>           <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;No se puede desapilar una pila vacía&#39;</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems.pop()</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> cima(<span class="va">self</span>):</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="va">self</span>.vacia():</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>           <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;Una pila vacía no tiene cima&#39;</span>)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
</section>
<section class="slide level5" data-number="2.1.2.7.6">

<ul>
<li><p>Resulta curioso observar que la implementación, en este caso, es
probablemente más corta, elegante, precisa y fácil de entender que
cualquiera de las especificaciones que hemos visto
anteriormente.</p></li>
<li><p>De hecho, si considerásemos al lenguaje Python como un lenguaje
con el que escribir especificaciones, el código anterior resultaría la
mejor especificación de todas las que hemos visto.</p></li>
<li><p>Eso se debe a que la riqueza de tipos de Python, junto con su
sintaxis sencilla, lo hacen un lenguaje fácil de leer y con el que se
pueden expresar muchas ideas con pocos caracteres.</p></li>
<li><p>Así que una implementación puede verse como una especificación, y
un lenguaje de programación puede usarse para escribir especificaciones
(combinándolo, posiblemente, con algo de lenguaje natural).</p></li>
<li><p>Aunque esto puede parecer raro en un principio, es algo que se
hace a menudo.</p></li>
<li><p>Las especificaciones escritas con un lenguaje de programación se
denominan <strong>especificaciones operacionales</strong>.</p></li>
</ul>
</section>


</section>
<section>
<section id="miembros-de-clase" class="title-slide slide level1"
data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span>
Miembros de clase</h1>

</section>
<section id="variables-de-clase" class="title-slide slide level2"
data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span>
Variables de clase</h2>
<ul>
<li><p>Supogamos que el banco que guarda los depósitos paga intereses a
sus clientes en un porcentaje fijo sobre el saldo de sus
depósitos.</p></li>
<li><p>Ese porcentaje puede cambiar con el tiempo, pero es el mismo para
todos los depósitos.</p></li>
<li><p>Como es un valor compartido por todos los objetos de la misma
clase, se guardará en una variable local a la clase y, por tanto, se
almacenará como un atributo de la propia clase, no en una instancia
concreta de la clase.</p></li>
<li><p>Esas variables que pertenecen a la propia clase (en lugar de a
instancias concretas) se denominan <strong>variables de clase</strong> o
<strong>variables estáticas</strong>, a diferencia de las
<strong>variables de instancia</strong> que hemos estado usando hasta
ahora y que pertenecen a las instancias de la clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.1">

<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Las variables de clase se pueden crear y modificar mediante
<strong>sentencias de asignación</strong> directamente en el
<em>cuerpo</em> de la clase, fuera de cualquier definición de
método:</li>
</ul>
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    interes <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># Una variable de clase</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</div><div class="column" style="width:40%;">
<ul>
<li>Fuera de la clase, o dentro de un método de la clase, estas
variables también se pueden crear y manipular a través de una referencia
a la clase usando la sintaxis:</li>
</ul>
<p><em>clase</em><code>.</code><em>atributo</em></p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes <span class="op">=</span> <span class="fl">0.08</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.nueva <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.nueva</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div>
<ul>
<li>Esto nos indica que las variables de clase se almacenan en la propia
clase, es decir, en el objeto que representa a la clase.</li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="3.1.0.0.2">

<ul>
<li><p>Las variables de clase también se pueden acceder como cualquier
variable de instancia, a partir de una instancia de la clase:</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2 <span class="op">=</span> Deposito(<span class="dv">400</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes          <span class="co"># Accede al interés de la clase Deposito</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># También</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2.interes                <span class="co"># También</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes <span class="op">=</span> <span class="fl">0.08</span>   <span class="co"># Cambia la variable de clase</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span>                          <span class="co"># Se comprueba que ha cambiado</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># Cambia también para la instancia</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2.interes                <span class="co"># Cambia para todas las instancias</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span></code></pre></div>
<p>Pero esta segunda forma no es conveniente, como ahora
veremos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.3">

<ul>
<li>Si intentamos cambiar el valor de una variable de clase desde una
instancia, lo que ocurre en realidad es que <strong>creamos una nueva
variable de instancia con el mismo nombre</strong> que la variable de
clase:</li>
</ul>
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes <span class="op">=</span> <span class="fl">0.08</span>         <span class="co"># Crea una nueva variable de instancia</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># Accede a la variable de instancia</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes          <span class="co"># Accede a la variable de clase</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span></code></pre></div>
<ul>
<li><p>Esto ocurre porque la variable de instancia se almacena en el
objeto, no en la clase, y al acceder desde el objeto tiene
preferencia.</p></li>
<li><p>Por ello, es conveniente acostumbrarse a usar siempre el nombre
de la clase para acceder y cambiar el valor de una variable de clase, en
lugar de hacerlo a través de una instancia.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.4">

<ul>
<li>Para acceder al valor de una variable de clase dentro de un método,
aunque sea de la misma clase, usaremos la misma sintaxis
<em>clase</em><code>.</code><em>variable</em>, ya que de lo contrario la
variable no estará en el entorno:</li>
</ul>
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    interes <span class="op">=</span> <span class="fl">0.02</span>   <span class="co"># Una variable de clase</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> total(<span class="va">self</span>):</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accede a la variable de clase Deposito.interes para calcular</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># el saldo total más los intereses (no funciona si intentamos</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># poner interes en lugar de Deposito.interes):</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.saldo() <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> Deposito.interes)</span></code></pre></div>
</section>
<section id="ejercicios" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicios</h5>
<ol start="2" class="example" type="1">
<li><p>¿Qué ocurre si en el método <code>total</code> del código
anterior usamos <code class="sourceCode python">interes</code> en lugar
de <code>Deposito.interes</code>? ¿Por qué?</p></li>
<li><p>¿Qué problema puede haber si en el método <code>total</code> del
código anterior usamos <code
class="sourceCode python"><span class="va">self</span>.interes</code> en
lugar de <code>Deposito.interes</code>? ¿Por qué?</p></li>
</ol>
</section>

<section id="métodos-estáticos" class="title-slide slide level2"
data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span>
Métodos estáticos</h2>
<ul>
<li><p>Los <strong>métodos estáticos</strong> son métodos definidos
dentro de una clase pero que <strong>no se ejecutan sobre ninguna
instancia</strong>.</p></li>
<li><p>Al no haber instancia, <strong>los métodos estáticos no reciben
ninguna instancia como argumento</strong> a través del primer parámetro
<code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
<li><p>En realidad, un método estático es básicamente <strong>una
función normal definida dentro de una clase</strong> y que está pensada
para ser ejecutada como cualquier otra función.</p></li>
<li><p>Por contraste, los métodos que se ejecutan sobre un objeto se
denominan <strong>métodos de instancia</strong>, para distinguirlos de
los estáticos.</p></li>
<li><p>Al estar definida dentro de la clase, para acceder a un método
estático desde fuera de la clase o desde un método de la propia clase,
hay que usar el operador punto (<code>.</code>) desde una referencia a
la clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.1">

<ul>
<li><p>Por ejemplo, supongamos una clase <code>Numero</code> que
representa números.</p>
<p>Una manera de implementarla sin métodos estáticos sería suponer que
cada instancia de la clase representa un número y que las operaciones
modifican ese número, recibiendo el resto de operandos mediante
argumentos:</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Numero:</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valor):</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(valor)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_valor(<span class="va">self</span>, valor):</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__valor <span class="op">=</span> valor</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_valor(<span class="va">self</span>):</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__valor</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(<span class="va">self</span>, otro):</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">+</span> otro)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(<span class="va">self</span>, otro):</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">*</span> otro)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">7</span>)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n.get_valor())       <span class="co"># Imprime 11</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>n.mult(<span class="dv">5</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n.get_valor())       <span class="co"># Imprime 55</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.2">

<ul>
<li><p>Para crear un método estático dentro de una clase:</p>
<ul>
<li><p>Se añade el <strong>decorador</strong> <code
class="sourceCode python"><span class="at">@staticmethod</span></code>
justo encima de la definición del método.</p></li>
<li><p>El método no debe recibir el parámetro <code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
</ul></li>
<li><p>Sabiendo eso, podemos crear una clase <code>Calculadora</code>
que ni siquiera haría falta instanciar y que contendría las operaciones
a realizar con los números.</p></li>
<li><p>Esas operaciones serían métodos estáticos.</p></li>
<li><p>Al estar definidos dentro de la clase <code>Calculadora</code>,
para acceder a ellos habrá que usar el operador punto
(<code>.</code>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.3">

<ul>
<li><p>Tendríamos, por tanto:</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Calculadora:</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(x, y):</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(x, y):</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">*</span> y</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Calculadora.suma(<span class="dv">4</span>, <span class="dv">7</span>)   <span class="co"># Llamamos al método suma directamente sobre la clase</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s)                     <span class="co"># Imprime 11</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> Calculadora.mult(<span class="dv">11</span>, <span class="dv">5</span>)  <span class="co"># Llamamos al método mult directamente sobre la clase</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m)                     <span class="co"># Imprime 55</span></span></code></pre></div></li>
<li><p>De este modo, los números no se modifican.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.4">

<ul>
<li>Lo que hace básicamente el decorador <code
class="sourceCode python"><span class="at">@staticmethod</span></code>
es decirle al intérprete que se salte el mecanismo interno habitual de
pasar automáticamente una referencia del objeto como primer parámetro
del método (el que normalmente se llama <code
class="sourceCode python"><span class="va">self</span></code>).</li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo, con la clase <code>Numero</code>, si tenemos
que:</p>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span></code></pre></div>
<p>es lo mismo hacer:</p>
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">5</span>)</span></code></pre></div>
<p>que hacer:</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Numero.suma(n, <span class="dv">5</span>)</span></code></pre></div>
<p>ya que <code>suma</code> es un método de instancia en la clase
<code>Numero</code>.</p>
<p>(Esta última forma no se usa nunca, ya que confunde al
lector.)</p></li>
</ul>
</div><div class="column">
<ul>
<li><p>En cambio, en la clase <code>Calculadora</code>, el método
<code>suma</code> es estático, no hay objeto <em>sobre</em> el que
actuar, así que no se pasa automáticamente ninguna referencia.</p></li>
<li><p>Todos los argumentos deben pasarse expresamente al método:</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Calculadora.suma(<span class="dv">4</span>, <span class="dv">3</span>)</span></code></pre></div></li>
<li><p>Como lo que se reciben son enteros y no instancias de
<code>Numero</code>, no los puede modificar.</p></li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.0.0.5">

<ul>
<li><p>Podemos combinar métodos estáticos y no estáticos en la misma
clase.</p></li>
<li><p>En tal caso, debemos recordar que los métodos estáticos de una
clase no pueden acceder a los miembros no estáticos de esa clase, ya que
no disponen de la referencia al objeto (<code
class="sourceCode python"><span class="va">self</span></code>).</p></li>
<li><p>En cambio, un método estático sí puede acceder a variables de
clase o a otros métodos estáticos (de la misma clase o de cualquier otra
clase) usando el operador punto (<code>.</code>).</p></li>
</ul>
</section>
<section id="ejemplo" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejemplo</h5>
<div class="columns">
<div class="column" style="width:65%;">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Numero:</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valor):</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(valor)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_valor(<span class="va">self</span>, valor):</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__valor <span class="op">=</span> valor</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_valor(<span class="va">self</span>):</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__valor</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(<span class="va">self</span>, otro):</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">+</span> otro)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(<span class="va">self</span>, otro):</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">*</span> otro)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma_es(x, y):</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult_es(x, y):</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(y):</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Hay que poner «Numero.»:</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>            ret <span class="op">=</span> Numero.suma_es(ret, x)</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ret</span></code></pre></div>
</div><div class="column" style="width:35%;">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El número es 4:</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora el número es 9:</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">5</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Devuelve 15:</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Numero.suma_es(<span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Devuelve 56:</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> Numero.mult_es(<span class="dv">7</span>, <span class="dv">8</span>)</span></code></pre></div>
</div>
</div>
</section>
</section>
<section>
<section id="clases-genéricas-y-métodos-genéricos"
class="title-slide slide level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Clases
genéricas y métodos genéricos</h1>

</section>
<section id="definición-y-uso" class="title-slide slide level2"
data-number="4.1">
<h2 data-number="4.1"><span class="header-section-number">4.1</span>
Definición y uso</h2>
<ul>
<li><p>Al igual que existen <em>funciones genéricas</em>, también
existen clases genéricas y métodos genéricos.</p></li>
<li><p>Esquemáticamente, las <strong>clases genéricas</strong> tienen la
siguiente forma:</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Pila[T]: ...</span></code></pre></div></li>
<li><p>Aquí, <code>T</code> es una <strong>variable de tipo</strong> que
representa a un tipo cualquiera.</p></li>
<li><p>Al usar la sintaxis <code>[T]</code>, expresamos el hecho de que
<code>T</code> representa un <strong>parámetro de tipo</strong> para la
clase, y sirve para expresar el hecho de que la clase que estamos
definiendo es genérica.</p></li>
<li><p>Las clases genéricas pueden contener <em>métodos genéricos</em> y
<em>métodos no genéricos</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.1">

<ul>
<li><p>Los <strong>métodos genéricos</strong> son métodos en cuya
definición aparecen, como variables de tipo, algunos o todos los
parámetros de tipo de la clase en la que se está definiendo el
método.</p>
<p>Esas variables de tipo no se escriben en la definición del método
usando la sintaxis <code>[T]</code>, ya que no son parámetros de tipo
del método, sino de la clase.</p></li>
<li><p>Los métodos genéricos pueden tener, además, sus propios
parámetros de tipo que sí aparecerían entre corchetes.</p></li>
<li><p>En definitiva, las clases genéricas y los métodos genéricos van
de la mano y se definen de forma coordinada.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.2">

<ul>
<li><p>Un ejemplo de pila genérica podría ser la siguiente:</p>
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Pila[T]:</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Una pila de elementos de tipo T.</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items: <span class="bu">list</span>[T] <span class="op">=</span> []</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> apilar(<span class="va">self</span>, item: T) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Añade un elemento a la pila.&quot;&quot;&quot;</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items.append(item)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> desapilar(<span class="va">self</span>) <span class="op">-&gt;</span> T <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Saca y devuelve el último elemento de la pila.&quot;&quot;&quot;</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.esta_vacia():</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__items.pop()</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cima(<span class="va">self</span>) <span class="op">-&gt;</span> T <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Devuelve el elemento en la cima sin quitarlo.&quot;&quot;&quot;</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.esta_vacia():</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__items[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> esta_vacia(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Indica si la pila está vacía.&quot;&quot;&quot;</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.__items) <span class="op">==</span> <span class="dv">0</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.3">

<ul>
<li><p>Ejemplo de uso:</p>
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pila de enteros</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>pila_enteros <span class="op">=</span> Pila[<span class="bu">int</span>]()</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>pila_enteros.apilar(<span class="dv">10</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>pila_enteros.apilar(<span class="dv">20</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pila_enteros.cima())      <span class="co"># 20</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pila_enteros.desapilar()) <span class="co"># 20</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pila_enteros.desapilar()) <span class="co"># 10</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pila_enteros.desapilar()) <span class="co"># None</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pila de cadenas</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>pila_cadenas <span class="op">=</span> Pila[<span class="bu">str</span>]()</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>pila_cadenas.apilar(<span class="st">&quot;hola&quot;</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>pila_cadenas.apilar(<span class="st">&quot;mundo&quot;</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pila_cadenas.cima())      <span class="co"># &quot;mundo&quot;</span></span></code></pre></div></li>
<li><p>Ventajas de hacer que la clase sea genérica:</p>
<ul>
<li><p>Puedes crear <code>Pila[int]</code>, <code>Pila[str]</code>,
<code>Pila[float]</code>, etc.</p></li>
<li><p>El verificador de tipos (<code>mypy</code>, <code>pyright</code>)
sabrá qué tipo de dato se espera en cada instancia y marcará errores si
se intenta usar otro.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="bibliografía"
class="title-slide slide level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Bibliografía</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-abelson_structure_1996" class="csl-entry" role="listitem">
Abelson, Harold, Gerald Jay Sussman, and Julie Sussman. 1996.
<em>Structure and Interpretation of Computer Programs</em>. 2nd ed. MIT
Press ; McGraw-Hill.
</div>
<div id="ref-denero_composing_nodate" class="csl-entry" role="listitem">
DeNero, John. n.d. <em>Composing <span>Programs</span></em>. <a
href="http://www.composingprograms.com">http://www.composingprograms.com</a>.
</div>
<div id="ref-python_software_foundation_sitio_nodate" class="csl-entry"
role="listitem">
Python Software Foundation. n.d. <em>Sitio Web de Documentación de
<span>Python</span></em>. <a
href="https://docs.python.org/3">https://docs.python.org/3</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script src="./reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="./reveal.js/plugin/notes/notes.js"></script>
  <script src="./reveal.js/plugin/search/search.js"></script>
  <script src="./reveal.js/plugin/zoom/zoom.js"></script>
  <script src="./reveal.js/plugin/reveal.js-menu/menu.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 1080,
        // The display mode that will be used to show slides
        display: 'block',

        menu: {
          hideMissingTitles: true,
        },

        dependencies: [
          { src: './reveal.js/plugin/reveal.js-quiz/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, checkAnswerText: 'Comprueba la respuesta', nextQuestionText: 'Siguiente &raquo;', backButtonText: '&laquo; Anterior', tryAgainText: 'Prueba de nuevo', preventUnansweredText: 'Selecciona una respuesta', questionCountText: 'Pregunta %current de %total', skipStartButton: true}); } }
        ],

        // reveal.js plugins
        plugins: [
          RevealMenu,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="text/javascript">
       var title = document.getElementsByClassName('title')[0];
       title = title != null ? title.innerHTML : '';
       var author = document.getElementsByClassName('author')[0];
       author = author != null ? author.innerHTML : '';
       var date = document.getElementsByClassName('date')[0];
       date = date != null ? date.innerHTML : '';
       document.getElementById('header-left').innerHTML = '<a href="#/title-slide">' + title + '</a>';
       document.getElementById('footer-left').innerHTML = '<a href="https://pro.iesdonana.org">&copy; ' + author + ' (' + date + ')</a>';

       function updateHeader(nd) {
           var hr = document.getElementById('header-right');
           while (hr.children.length > 0) {
               hr.removeChild(hr.lastChild);
           }
           buscar(nd, 3, hr);
           buscar(nd, 2, hr);
           buscar(nd, 1, hr);
           hr.style.fontSize = Math.round(50 * Reveal.getScale()) + '%';
           hr.style.fontSize = Math.max(Number.parseInt(getComputedStyle(hr).fontSize), 12) + 'px';
           var hl = document.getElementById('header-left');
           hl.style.fontSize = hr.style.fontSize;
       }

       function buscar(nd, level, hr) {
           if (!nd.classList.contains('level' + (level - 1))) {
               for (var n = nd; n != null; n = n.previousSibling) {
                   if (n.nodeType == Node.TEXT_NODE) {
                       continue;
                   }
                   var cl = n.classList;
                   if (cl.contains('level' + level)) {
                       var h = n.querySelector('h' + level);
                   } else if (cl.contains('level' + (level - 1))) {
                       break;
                   } else {
                       continue;
                   }
                   if (h == null || Reveal.getCurrentSlide().id == 'title-slide') {
                       hr.innerHTML = '';
                   } else {
                       var el = document.createElement('a');
                       var href = '#/' + n.id;
                       el.href = href;
                       el.innerHTML = h.innerHTML;
                       var a = el.querySelector('a');
                       if (a !== null) {
                           a.href = href;
                       }
                       if (hr.innerHTML != '') {
                           hr.innerHTML = ' &mdash; ' + hr.innerHTML;
                       }
                       hr.insertBefore(el, hr.firstChild);
                   }
                   break;
               }
           }
       }

       // On Reveal.js ready event, copy header/footer <div>
       // into each `.slide-background` <div>
       Reveal.on('ready', event => {
           var header = document.getElementById('header');
           document.querySelector('.reveal').appendChild(header);
           updateHeader(Reveal.getCurrentSlide());
       });

       Reveal.on('slidechanged', event => {
           // event.previousSlide, event.currentSlide, event.indexh, event.indexv
           updateHeader(event.currentSlide);
       });
    </script>
    </body>
</html>
