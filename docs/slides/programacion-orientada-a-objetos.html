<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Ricardo Pérez López">
  <title>Programación orientada a objetos</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="./reveal.js/dist/reset.css">
  <link rel="stylesheet" href="./reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #268bd2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #cb4b16; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #d33682; } /* BaseN */
    code span.bu { color: #4070a0; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #dc322f; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #93a1a1; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #6c71c4; } /* DataType */
    code span.dv { color: #d33682; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #d33682; } /* Float */
    code span.fu { color: #4070a0; } /* Function */
    code span.im { font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #268bd2; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #a57800; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #2aa198; } /* SpecialString */
    code span.st { color: #2aa198; } /* String */
    code span.va { color: #6c71c4; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <link rel="stylesheet" href="./reveal.js/dist/theme/solarized.css" id="theme">
  <link rel="stylesheet" href="custom.css"/>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
  <style type="text/css">
      #header-left {
          position: absolute;
          font-size: 25%;
          top: 0%;
          left: 0%;
          margin-left: 10px;
          margin-top: 10px;
      }
      #header-right {
          position: absolute;
          font-size: 25%;
          top: 0%;
          right: 0%;
          margin-right: 10px;
          margin-top: 10px;
      }
      #footer-left {
          position: absolute;
          font-size: 25%;
          bottom: 0%;
          left: 0%;
          margin-left: 10px;
          margin-bottom: 10px;
      }
  </style>
</head>
<body>
<div id="hidden" style="display:none;">
    <div id="header">
        <div id="header-left"></div>
        <div id="header-right"></div>
        <div id="footer-left"></div>
    </div>
</div>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function(event) {
        var title = document.getElementsByClassName('title')[0];
        title = title != null ? title.innerHTML : '';
        var author = document.getElementsByClassName('author')[0];
        author = author != null ? author.innerHTML : '';
        var date = document.getElementsByClassName('date')[0];
        date = date != null ? date.innerHTML : '';
        document.getElementById('header-left').innerHTML = '<a href="#/title-slide">' + title + '</a>';
        document.getElementById('footer-left').innerHTML = '<a href="https://pro.iesdonana.org">&copy; ' + author + ' (' + date + ')</a>';

        function updateHeader(nd) {
            var hr = document.getElementById('header-right');
            while (hr.children.length > 0) {
                hr.removeChild(hr.lastChild);
            }
            buscar(nd, 3, hr);
            buscar(nd, 2, hr);
            buscar(nd, 1, hr);
            hr.style.fontSize = Math.round(50 * Reveal.getScale()) + '%';
            hr.style.fontSize = Math.max(Number.parseInt(getComputedStyle(hr).fontSize), 12) + 'px';
            var hl = document.getElementById('header-left');
            hl.style.fontSize = hr.style.fontSize;
        }

        function buscar(nd, level, hr) {
            if (!nd.classList.contains('level' + (level - 1))) {
                for (var n = nd; n != null; n = n.previousSibling) {
                    if (n.nodeType == Node.TEXT_NODE) {
                        continue;
                    }
                    var cl = n.classList;
                    if (cl.contains('level' + level)) {
                        var h = n.querySelector('h' + level);
                    } else if (cl.contains('level' + (level - 1))) {
                        break;
                    } else {
                        continue;
                    }
                    if (h == null || Reveal.getCurrentSlide().id == 'title-slide') {
                        hr.innerHTML = '';
                    } else {
                        var el = document.createElement('a');
                        var href = '#/' + n.id;
                        el.href = href;
                        el.innerHTML = h.innerHTML;
                        var a = el.querySelector('a');
                        if (a !== null) {
                            a.href = href;
                        }
                        if (hr.innerHTML != '') {
                            hr.innerHTML = ' &mdash; ' + hr.innerHTML;
                        }
                        hr.insertBefore(el, hr.firstChild);
                    }
                    break;
                }
            }
        }

        // On Reveal.js ready event, copy header/footer <div>
        // into each `.slide-background` <div>
        Reveal.addEventListener('ready', function(event) {
            var header = document.getElementById('header');
            document.querySelector('.reveal').appendChild(header);
            updateHeader(Reveal.getCurrentSlide());
        });

        Reveal.addEventListener('slidechanged', function(event) {
            // event.previousSlide, event.currentSlide, event.indexh, event.indexv
            updateHeader(event.currentSlide);
        });
    });
</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Programación orientada a objetos</h1>
  <p class="author">Ricardo Pérez López</p>
  <p class="date">IES Doñana, curso 2021/2022</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<ul>
<li><a href="#/introducción" id="/toc-introducción"><span
class="toc-section-number">1</span> Introducción</a></li>
<li><a href="#/conceptos-básicos" id="/toc-conceptos-básicos"><span
class="toc-section-number">2</span> Conceptos básicos</a></li>
<li><a href="#/paso-de-mensajes" id="/toc-paso-de-mensajes"><span
class="toc-section-number">3</span> Paso de mensajes</a></li>
<li><a href="#/identidad-e-igualdad"
id="/toc-identidad-e-igualdad"><span class="toc-section-number">4</span>
Identidad e igualdad</a></li>
<li><a href="#/encapsulación" id="/toc-encapsulación"><span
class="toc-section-number">5</span> Encapsulación</a></li>
<li><a href="#/miembros-de-clase" id="/toc-miembros-de-clase"><span
class="toc-section-number">6</span> Miembros de clase</a></li>
</ul>
</nav>
</section>

<section>
<section id="introducción" class="title-slide slide level1"
data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span>
Introducción</h1>

</section>
<section id="recapitulación" class="title-slide slide level2"
data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span>
Recapitulación</h2>
<ul>
<li><p>Recordemos lo que hemos aprendido hasta ahora:</p>
<ul>
<li><p>La <strong>abstracción de datos</strong> nos permite definir
tipos de datos complejos llamados <strong>tipos abstractos de
datos</strong> (<em>TAD</em>), que se describen únicamente mediante las
<strong>operaciones</strong> que manipulan esos datos y con
<strong>independencia de su implementación</strong>.</p></li>
<li><p>Las funciones pueden tener <strong>estado interno</strong> usando
clausuras, que se crean a partir de funciones locales, funciones de
orden superior y variables no locales.</p></li>
<li><p>Una función puede representar un dato.</p></li>
<li><p>Un dato puede tener estado interno, usando el estado interno de
la función que lo representa.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.1">

<ul>
<li><p>Además:</p>
<ul>
<li><p>El <strong>paso de mensajes</strong> agrupa las operaciones que
actúan sobre ese dato dentro de una función que responde a diferentes
mensajes <strong>despachando</strong> a otras funciones dependiendo del
mensaje recibido.</p></li>
<li><p>La función que representa al dato <strong>encapsula su estado
interno junto con las operaciones</strong> que lo manipulan en <em>una
única unidad sintáctica</em> que oculta sus detalles de
implementación.</p></li>
</ul></li>
<li><p>En conclusión:</p>
<div class="caja centered">
<p>Una <strong>función</strong> puede implementar todo un <strong>tipo
abstracto de datos</strong>.</p>
</div></li>
</ul>
</section>

<section id="objetos" class="title-slide slide level2"
data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span>
Objetos</h2>
<ul>
<li><p>Al principio, distinguíamos entre funciones y datos: las
funciones realizan operaciones sobre los datos y éstos esperan
pasivamente a que se opere con ellos.</p></li>
<li><p>Cuando empezamos a representar a los datos con funciones, vimos
que los datos también pueden encapsular
<strong>comportamiento</strong>.</p></li>
<li><p>Esos datos ahora representan información, pero también <strong>se
comportan</strong> como las cosas que representan.</p></li>
<li><p>Por tanto, los datos ahora saben cómo reaccionar ante los
mensajes que reciben cuando el resto del programa les envía
mensajes.</p></li>
<li><p>Esta forma de ver a los datos como <strong>objetos</strong>
activos que interactúan entre sí y que son capaces de reaccionar y
cambiar su estado interno en función de los mensajes que reciben, da
lugar a todo un nuevo paradigma de programación llamado
<strong>orientación a objetos</strong> o <strong>Programación Orientada
a Objetos</strong> (<em>POO</em>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.1">

<div class="caja">
<p><strong>Definición:</strong></p>
<p>La <strong>programación orientada a objetos</strong> es un paradigma
de programación en el que los programas se ven como formados por
entidades llamadas <strong>objetos</strong> que recuerdan su propio
<strong>estado interno</strong> y que se comunican entre sí mediante el
<strong>paso de mensajes</strong> que se intercambian con la finalidad
de:</p>
<ul>
<li><p>cambiar sus estados internos,</p></li>
<li><p>compartir información y</p></li>
<li><p>solicitar a otros objetos el procesamiento de dicha
información.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="1.2.0.0.2">

<ul>
<li><p>La <strong>programación orientada a objetos</strong> (también
llamada <strong>OOP</strong>, del inglés <em>Object-Oriented
Programming</em>) es un método para organizar programas que reúne muchas
de las ideas vistas hasta ahora.</p></li>
<li><p>Al igual que las funciones en la abstracción de datos, los
objetos imponen <strong>barreras de abstracción</strong> entre el uso y
la implementación de los datos.</p></li>
<li><p>Al igual que los diccionarios y funciones de despacho, los
objetos responden a peticiones que otros objetos le hacen en forma de
<strong>mensajes</strong> para que se comporte de determinada
manera.</p></li>
<li><p>Los objetos tienen un <strong>estado interno local</strong> al
que no se puede acceder directamente desde el entorno global, sino que
debe hacerse por medio de las operaciones que proporciona el
objeto.</p></li>
<li><p>A efectos prácticos, por tanto, <strong>los objetos son datos
abstractos</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.3">

<ul>
<li><p>El sistema de objetos de Python proporciona una sintaxis cómoda
para promover el uso de estas técnicas de organización de
programas.</p></li>
<li><p>Gran parte de esta sintaxis se comparte entre otros lenguajes de
programación orientados a objetos.</p></li>
<li><p>Ese sistema de objetos ofrece algo más que simple comodidad:</p>
<ul>
<li><p>Proporciona una <strong>nueva metáfora</strong> para diseñar
programas en los que varios agentes independientes
<strong>interactúan</strong> dentro del ordenador.</p></li>
<li><p>Cada objeto <strong>agrupa (<em>encapsula</em>)</strong> el
estado local y el comportamiento de una manera que abstrae la
complejidad de ambos.</p></li>
<li><p>Los objetos <strong>se comunican entre sí</strong> y se obtienen
resultados útiles como consecuencia de su interacción.</p></li>
<li><p>Los objetos no sólo transmiten mensajes, sino que también
<strong>comparten el comportamiento</strong> entre otros objetos del
mismo tipo y <strong>heredan características</strong> de otros tipos
relacionados.</p></li>
</ul></li>
<li><p>El paradigma de la programación orientada a objetos tiene su
propio vocabulario que apoya la metáfora del objeto.</p></li>
</ul>
</section>
<section id="ejercicio" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol class="example" type="1">
<li>Investiga en Wikipedia los principales lenguajes orientados a
objetos que existen en el mercado. ¿En qué año salieron? ¿Cuál influyó
en cuál? ¿Cuáles son los más usados a día de hoy?</li>
</ol>
</section>
</section>
<section>
<section id="conceptos-básicos" class="title-slide slide level1"
data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span>
Conceptos básicos</h1>

</section>
<section id="atributos" class="title-slide slide level2"
data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span>
Atributos</h2>
<ul>
<li><p>Los <strong>atributos</strong> de un objeto representan los
elementos que el objeto contiene dentro de sí mismo.</p></li>
<li><p>El objeto almacena atributos porque un objeto representa un
espacio de nombres.</p></li>
<li><p>Cuando se crea un objeto, se le asocia en el montículo una zona
de memoria que, entre otras cosas, contiene la estructura en forma de
diccionario que representa el espacio de nombres del objeto.</p></li>
<li><p>Esa estructura en forma de diccionario almacena los atributos del
objeto, asociando el nombre de cada atributo con el valor que tiene ese
atributo en el objeto.</p></li>
<li><p>Los atributos pueden almacenar valores de cualquier tipo,
incluyendo funciones, ya que las funciones son valores como cualquier
otro.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.1.0.0.1">

<ul>
<li>A los atributos de un objeto se puede acceder usando el operador
punto (<code>.</code>), indicando una referencia al objeto y el nombre
del atributo al que se desea acceder:</li>
</ul>
<div class="centered">
<p><em>objeto</em><code>.</code><em>atributo</em></p>
</div>
<ul>
<li><p>Por ejemplo, si importamos el módulo <code>math</code> usando
<code>import</code> obtenemos un objeto al que se puede acceder a través
de su nombre, de forma que los elementos que contiene el módulo se
convierten en <strong>atributos</strong> del objeto
<code>math</code>.</p></li>
<li><p>Entre ellos, hay atributos que representan variables y otros que
representan funciones:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> math</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> math.pi</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.141592653589793</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> math.cos(<span class="dv">3</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">0.9899924966004454</span></span></code></pre></div></li>
</ul>
</section>

<section id="clases" class="title-slide slide level2" data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span>
Clases</h2>
<ul>
<li>Una <strong>clase</strong> es una construcción sintáctica que los
lenguajes de programación orientados a objetos proporcionan como
<em>azúcar sintáctico</em> para <strong>implementar tipos abstractos de
datos</strong> de una forma cómoda y directa sin necesidad de usar
funciones de orden superior, estado local o diccionarios de
despacho.</li>
</ul>
<div class="caja">
<p>En programación orientada a objetos:</p>
<ul>
<li><p>Se habla siempre de <strong>clases</strong> y no de <em>tipos
abstractos de datos</em>.</p></li>
<li><p>Una <strong>clase</strong> es la <strong>implementación de un
tipo abstracto de datos</strong>.</p></li>
<li><p>Las clases definen <strong>tipos de datos</strong> de pleno
derecho en el lenguaje de programación.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="2.2.0.0.1">

<ul>
<li>Recordemos el ejemplo del tema anterior en el que implementamos el
tipo abstracto de datos <strong>Depósito</strong> mediante la siguiente
<strong>función</strong>:</li>
</ul>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deposito(fondos):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(cantidad):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">nonlocal</span> fondos</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> fondos:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        fondos <span class="op">-=</span> cantidad</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fondos</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(cantidad):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">nonlocal</span> fondos</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        fondos <span class="op">+=</span> cantidad</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fondos</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo():</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fondos</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> despacho(mensaje):</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mensaje <span class="op">==</span> <span class="st">&#39;retirar&#39;</span>:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> retirar</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mensaje <span class="op">==</span> <span class="st">&#39;ingresar&#39;</span>:</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ingresar</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mensaje <span class="op">==</span> <span class="st">&#39;saldo&#39;</span>:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> saldo</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;Mensaje incorrecto&#39;</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> despacho</span></code></pre></div>
</section>
<section class="slide level5" data-number="2.2.0.0.2">

<ul>
<li>Ese mismo TAD se puede implementar como una <strong>clase</strong>
de la siguiente forma:</li>
</ul>
<div class="columns">
<div class="column" style="width:60%;">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</div><div class="column" style="width:40%;">
<ul>
<li>En el momento en que se ejecute esta definición, el intérprete
incorporará al sistema un nuevo tipo llamado <code>Deposito</code>.</li>
</ul>
</div>
</div>
<ul>
<li>Más tarde estudiaremos los detalles técnicos que diferencian ambas
implementaciones, pero ya apreciamos que por cada operación sigue
habiendo una función (aquí llamada <strong>método</strong>), que
desaparece la función <code>despacho</code> y que aparece una extraña
función <code
class="sourceCode python"><span class="fu">__init__</span></code>.</li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.3">

<ul>
<li><p>La <strong>definición de una clase</strong> es una estructura
sintáctica que crea un <strong>espacio de nombres</strong> y define su
propio <strong>ámbito</strong>.</p></li>
<li><p>Esa definición está formada por un <strong>bloque de
sentencias</strong> que se ejecutarán dentro de ese ámbito en el momento
en que el intérprete ejecute la definición:</p>
<div class="line-block"><strong><code>class</code></strong> <span
style="color:teal">⟨<em>nombre</em>⟩</span><strong><code>:</code></strong><br />
      <span style="color:teal">⟨<em>sentencia</em>⟩</span><span
class="math inline">^+</span></div></li>
<li><p>Todas las definiciones que se realicen directamente en el ámbito
de la clase como consecuencia de ejecutar su bloque de sentencias, serán
<strong>locales</strong> a la clase y se almacenarán en el espacio de
nombres de la clase, ya que, durante la ejecución del bloque de
sentencias, el espacio de nombres actual es el espacio de nombres de la
clase.</p></li>
<li><p>Los elementos así definidos y almacenados directamente en el
espacio de nombres de la clase se denominan <strong>miembros</strong> o
<strong>atributos</strong> de la clase.</p></li>
<li><p>Las funciones que son miembros de una clase se denominan
<strong>métodos</strong> de la clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.4">

<ul>
<li><p>Por ejemplo, las funciones <code
class="sourceCode python"><span class="fu">__init__</span></code>,
<code>retirar</code>, <code>ingresar</code> y <code>saldo</code>
pertenecen a la clase <code>Deposito</code> y sólo existen dentro de
ella (son <em>locales</em> a la clase), porque sus definiciones se
almacenan en el espacio de nombres de la clase.</p></li>
<li><p>Ese espacio de nombres es un <strong>marco</strong> que se
almacena en la pila mientras se ejecuta la definición de la clase, y que
formará parte del entorno mientras dure esa ejecución.</p></li>
<li><p>Cuando se termina de ejecutar la definición de la clase, se saca
ese marco de la pila y se convierte en un <strong>objeto</strong> que
almacena en forma de <strong>atributos</strong> a los miembros de esa
clase.</p>
<p>Por tanto, ese objeto acaba almacenando el espacio de nombres de la
clase y representando a dicha clase dentro del programa.</p></li>
<li><p>Recordemos que durante la definición de una función no se ejecuta
su cuerpo, sino que simplemente se crea la ligadura entre el nombre de
la función y la propia función.</p>
<p>Por tanto, al ejecutar la definición de una clase no se ejecutan los
cuerpos de sus métodos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.5">

<ul>
<li><p>Por ejemplo, en el código anterior:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb4-3"><a href="#cb4-3"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb4-7"><a href="#cb4-7"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb4-9"><a href="#cb4-9"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb4-12"><a href="#cb4-12"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb4-13"><a href="#cb4-13"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb4-16"><a href="#cb4-16"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div></li>
<li><p>En la línea 10 tendríamos el siguiente entorno:</p>
<div class="centered">
<p><img data-src="images/entorno-clase-linea10.svg" class="plain"
style="width:80.0%" /></p>
</div></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.6">

<ul>
<li><p>En general, no importa el orden en el que aparecen las
definiciones dentro de la clase, salvo excepciones.</p></li>
<li><p>Recordemos que el cuerpo de una función (aquí las funciones se
llaman <em>métodos</em>) no se ejecuta cuando se define la función, sino
cuando se la llama. Por tanto, si un método usa a otro, no importará el
orden en el que se hayan definido.</p></li>
<li><p>Por ejemplo, en el código anterior, los miembros se podrían haber
definido en cualquier otro orden (<code>retirar</code> después de
<code>saldo</code>, <code>ingresar</code> antes de
<code>__init__</code>…, da igual).</p></li>
<li><p>En cambio, si hacemos una definición a partir de otra, el orden
sí importará. Por ejemplo, aquí sí es importante que <code>hola</code>
se defina antes que <code>saludo</code>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Prueba:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> hola(<span class="va">self</span>):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Hola&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    saludo <span class="op">=</span> hola</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.7">

<ul>
<li><p>Como se dijo anteriormente, con las <strong>clases</strong>
ocurre lo siguiente:</p>
<ul>
<li><p>Al entrar en la definición de la clase, se crea un nuevo espacio
de nombres en forma de marco en la pila, que contiene las definiciones
que se van creando durante la ejecución de la clase.</p></li>
<li><p>Al salir de la definición de la clase, se saca el marco de la
pila y con él se crea un objeto que acaba almacenando ese espacio de
nombres, de forma que <strong>las ligaduras que contiene se convierten
en atributos del objeto</strong>.</p></li>
</ul>
<div class="caja">
<p><strong>La clase acaba siendo un objeto más, almacenado en el
montículo</strong>, que se ligará al nombre de la clase en el espacio de
nombres donde se haya definido ésta.</p>
</div></li>
<li><p>Ese objeto «clase» permanecerá en memoria mientras exista, al
menos, una referencia que apunte a él.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.0.0.8">

<ul>
<li><p>Si ejecutamos la anterior definición en el <a
href="http://pythontutor.com/visualize.html#code=class%20Deposito%3A%0A%20%20%20%20def%20__init__%28self,%20fondos%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%3D%20fondos%0A%0A%20%20%20%20def%20retirar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20if%20cantidad%20%3E%20self.fondos%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20&#39;Fondos%20insuficientes&#39;%0A%20%20%20%20%20%20%20%20self.fondos%20-%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20ingresar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%2B%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20saldo%28self%29%3A%0A%20%20%20%20%20%20%20%20return%20self.fondos&amp;cumulative=false&amp;curInstr=1&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false"
target="_blank">Pythontutor</a>, observamos que se crea en memoria un
objeto que, como todo objeto, contiene su propio espacio de nombres
representado con una estructura similar al <strong>diccionario de
despacho</strong> que creábamos antes a mano, el cual almacena los
miembros de la clase como atributos del objeto, asociando el nombre de
cada operación con la función (el método) correspondiente.</p></li>
<li><p>Ese objeto representa a la clase en la memoria durante la
ejecución del programa, y se liga al nombre de la clase en el espacio de
nombres actual (que normalmente será el marco global).</p></li>
</ul>
<div class="centered">
<figure>
<img data-src="images/clase-estructura.png" class="plain"
style="width:55.0%" alt="La clase Deposito en memoria" />
<figcaption aria-hidden="true">La clase <code>Deposito</code> en
memoria</figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.2.0.0.9">

<!--
- El nombre de la clase es una **referencia** que apunta a la clase, la cual es
  un objeto y, por tanto, nos va a permitir acceder a sus atributos (los
  miembros de la clase) usando el operador punto (`.`).
-->
<ul>
<li><p>Como las clases son objetos, debemos usar el operador punto
(<code>.</code>) para acceder a un miembro de una clase, indicando la
referencia a la clase (normalmente, su nombre) y el nombre del miembro
al que se desea acceder:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.retirar</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>function Deposito.retirar at <span class="bn">0x7f6f04885160</span><span class="op">&gt;</span></span></code></pre></div></li>
<li><p>En realidad, todo lo que hemos dicho hasta ahora sobre la
creación de clases y el acceso a sus miembros, es esencialmente el mismo
mecanismo que se usa en la creación y uso de módulos.</p></li>
<li><p>Sin embargo, hay que tener cuidado, ya que <strong>las clases no
funcionan exactamente igual que los módulos en lo que se refiere al
<em>entorno</em></strong>, como veremos luego en un apartado
posterior.</p></li>
</ul>
</section>
<section id="instancias" class="title-slide slide level3"
data-number="2.2.1">
<h3 data-number="2.2.1"><span class="header-section-number">2.2.1</span>
Instancias</h3>
<ul>
<li><p>Un <strong>objeto</strong> representa un <strong>dato
abstracto</strong> de la misma manera que una <em>clase</em> representa
un <em>tipo abstracto de datos</em>.</p></li>
<li><p>Es decir: un objeto es un caso particular de una clase, motivo
por el que también se le denomina <strong><em>instancia</em> de una
clase</strong>.</p></li>
<li><p>Un objeto es <strong>un dato que pertenece al tipo definido por
la clase</strong> de la que es instancia.</p>
<p>También se puede decir que «<strong>el objeto <em>pertenece</em> a la
clase</strong>» aunque sea más correcto decir que «<strong>es
<em>instancia</em> de la clase</strong>».</p></li>
<li><p>El proceso de crear un objeto a partir de una clase se denomina
<strong>instanciar la clase</strong> o
<strong>instanciación</strong>.</p></li>
<li><p>En un lenguaje orientado a objetos <em>puro</em>, todos los datos
que manipula el programa son objetos y, por tanto, instancias de alguna
clase.</p></li>
<li><p>Existen lenguajes orientados a objetos <em>impuros</em> o
<em>híbridos</em> en los que coexisten objetos con otros datos que no
son instancias de clases.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.1">

<ul>
<li><p>Python es considerado un lenguaje orientado a objetos
<strong>puro</strong>, ya que en Python todos los datos son
objetos.</p></li>
<li><p>Por ejemplo, en Python:</p>
<ul>
<li><p>El tipo <code
class="sourceCode python"><span class="bu">int</span></code> es una
clase.</p></li>
<li><p>El entero <code
class="sourceCode python"><span class="dv">5</span></code> es un objeto,
instancia de la clase <code
class="sourceCode python"><span class="bu">int</span></code>.</p></li>
</ul></li>
<li><p>Java es un lenguaje orientado a objetos <strong>impuro</strong>,
ya que un programa Java manipula objetos pero también manipula otros
datos llamados <em>primitivos</em>, que no son instancias de ninguna
clase sino que pertenecen a un <em>tipo primitivo</em> del
lenguaje.</p></li>
<li><p>Por ejemplo, en Java:</p>
<ul>
<li><p>El tipo <code
class="sourceCode java"><span class="bu">String</span></code> es una
clase, por lo que la cadena <code
class="sourceCode java"><span class="st">&quot;Hola&quot;</span></code>
es un objeto, instancia de la clase <code
class="sourceCode java"><span class="bu">String</span></code>.</p></li>
<li><p>El tipo <code
class="sourceCode python"><span class="bu">int</span></code> es un tipo
primitivo del lenguaje, por lo que el número <code
class="sourceCode python"><span class="dv">5</span></code> no es ningún
objeto, sino un dato primitivo.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.2">

<div class="caja">
<p><strong>Las clases, por tanto, son como <em>plantillas</em> para
crear objetos</strong> que comparten el mismo comportamiento y
(normalmente) la misma estructura interna.</p>
</div>
<div class="caja">
<p>Los <strong>objetos</strong> tienen tres
<strong>características</strong> básicas:</p>
<ul>
<li><p><strong>Identidad</strong>: un objeto se puede distinguir de
otros.</p></li>
<li><p><strong>Estado</strong>: un objeto tiene un estado interno que
puede cambiar durante su vida.</p></li>
<li><p><strong>Comportamiento</strong>: un objeto se comporta de cierta
forma ante la recepción de ciertos mensajes.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="2.2.1.0.3">

<ul>
<li><p>En Python podemos instanciar una clase (creando así un nuevo
objeto) llamando a la clase como si fuera una función, del mismo modo
que hacíamos con la implementación funcional que hemos estado usando
hasta ahora:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div></li>
<li><p>Lo que ocurre al ejecutar este código es lo siguiente:</p>
<ol type="1">
<li><p>Se crea en el montículo un objeto, instancia de la clase
<code>Deposito</code>, que contiene su propio espacio de nombres
representado por una estructura con forma de diccionario.</p></li>
<li><p>Se invoca al método <code
class="sourceCode python"><span class="fu">__init__</span></code> sobre
el objeto recién creado (ya hablaremos de ésto más adelante).</p></li>
<li><p>La expresión <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>
devuelve una <strong>referencia</strong> al nuevo objeto, que
representa, a grandes rasgos, la posición de memoria donde se encuentra
almacenado el objeto (su <strong><em>identidad</em></strong>).</p></li>
<li><p>Esa referencia es la que se almacena en la variable
<code>dep</code>. O sea: <strong>en la variable no se almacena el objeto
en sí, sino una <em>referencia</em> al objeto</strong>.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.4">

<ul>
<li><p>En este ejemplo, <code>0x7fba5a16d978</code> es la dirección de
memoria donde está almacenado el objeto al que hace referencia la
variable <code>dep</code> (es decir, su <strong>identidad</strong>):</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>__main__.Deposito <span class="bu">object</span> at <span class="bn">0x7fba5a16d978</span><span class="op">&gt;</span></span></code></pre></div></li>
<li><p>Cuando una variable contiene una referencia a un objeto, decimos
que la variable <strong>se refiere</strong> al objeto o que
<strong>apunta</strong> al objeto.</p></li>
<li><p>Aunque actualmente las referencias representan direcciones de
memoria, eso no quiere decir que vaya a ser siempre así. Ese es un
detalle de implementación basada en una decisión de diseño del
intérprete que puede cambiar en posteriores versiones del mismo.</p>
<p>Esa decisión, en la práctica, es una cuestión que no nos afecta (o no
debería, al menos) a la hora de escribir nuestros programas.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.5">

<ul>
<li>Con <a
href="http://pythontutor.com/visualize.html#code=class%20Deposito%3A%0A%20%20%20%20def%20__init__%28self,%20fondos%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%3D%20fondos%0A%0A%20%20%20%20def%20retirar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20if%20cantidad%20%3E%20self.fondos%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20&#39;Fondos%20insuficientes&#39;%0A%20%20%20%20%20%20%20%20self.fondos%20-%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20ingresar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%2B%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20saldo%28self%29%3A%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%20%20%20%20%20%20%20%20%0Adep%20%3D%20Deposito%28100%29&amp;cumulative=false&amp;curInstr=5&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false"
target="_blank">Pythontutor</a> podemos observar las estructuras que se
forman al definir la clase y al instanciar dicha clase en un nuevo
objeto:</li>
</ul>
<div class="columns">
<div class="column" style="width:57%;">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div>
</div><div class="column" style="width:43%;">
<div class="centered">
<figure>
<img data-src="images/clase-objeto-estructura.png" class="plain"
style="width:100.0%"
alt="La clase Deposito y el objeto dep en memoria" />
<figcaption aria-hidden="true">La clase <code>Deposito</code> y el
objeto <code>dep</code> en memoria</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Se aprecia claramente que la clase almacena los métodos y la
instancia almacena sus fondos, y todo son atributos.</li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.6">

<ul>
<li><p>Los objetos tienen existencia propia e independiente y
permanecerán en la memoria siempre que haya al menos una referencia que
apunte a él (en caso contrario, el recolector de basura lo
eliminará).</p></li>
<li><p>De hecho, un objeto puede tener varias referencias
apuntándole.</p></li>
<li><p>Por ejemplo, si hacemos:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dep2 <span class="op">=</span> dep1</span></code></pre></div>
<p>tendremos dos variables que contienen la misma referencia y, por
tanto, <strong><em>se refieren</em> (o <em>apuntan</em>) al mismo
objeto</strong>.</p></li>
<li><p>En ese caso, decimos que <code>dep1</code> y <code>dep2</code>
son <strong>idénticas</strong>, porque las identidades de los objetos a
los que apuntan son iguales, cosa que podemos comprobar usando <code
class="sourceCode python"><span class="bu">id</span></code> o <code
class="sourceCode python"><span class="kw">is</span></code>:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">id</span>(dep1) <span class="op">==</span> <span class="bu">id</span>(dep2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="kw">is</span> dep2</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
<li><p>No olvidemos que las variables no contienen al objeto en sí
mismo, sino una referencia a éste.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.2.1.0.7">

<ul>
<li>Gráficamente, el caso anterior se puede representar de la siguiente
forma:</li>
</ul>
<div class="centered">
<figure>
<img data-src="images/dos-referencias-iguales.png" class="plain"
style="width:80.0%"
alt="Dos variables (dep1 y dep2) que apuntan al mismo objeto" />
<figcaption aria-hidden="true">Dos variables (<code>dep1</code> y
<code>dep2</code>) que <em>apuntan</em> al mismo objeto</figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.2.1.0.8">

<ul>
<li><p>Recordemos que en Python todos los tipos son clases.</p></li>
<li><p>Para saber la clase a la que pertenece el objeto, se usa la
función <code
class="sourceCode python"><span class="bu">type</span></code> o el
atributo <code class="sourceCode python">__class__</code> del
objeto:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">type</span>(dep)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;__main__.Deposito&#39;</span><span class="op">&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.__class__</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;__main__.Deposito&#39;</span><span class="op">&gt;</span></span></code></pre></div>
<p>Se nos muestra que la clase del objeto <code>dep</code> es <code
class="sourceCode python">__main__.Deposito</code>, que representa la
clase <code>Deposito</code> definida en el módulo <code
class="sourceCode python">__main__</code>.</p>
<p>Esto demuestra que el objeto <strong>recuerda</strong> su clase (la
clase que se usó para instanciarlo) porque lo guarda en un
atributo.</p></li>
<li><p>Otra forma de comprobar si un objeto es instancia de una clase
determinada es usar la función <code
class="sourceCode python"><span class="bu">isinstance</span></code><code>(</code><span
class="math inline">obj</span><code>,</code> <span
class="math inline">cls</span><code>)</code>, que devuelve <code
class="sourceCode python"><span class="va">True</span></code> si el
objeto <span class="math inline">obj</span> es instancia de la clase
<span class="math inline">cls</span>:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">isinstance</span>(<span class="dv">4</span>, <span class="bu">int</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">isinstance</span>(<span class="st">&#39;hola&#39;</span>, <span class="bu">float</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
</ul>
</section>


<section id="estado" class="title-slide slide level2" data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span>
Estado</h2>
<ul>
<li><p>Los objetos son datos abstractos que poseen su propio estado
interno, el cual puede cambiar durante la ejecución del programa como
consecuencia de los mensajes recibidos o enviados por los
objetos.</p></li>
<li><p>Eso significa que <strong>los objetos son datos
mutables</strong>.</p></li>
<li><p>Dos objetos no idénticos podrán tener estados internos
distintos.</p></li>
</ul>
</section>
<section id="variables-de-instancia" class="title-slide slide level3"
data-number="2.3.1">
<h3 data-number="2.3.1"><span class="header-section-number">2.3.1</span>
Variables de instancia</h3>
<ul>
<li><p>En terminología orientada a objetos, el estado de un objeto se
almacena en variables denominadas <strong>variables de
instancia</strong>, <strong>campos</strong> o
<strong>propiedades</strong> del objeto.</p></li>
<li><p>Esas variables de instancia se almacenan como
<strong>atributos</strong> del objeto, dentro de éste, por lo que
representan <em>variables locales</em> al objeto en su espacio de
nombres.</p></li>
</ul>
<div class="centered">
<figure>
<img data-src="images/objeto-atributos.svg" class="plain"
style="width:40.0%" alt="Objeto dep y su atributo fondos" />
<figcaption aria-hidden="true">Objeto <code>dep</code> y su atributo
<code>fondos</code></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.3.1.0.1">

<ul>
<li>Recordemos que debemos usar el operador punto (<code>.</code>) para
acceder a un atributo del objeto a partir de una referencia suya usando
la sintaxis:</li>
</ul>
<p><em>objeto</em><code>.</code><em>atributo</em></p>
<ul>
<li><p>Por ejemplo, para acceder al atributo <code>fondos</code> (que
aquí es una variable de instancia) de un objeto <code>dep</code> de la
clase <code>Deposito</code>, se usaría la expresión
<code>dep.fondos</code>:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.fondos</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code></pre></div></li>
<li><p>Y podemos cambiar el valor de la variable de instancia mediante
asignación:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.fondos <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.fondos</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="dv">400</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.1.0.2">

<ul>
<li><p>Por supuesto, dos objetos distintos pueden tener valores
distintos en sus atributos (cada atributo pertenece a un objeto):</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> Deposito(<span class="dv">400</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.fondos          <span class="co"># el atributo fondos del objeto dep1 vale 100</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.fondos          <span class="co"># el mismo atributo en el objeto dep2 vale 400</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dv">400</span></span></code></pre></div></li>
</ul>
<div class="centered">
<figure>
<img data-src="images/clase-dos-objetos-estructura.png" class="plain"
style="width:50.0%"
alt="La clase Deposito y los objetos dep1 y dep2 en memoria" />
<figcaption aria-hidden="true">La clase <code>Deposito</code> y los
objetos <code>dep1</code> y <code>dep2</code> en memoria</figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="2.3.1.0.3">

<ul>
<li><p>En Python es posible acceder directamente al estado interno de un
objeto (o, lo que es lo mismo, al valor de sus atributos), cosa que, en
principio, podría considerarse una <em>violación</em> del
<strong>principio de ocultación de información</strong> y del concepto
mismo de <strong>abstracción de datos</strong>.</p></li>
<li><p>Incluso es posible cambiar directamente el valor de un atributo
desde fuera del objeto, o crear atributos nuevos dinámicamente, haciendo
simplemente una asignación.</p></li>
<li><p>Todo esto puede resultar chocante para un programador de otros
lenguajes, pero en la práctica resulta útil al programador por la
naturaleza dinámica del lenguaje Python y por el estilo de programación
que promueve.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.1.0.4">

<ul>
<li><p>Como cualquier variable en Python, un atributo empieza a existir
en el momento en el que se le asigna un valor:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.otro</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Deposito&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;otro&#39;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.otro <span class="op">=</span> <span class="st">&#39;hola&#39;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.otro</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;hola</span></span></code></pre></div></li>
<li><p>Por tanto, <strong>en Python, los atributos de un objeto se crean
en tiempo de ejecución mediante una simple asignación</strong>.</p></li>
<li><p>Este comportamiento contrasta con el de otros lenguajes de
programación (como Java, por ejemplo), donde los atributos de un objeto
vienen determinados de antemano por la clase a la que pertenece y
siempre son los mismos.</p>
<p>Así, en Java, dos objetos de la misma clase siempre tendrán las
mismas variables de instancia, definidas por la clase (aunque la misma
variable de instancia podrá tener valores distintos en los dos objetos,
naturalmente).</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.1.0.5">

<ul>
<li><p>Ese comportamiento dinámico de Python a la hora de crear
atributos permite resultados interesantes imposibles de conseguir en
Java, como que dos objetos distintos de la misma clase puedan poseer
distintos atributos:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> Deposito(<span class="dv">400</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.uno <span class="op">=</span> <span class="st">&#39;hola&#39;</span>       <span class="co"># el atributo uno sólo existe en dep1</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.otro <span class="op">=</span> <span class="st">&#39;adiós&#39;</span>     <span class="co"># el atributo otro sólo existe en dep2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.uno</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;hola&#39;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.uno</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Deposito&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;uno&#39;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.otro</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;adiós&#39;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.otro</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Deposito&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;otro&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.1.0.6">

<ul>
<li>Con <a
href="http://pythontutor.com/visualize.html#code=class%20Deposito%3A%0A%20%20%20%20def%20__init__%28self,%20fondos%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%3D%20fondos%0A%0A%20%20%20%20def%20retirar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20if%20cantidad%20%3E%20self.fondos%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20&#39;Fondos%20insuficientes&#39;%0A%20%20%20%20%20%20%20%20self.fondos%20-%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20ingresar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%2B%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20saldo%28self%29%3A%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%20%20%20%20%20%20%20%20%0Adep1%20%3D%20Deposito%28100%29%0Adep2%20%3D%20Deposito%28400%29%0Adep1.uno%20%3D%20&#39;hola&#39;%0Adep2.otro%20%3D%20&#39;adi%C3%B3s&#39;&amp;cumulative=false&amp;curInstr=11&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false"
target="_blank">Pythontutor</a> podemos observar lo que ocurre al
instanciar dos objetos y crear atributos distintos en cada objeto:</li>
</ul>
<div class="columns">
<div class="column" style="width:57%;">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>dep2 <span class="op">=</span> Deposito(<span class="dv">400</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>dep1.uno <span class="op">=</span> <span class="st">&#39;hola&#39;</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>dep2.otro <span class="op">=</span> <span class="st">&#39;adiós&#39;</span></span></code></pre></div>
</div><div class="column" style="width:43%;">
<div class="centered">
<figure>
<img
data-src="images/clase-dos-objetos-atributos-distintos-estructura.png"
class="plain" style="width:100.0%"
alt="La clase Deposito y los objetos dep1 y dep2 con distintos atributos" />
<figcaption aria-hidden="true">La clase <code>Deposito</code> y los
objetos <code>dep1</code> y <code>dep2</code> con distintos
atributos</figcaption>
</figure>
</div>
</div>
</div>
<!--

---

- Otro ejemplo: si tenemos el número complejo `4 + 3j`, podemos preguntar cuál
  es su parte real y su parte imaginaria (que son atributos del objeto):

  ```python
  >>> c = 4 + 3j
  >>> c
  (4+3j)
  >>> c.real
  4.0
  >>> c.imag
  3.0
  ```

- Pero esos atributos no se pueden modificar directamente, ya que son de *sólo
  lectura*:

  ```python
  >>> c.real = 9.0
  Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  AttributeError: readonly attribute
  ```

-->
</section>


<section id="la-antisimetría-dato-objeto"
class="title-slide slide level2" data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span> La
antisimetría dato-objeto</h2>
<ul>
<li><p>Se da una curiosa contra-analogía entre los conceptos de dato y
objeto:</p>
<ul>
<li><p>Los objetos ocultan sus datos detrás de abstracciones y exponen
las funciones que operan con esos datos.</p></li>
<li><p>Las estructuras de datos exponen sus datos y no contienen
funciones (o, al menos, no las exponen).</p></li>
</ul></li>
<li><p>Son definiciones virtualmente opuestas y
complementarias.</p></li>
</ul>
</section>
</section>
<section>
<section id="paso-de-mensajes" class="title-slide slide level1"
data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Paso de
mensajes</h1>

</section>
<section id="resolución-de-atributos" class="title-slide slide level2"
data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span>
Resolución de atributos</h2>
<ul>
<li><p>Cuando se intenta acceder a un atributo de un objeto, lo que hace
el intérprete es lo siguiente:</p>
<ol>
<li><p>Primero busca dicho atributo dentro del objeto.</p></li>
<li><p>Si lo encuentra, devuelve su valor.</p></li>
<li><p>En caso contrario, lo busca en la clase del objeto.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.1">

<ul>
<li><p>Supongamos que tenemos el objeto <code>dep</code> de la clase
<code>Deposito</code>.</p></li>
<li><p>Si hacemos:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.fondos</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code></pre></div>
<p>el intérprete devolverá el valor del atributo <code>fondos</code> que
encuentra en el objeto <code>dep</code>, ya que el objeto contiene un
atributo con ese nombre.</p></li>
<li><p>En cambio, si hacemos:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>bound method Deposito.retirar of <span class="op">&lt;</span>__main__.Deposito <span class="bu">object</span> at <span class="bn">0x7f65736d4a90</span><span class="op">&gt;&gt;</span></span></code></pre></div>
<p>el intérprete buscará primero el atributo <code>retirar</code> en el
objeto <code>dep</code> y, al no encontrarlo allí, pasa a buscarlo en la
clase <code>Deposito</code>. Ahí sí lo encuentra, así que devuelve su
valor, que en este caso es un método.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.2">

<ul>
<li><p>Por tanto, lo anterior es <strong><em>casi</em></strong>
equivalente a hacer:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Deposito.retirar</span></code></pre></div></li>
<li><p>Pero no es <strong><em>exactamente</em></strong> igual, ya que en
el primer caso nos devuelve un método, mientras que en el segundo caso
nos devuelve una función:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>bound method Deposito.retirar of <span class="op">&lt;</span>__main__.Deposito <span class="bu">object</span> at <span class="bn">0x7f65736d4a90</span><span class="op">&gt;&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.retirar</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>function __main__.Deposito.retirar(<span class="va">self</span>, cantidad)<span class="op">&gt;</span></span></code></pre></div></li>
<li><p>Esto no nos pilla de sorpresa, ya que sabíamos que
<code>retirar</code> es un método para el objeto <code>dep</code> pero
es una función para la clase <code>Deposito</code>.</p></li>
</ul>
</section>

<section id="ejecución-de-métodos" class="title-slide slide level2"
data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span>
Ejecución de métodos</h2>
<ul>
<li><p>Como las clases implementan las operaciones como métodos, el paso
de mensajes se realiza ahora invocando, sobre un objeto, el método
correspondiente al mensaje que se enviaría al objeto.</p></li>
<li><p>Por ejemplo, si queremos enviarle el mensaje <code>saldo</code>
al objeto <code>dep</code> para saber cuál es el saldo actual de ese
depósito, invocaríamos el método <code>saldo</code> sobre el objeto
<code>dep</code> de esta forma:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.saldo()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code></pre></div></li>
<li><p>Si la operación requiere argumentos, se le pasarán al método
también:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">25</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dv">75</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.1">

<ul>
<li><p>Ya tenemos que <code>retirar</code> es un método para el objeto
<code>dep</code> y que, por tanto, <code
class="sourceCode python">dep.retirar</code> nos devuelve ese
método.</p></li>
<li><p>Pero, ¿qué ocurre cuando <strong>se invoca</strong> a un método
sobre un objeto?</p></li>
<li><p>No es lo mismo hacer:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dep.retirar</span></code></pre></div>
<p>que hacer:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dep.retirar()</span></code></pre></div>
<p>ya que en el primer caso obtenemos el valor del atributo (que es un
método), pero en el segundo caso estamos <em>invocando</em> al método
sobre el objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.2">

<ul>
<li><p>Supongamos que <em>o</em> es una instancia de la clase
<em>C</em>, que <em>m</em> es un método almacenado como un atributo de
la clase <em>C</em> y que <em>o</em> no contiene ningún atributo que se
llame <em>m</em>.</p></li>
<li><p>La ejecución del <strong><em>método</em></strong> <em>m</em> con
argumentos <span class="math inline">a_1, a_2, \ldots, a_n</span> sobre
el objeto <em>o</em> tiene esta forma:</p>
<div class="centered">
<p><em>o</em><code>.</code><em>m</em><code>(</code><span
class="math inline">a_1</span><code>,</code><span
class="math inline">a_2</span><code>,</code><span
class="math inline">\ldots</span><code>,</code><span
class="math inline">a_n</span><code>)</code></p>
</div></li>
<li><p>Pues bien: el intérprete de Python lo traduce por una llamada a
función con esta forma:</p>
<div class="centered">
<p><em>C</em><code>.</code><em>m</em><code>(</code><em>o</em><code>,</code><span
class="math inline">a_1</span><code>,</code><span
class="math inline">a_2</span><code>,</code><span
class="math inline">\ldots</span><code>,</code><span
class="math inline">a_n</span><code>)</code></p>
</div></li>
<li><p>Es decir: el intérprete llama a la
<strong><em>función</em></strong> <em>m</em> definida en la clase
<em>C</em> y le pasa automática e implícitamente el objeto <em>o</em>
como primer argumento (el resto de los argumentos originales irían a
continuación de <em>o</em>).</p></li>
<li><p>Esto nos vuelve a demostrar que los métodos no son más que una
forma especial de función.</p></li>
<li><p>No olvidemos que quien almacena los métodos es la clase, no el
objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.3">

<ul>
<li><p>Por ejemplo, hacer:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">25</span>)</span></code></pre></div>
<p>equivale a hacer:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.retirar(dep, <span class="dv">25</span>)</span></code></pre></div>
<p>De hecho, el intérprete traduce el primer código al segundo
automáticamente.</p></li>
<li><p>Esto facilita la implementación del intérprete, ya que todo se
convierte en llamadas a funciones.</p></li>
<li><p>Para la clase <code>Deposito</code>, <code>retirar</code> es una
función, mientras que, para el objeto <code>dep</code>,
<code>retirar</code> es un método.</p></li>
<li><p>Aunque son la misma cosa, el intérprete los trata de forma
distinta según el contexto.</p></li>
</ul>
</section>

<section id="definición-de-métodos" class="title-slide slide level2"
data-number="3.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span>
Definición de métodos</h2>
<ul>
<li><p>Esa es la razón por la que los métodos se definen siempre con un
parámetro extra que representa el objeto sobre el que se invoca el
método (o, dicho de otra forma, el objeto que recibe el
mensaje).</p></li>
<li><p>Ese parámetro extra (por regla de estilo) se llama siempre <code
class="sourceCode python"><span class="va">self</span></code>, si bien
ese nombre no es ninguna palabra clave y se podría usar cualquier
otro.</p></li>
<li><p>Por tanto, siempre que definamos un método, lo haremos como una
función que tendrá siempre un parámetro extra que será siempre el
primero de sus parámetros y que se llamará <code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.3.0.0.1">

<ul>
<li>Por ejemplo, en la clase <code>Deposito</code>, obsérvese que todos
los métodos tienen <code
class="sourceCode python"><span class="va">self</span></code> como
primer parámetro:</li>
</ul>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</section>
<section class="slide level5" data-number="3.3.0.0.2">

<ul>
<li><p>El método <code>saldo</code> de la clase <code>Deposito</code>
recibe un argumento <code
class="sourceCode python"><span class="va">self</span></code> que,
durante la llamada al método, contendrá el objeto sobre el que se ha
invocado dicho método:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div></li>
<li><p>En este caso, contendrá el objeto del que se desea conocer los
fondos que posee.</p></li>
<li><p>Por tanto, dentro de <code>saldo</code>, accedemos a los fondos
del objeto usando la expresión <code
class="sourceCode python"><span class="va">self</span>.fondos</code>, y
ese es el valor que retorna el método.</p></li>
<li><p>Dentro del programa, la expresión <code>dep.saldo()</code> se
traducirá como <code>Deposito.saldo(dep)</code>.</p></li>
<li><p>Es importante recordar que <strong>el parámetro <code
class="sourceCode python"><span class="va">self</span></code> se pasa
automáticamente</strong> durante la llamada al método y, por tanto,
<strong>no debemos pasarlo nosotros</strong> o se producirá un error por
intentar pasar más parámetros de los requeridos por el método.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.3.0.0.3">

<ul>
<li><p>El método <code>ingresar</code> tiene otro argumento además del
<code class="sourceCode python"><span class="va">self</span></code>, que
es la cantidad a ingresar:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div></li>
<li><p>En este caso, <code
class="sourceCode python"><span class="va">self</span></code> contendrá
el objeto en el que se desea ingresar la cantidad deseada.</p></li>
<li><p>Dentro del método <code>ingresar</code>, la expresión <code
class="sourceCode python"><span class="va">self</span>.fondos</code>
representa el valor del atributo <code>fondos</code> del objeto <code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
<li><p>Por tanto, lo que hace el método es incrementar el valor de dicho
atributo en el objeto <code
class="sourceCode python"><span class="va">self</span></code>, sumándole
la cantidad indicada en el parámetro.</p></li>
<li><p>Por ejemplo, la expresión <code
class="sourceCode python">dep.ingresar(<span class="dv">35</span>)</code>
se traducirá como <code
class="sourceCode python">Deposito.ingresar(dep, <span class="dv">35</span>)</code>.
Por tanto, en la llamada al método, <code
class="sourceCode python"><span class="va">self</span></code> valdrá
<code>dep</code> y <code>cantidad</code> valdrá <code
class="sourceCode python"><span class="dv">35</span></code>.</p></li>
</ul>
</section>
<section id="entorno-durante-la-ejecución-de-métodos"
class="title-slide slide level3" data-number="3.3.1">
<h3 data-number="3.3.1"><span class="header-section-number">3.3.1</span>
Entorno durante la ejecución de métodos</h3>
<ul>
<li><p>Durante la ejecución de un método en Python, el entorno no
contiene ni la clase a la que pertenece el método ni el objeto sobre el
que se invoca.</p></li>
<li><p>Es decir: los métodos no pueden considerarse clausuras, ya que no
recuerdan el contexto en el que se definieron.</p></li>
<li><p>Por tanto, si un método quiere acceder a un miembro de cualquier
clase (incluso de su misma clase), tendrá que hacerlo siempre a través
de una referencia (con el operador <code>.</code>), nunca
directamente.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.3.1.0.1">

<ul>
<li>Por tanto, un método puede llamar a otro, pero <strong>siempre a
través de la referencia al objeto que recibe el mensaje</strong>,
incluso aunque los dos métodos pertenezcan a la misma clase.</li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo, esto funcionará:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> A:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>...    <span class="kw">def</span> uno(<span class="va">self</span>):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>...        <span class="bu">print</span>(<span class="st">&#39;Estoy en uno&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>...        <span class="va">self</span>.dos()</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>...    <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>...        <span class="bu">print</span>(<span class="st">&#39;Estoy en dos&#39;</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> a <span class="op">=</span> A()</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> a.uno()</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>Estoy en uno</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>Estoy en dos</span></code></pre></div></li>
</ul>
</div><div class="column">
<ul>
<li><p>Pero esto <strong>NO</strong> funcionará:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> A:</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>...    <span class="kw">def</span> uno(<span class="va">self</span>):</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>...        <span class="bu">print</span>(<span class="st">&#39;Estoy en uno&#39;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>...        dos()  <span class="co"># Esto falla</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>...    <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>...        <span class="bu">print</span>(<span class="st">&#39;Estoy en dos&#39;</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> a <span class="op">=</span> A()</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> a.uno()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>Estoy en uno</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="pp">NameError</span>: name <span class="st">&#39;dos&#39;</span> <span class="kw">is</span> <span class="kw">not</span> defined</span></code></pre></div></li>
</ul>
</div>
</div>
<ul>
<li>El método <code>dos</code> no está en el entorno del método
<code>uno</code>, así que no lo puede llamar directamente.</li>
</ul>
</section>
<section class="slide level5" data-number="3.3.1.0.2">

<ul>
<li>Por ejemplo: en el siguiente código, al invocar al método
<code>uno</code> sobre el objeto <code>a</code> de la clase
<code>A</code>, se tienen los siguientes entornos antes y durante la
invocación del método:</li>
</ul>
<div class="columns">
<div class="column" style="width:35%;">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> uno(<span class="va">self</span>):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;Soy uno&#39;</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> A()</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>a.uno()</span></code></pre></div>
</div><div class="column" style="width:65%;">
<div class="centered">
<figure>
<img data-src="images/entorno-antes-uno.svg" class="plain"
style="width:100.0%" alt="Entorno antes de la invocación de uno" />
<figcaption aria-hidden="true">Entorno antes de la invocación de
<code>uno</code></figcaption>
</figure>
</div>
<div class="centered">
<figure>
<img data-src="images/entorno-durante-uno.svg" class="plain"
style="width:100.0%" alt="Entorno durante la invocación de uno" />
<figcaption aria-hidden="true">Entorno durante la invocación de
<code>uno</code></figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<ul>
<li>El entorno del método no incluye a la propia clase <code>A</code> ni
al objeto sobre el que se invoca el método.</li>
</ul>
</section>
<section class="slide level5" data-number="3.3.1.0.3">

<ul>
<li><p>Como otro ejemplo, si recordamos la clase
<code>Deposito</code>:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb36-3"><a href="#cb36-3"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb36-6"><a href="#cb36-6"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb36-7"><a href="#cb36-7"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb36-9"><a href="#cb36-9"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb36-10"><a href="#cb36-10"></a></span>
<span id="cb36-11"><a href="#cb36-11"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb36-12"><a href="#cb36-12"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb36-13"><a href="#cb36-13"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb36-14"><a href="#cb36-14"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb36-16"><a href="#cb36-16"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb36-17"><a href="#cb36-17"></a></span>
<span id="cb36-18"><a href="#cb36-18"></a>dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb36-19"><a href="#cb36-19"></a>dep.ingresar(<span class="dv">200</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.3.1.0.4">

<ul>
<li><p>Durante la ejecución del método <code>ingresar</code> (digamos,
en la línea 12 del código anterior), la situación en la memoria
sería:</p>
<div class="centered">
<p><img data-src="images/entorno-clase-linea12.svg" class="plain"
style="width:85.0%" /></p>
</div></li>
<li><p>Y, por tanto, el entorno estaría formado por el marco de
<code>ingresar</code> y el marco global, en ese orden.</p></li>
<li><p>En consecuencia, ni la clase <code>Deposito</code> ni el objeto
sobre el que se invoca el método (<code>dep</code> o <code>self</code>,
que son el mismo) están en el entorno del método
<code>ingresar</code>.</p></li>
</ul>
</section>


<section id="métodos-mágicos-y-constructores"
class="title-slide slide level2" data-number="3.4">
<h2 data-number="3.4"><span class="header-section-number">3.4</span>
Métodos <em>mágicos</em>  y constructores</h2>
<ul>
<li><p>En Python, los métodos cuyo nombre empieza y termina por
<code>__</code> se denominan <strong>métodos mágicos</strong> y tienen
un comportamiento especial.</p></li>
<li><p>En concreto, el método <code
class="sourceCode python"><span class="fu">__init__</span></code> se
invoca automáticamente cada vez que se instancia un nuevo objeto a
partir de una clase.</p></li>
<li><p>Coloquialmente, se le suele llamar el
<strong>constructor</strong> de la clase, y es el responsable de
<em>inicializar</em> el objeto de forma que tenga un estado inicial
adecuado desde el momento de su creación.</p></li>
<li><p>Entre otras cosas, el constructor se encarga de asignarle los
valores iniciales adecuados a los atributos del objeto.</p></li>
<li><p>Ese método recibe como argumentos (además del <code
class="sourceCode python"><span class="va">self</span></code>) los
argumentos indicados en la llamada a la clase que se usó para instanciar
el objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.1">

<ul>
<li><p>Por ejemplo: en la clase <code>Deposito</code>, tenemos:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span></code></pre></div></li>
<li><p>Ese método <code
class="sourceCode python"><span class="fu">__init__</span></code> se
encarga de crear el atributo <code>fondos</code> del objeto que se acaba
de crear (y que recibe a través del parámetro <code>self</code>),
asignándole el valor del parámetro <code>fondos</code>.</p>
<p>¡Cuidado! No confudir la expresión <code
class="sourceCode python"><span class="va">self</span>.fondos</code> con
<code>fondos</code>. La primera se refiere al atributo
<code>fondos</code> del objeto <code
class="sourceCode python"><span class="va">self</span></code>, mientras
que la segunda se refiere al parámetro <code>fondos</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.2">

<ul>
<li><p>Cuando se crea un nuevo objeto de la clase <code>Deposito</code>,
llamando a la clase como si fuera una función, se debe indicar entre
paréntesis (como argumento) el valor del parámetro que luego va a
recibir el método <code
class="sourceCode python"><span class="fu">__init__</span></code> (en
este caso, los fondos iniciales):</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div></li>
<li><p>La ejecución de este código produce el siguiente efecto:</p>
<ol type="1">
<li><p>Se crea en memoria una instancia de la clase
<code>Deposito</code>.</p></li>
<li><p>Se invoca el método <code
class="sourceCode python"><span class="fu">__init__</span></code> sobre
el objeto recién creado, de forma que el parámetro <code
class="sourceCode python"><span class="va">self</span></code> recibe una
referencia a dicho objeto y el parámetro <code>fondos</code> toma el
valor <code
class="sourceCode python"><span class="dv">100</span></code>, que es el
valor del argumento en la llamada a <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>.</p>
<p>En la práctica, esto equivale a decir que la expresión <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>
se traduce a <em>ref</em><code
class="sourceCode python">.<span class="fu">__init__</span>(<span class="dv">100</span>)</code>,
donde <em>ref</em> es una referencia al objeto recién creado.</p></li>
<li><p>La expresión <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>
devuelve la referencia al objeto.</p></li>
<li><p>Esa referencia es la que se almacena en la variable
<code>dep</code>.</p></li>
</ol></li>
</ul>
</section>
<section id="ejercicio-1" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="2" class="example" type="1">
<li>Comprobar el funcionamiento del constructor en <a
href="http://pythontutor.com/visualize.html#code=class%20Deposito%3A%0A%20%20%20%20def%20__init__%28self,%20fondos%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%3D%20fondos%0A%0A%20%20%20%20def%20retirar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20if%20cantidad%20%3E%20self.fondos%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20&#39;Fondos%20insuficientes&#39;%0A%20%20%20%20%20%20%20%20self.fondos%20-%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20ingresar%28self,%20cantidad%29%3A%0A%20%20%20%20%20%20%20%20self.fondos%20%2B%3D%20cantidad%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%0A%20%20%20%20def%20saldo%28self%29%3A%0A%20%20%20%20%20%20%20%20return%20self.fondos%0A%20%20%20%20%20%20%20%20%0Adep1%20%3D%20Deposito%28100%29&amp;cumulative=true&amp;curInstr=0&amp;heapPrimitives=nevernest&amp;mode=display&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false"
target="_blank">Pythontutor</a>.</li>
</ol>
</section>
<section class="slide level5" data-number="3.4.0.0.3">

<ul>
<li><p>En resumen: la expresión <em>C</em><code>(</code><span
class="math inline">a_1</span><code>,</code><span
class="math inline">a_2</span><code>,</code><span
class="math inline">\ldots</span><code>,</code><span
class="math inline">a_n</span><code>)</code> usada para crear una
instancia de la clase <em>C</em> lleva a cabo las siguientes
acciones:</p>
<ol type="1">
<li><p>Crea en memoria una instancia de la clase <em>C</em> y guarda en
una variable temporal (llamémosla <em>ref</em>, por ejemplo) una
referencia al objeto recién creado.</p></li>
<li><p>Invoca a <em>ref</em><code>.__init__(</code><span
class="math inline">a_1</span><code>,</code><span
class="math inline">a_2</span><code>,</code><span
class="math inline">\ldots</span><code>,</code><span
class="math inline">a_n</span><code>)</code></p></li>
<li><p>Devuelve <em>ref</em>.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.4">

<ul>
<li><p>En consecuencia, los argumentos que se indican al instanciar una
clase se enviarán al método <code
class="sourceCode python"><span class="fu">__init__</span></code> de la
clase, lo que significa que tendremos que indicar tantos argumentos (y
del tipo apropiado) como espere el método <code
class="sourceCode python"><span class="fu">__init__</span></code>.</p>
<p>En caso contrario, tendremos un error:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito()  <span class="co"># no indicamos ningún argumento cuando se espera uno</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: <span class="fu">__init__</span>() missing <span class="dv">1</span> required positional argument: <span class="st">&#39;fondos&#39;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">1</span>, <span class="dv">2</span>)  <span class="co"># mandamos dos argumentos cuando se espera sólo uno</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: <span class="fu">__init__</span>() takes <span class="dv">2</span> positional arguments but <span class="dv">3</span> were given</span></code></pre></div></li>
<li><p>Es importante tener en cuenta, además, que <strong>el constructor
<code class="sourceCode python"><span class="fu">__init__</span></code>
no debe devolver ningún valor</strong> (o, lo que es lo mismo, debe
devolver <code
class="sourceCode python"><span class="va">None</span></code>), o de lo
contrario provocará un error de ejecución.</p></li>
</ul>
</section>
</section>
<section>
<section id="identidad-e-igualdad" class="title-slide slide level1"
data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span>
Identidad e igualdad</h1>

</section>
<section id="identidad" class="title-slide slide level2"
data-number="4.1">
<h2 data-number="4.1"><span class="header-section-number">4.1</span>
Identidad</h2>
<ul>
<li><p>Ya hemos dicho que los objetos tienen existencia propia e
independiente.</p></li>
<li><p>La <strong>identidad</strong> describe la propiedad que tienen
los objetos de distinguirse de los demás objetos.</p>
<div class="caja">
<p>Dos objetos del mismo tipo son <strong>idénticos</strong> si un
cambio en cualquiera de los dos objetos provoca también el mismo cambio
en el otro objeto.</p>
</div></li>
<li><p>Dicho de otra forma: dos objetos son idénticos si son
intercambiables en el código fuente del programa sin que se vea afectado
el comportamiento del mismo.</p></li>
<li><p>Es evidente que dos objetos de distinto tipo no pueden ser
idénticos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.1">

<ul>
<li><p>Cuando introducimos mutabilidad y estado en nuestro modelo
computacional, muchos conceptos que antes eran sencillos se vuelven
problemáticos.</p></li>
<li><p>Entre ellos, el problema de determinar si dos cosas son «la misma
cosa», es decir, si son <em>idénticos</em>.</p></li>
<li><p>Por ejemplo, supongamos que hacemos:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> restador(cantidad):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> aux(otro):</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> otro <span class="op">-</span> cantidad</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aux</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>res1 <span class="op">=</span> restador(<span class="dv">25</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>res2 <span class="op">=</span> restador(<span class="dv">25</span>)</span></code></pre></div></li>
<li><p>¿Son <code>res1</code> y <code>res2</code> la misma cosa?</p>
<ul>
<li><p>Es razonable decir que sí, ya que tanto <code>res1</code> como
<code>res2</code> se comportan siempre de la misma forma (las dos son
funciones que restan <code
class="sourceCode python"><span class="dv">25</span></code> a su
argumento).</p></li>
<li><p>De hecho, <code>res1</code> puede sustituirse por
<code>res2</code> (y viceversa) en cualquier lugar del programa sin que
afecte a su funcionamiento.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.2">

<ul>
<li><p>En cambio, supongamos que hacemos dos llamadas a <code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>dep2 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div></li>
<li><p>¿Son <code>dep1</code> y <code>dep2</code> la misma cosa?</p>
<ul>
<li><p>Evidentemente no, ya que podemos obtener resultados distintos al
enviarles el mismo mensaje (uno que sabemos que no cambia el estado del
objeto):</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.retirar(<span class="dv">20</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="dv">80</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1.saldo()  <span class="co"># Mensaje que no cambia el estado del objeto</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="dv">80</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2.saldo()  <span class="co"># El mismo mensaje, da un resultado distinto en dep2</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code></pre></div></li>
<li><p>Incluso aunque podamos pensar que <code>dep1</code> y
<code>dep2</code> son «iguales» en el sentido de que ambos han sido
creados evaluando la misma expresión (<code
class="sourceCode python">Deposito(<span class="dv">100</span>)</code>),
no es verdad que podamos sustituir <code>dep1</code> por
<code>dep2</code> (o viceversa) en cualquier parte del programa sin
afectar a su funcionamiento.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.3">

<ul>
<li><p>Es otra forma de decir que <strong>los objetos no tienen
transparencia referencial</strong>, ya que se pierde en el momento en
que incorporamos <strong>estado y mutabilidad</strong> en nuestro modelo
computacional.</p></li>
<li><p>Pero al perder la transparencia referencial, se vuelve más
difícil de definir de una manera formal y rigurosa qué es lo que
significa que dos objetos sean «el mismo objeto».</p></li>
<li><p>De hecho, el significado de «el mismo» en el mundo real que
estamos modelando con nuestro programa es ya bastante difícil de
entender.</p></li>
<li><p>En general, sólo podemos determinar si dos objetos aparentemente
idénticos son realmente «el mismo objeto» modificando uno de ellos y
observando a continuación si el otro ha cambiado de la misma
forma.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.4">

<ul>
<li><p>Pero la única manera de saber si un objeto ha «cambiado» es
observando el «mismo» objeto dos veces, en dos momentos diferentes, y
comprobando si ha cambiado alguna propiedad del objeto de la primera
observación a la segunda.</p></li>
<li><p>Por tanto, no podemos determinar si ha habido un «cambio» si no
podemos determinar, a priori, si dos objetos son «el mismo», y no
podemos determinar si son el mismo si no podemos observar los efectos de
ese cambio.</p></li>
<li><p>Esto nos lleva a una definición circular, donde un término
depende del otro y viceversa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.5">

<ul>
<li><p>Por ejemplo, supongamos que Pedro y Pablo tienen un depósito con
100 € cada uno.</p></li>
<li><p>Si los creamos así:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dep_Pedro <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>dep_Pablo <span class="op">=</span> Deposito(<span class="dv">100</span>)</span></code></pre></div>
<p>los dos depósitos son distintos.</p>
<ul>
<li>Por tanto, las operaciones realizadas en el depósito de Pedro no
afectarán al de Pablo, y viceversa.</li>
</ul></li>
<li><p>En cambio, si los creamos así:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dep_Pedro <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>dep_Pablo <span class="op">=</span> dep_Pedro</span></code></pre></div>
<p>estamos definiendo a <code>dep_Pablo</code> para que sea exactamente
la misma cosa que <code>dep_Pedro</code>.</p>
<ul>
<li>Por tanto, ahora Pedro y Pablo son cotitulares de un mismo depósito
compartido, y si Pedro hace una retirada de efectivo a través de
<code>dep_Pedro</code>, Pablo observará que hay menos dinero en
<code>dep_Pablo</code> (porque son <em>el mismo</em> depósito).</li>
</ul></li>
</ul>
<!--

- Hay una enorme diferencia entre crearlos así:

  ```python
  dep_Pedro = Deposito(100)
  dep_Pablo = Deposito(100)
  ```

  y crearlos así:

  ```python
  dep_Pedro = Deposito(100)
  dep_Pablo = dep_Pedro
  ```

- En el primer caso, los dos depósitos son distintos.

  - Por tanto, las operaciones
    realizadas en el depósito de Pedro no afectarán al de Pablo, y viceversa.
  
- En el segundo caso, en cambio, hemos definido a `dep_Pablo` para que sea
  exactamente la misma cosa que `dep_Pedro`.
  
  - Por tanto, ahora Pedro y Pablo son cotitulares de un mismo depósito
    compartido, y si Pedro hace una retirada de efectivo a través de `dep_Pedro`,
    Pablo observará que hay menos dinero en `dep_Pablo` (porque son _el mismo_
    depósito).

-->
</section>
<section class="slide level5" data-number="4.1.0.0.6">

<ul>
<li><p>Estas dos situaciones, similares pero distintas, pueden provocar
confusión al crear modelos computacionales.</p></li>
<li><p>En concreto, con el depósito compartido puede ser especialmente
confuso el hecho de que haya un objeto (el depósito) con dos nombres
distintos (<code>dep_Pedro</code> y <code>dep_Pablo</code>).</p>
<ul>
<li>Si estamos buscando todos los sitios de nuestro programa donde pueda
cambiarse el depósito de <code>dep_Pedro</code>, tendremos que recordar
buscar también los sitios donde se cambie a <code>dep_Pablo</code>.</li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.7">

<ul>
<li><p>Los problemas de identidad sólo se da cuando permitimos que los
objetos sean mutables.</p></li>
<li><p>Si Pedro y Pablo sólo pudieran comprobar los saldos de sus
depósitos y no pudieran realizar operaciones que cambiaran sus fondos,
entonces no haría falta comprobar si los dos depósitos son distintos o
si por el contrario son realmente el mismo depósito. Daría
igual.</p></li>
<li><p>En general, siempre que no se puedan modificar los objetos,
podemos suponer que un objeto compuesto se define como la suma de sus
partes.</p></li>
<li><p>Pero esto deja de ser válido cuando incorporamos mutabilidad,
porque entonces un objeto compuesto tiene una «identidad» que es algo
diferente de las partes que lo componen.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.8">

<ul>
<li><p>Por ejemplo, un número racional viene definido por su numerador y
su denominador.</p>
<p>El número racional <span class="math inline">\frac{4}{3}</span> está
completamente determinado por su numerador 4 y su denominador 3. Es eso
y nada más.</p></li>
<li><p>Pero no tiene sentido considerar que un número racional es un
objeto mutable con identidad propia, puesto que si pudiéramos cambiar su
numerador o su denominador ya no tendríamos «el mismo» número racional,
sino que tendríamos otro diferente.</p>
<p>Si al racional <span class="math inline">\frac{4}{3}</span> le
cambiamos el numerador 4 por 5, obtendríamos el nuevo racional <span
class="math inline">\frac{5}{3}</span>, y no tendría sentido decir que
ese nuevo racional es el antiguo racional <span
class="math inline">\frac{4}{3}</span> modificado. Éste ya no
está.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.9">

<ul>
<li><p>En cambio, un depósito sigue siendo «el mismo» depósito aunque
cambiemos sus fondos haciendo una retirada de efectivo.</p></li>
<li><p>Pero también podemos tener dos depósitos distintos con el mismo
estado interno.</p></li>
<li><p>Esta complicación es consecuencia, no de nuestro lenguaje de
programación, sino de nuestra percepción del depósito bancario como un
objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.10">

<ul>
<li><p>Como usamos <strong>referencias</strong> para referirnos a un
determinado objeto y acceder al mismo, resulta fácil comprobar si dos
objetos son <em>idénticos</em> (es decir, si son el mismo objeto)
simplemente comparando referencias. <strong>Si las referencias son
iguales, es que estamos ante un único objeto.</strong></p></li>
<li><p>Esto es así ya que, por lo general, las referencias se
corresponden con direcciones de memoria. Es decir: una referencia a un
objeto normalmente representa la dirección de memoria donde se empieza a
almacenar dicho objeto.</p></li>
<li><p>Dos objetos pueden ser <strong>iguales</strong> y, en cambio, no
ser <em>idénticos</em>.</p></li>
<li><p>Resumiendo:</p>
<ul>
<li><p>Cuando preguntamos si dos objetos son <strong>iguales</strong>,
estamos preguntando si tienen el <strong>mismo
contenido</strong>.</p></li>
<li><p>Cuando preguntamos si son <strong>idénticos</strong>, estamos
preguntando si son el <strong>mismo objeto</strong>.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.11">

<ul>
<li><p>La forma de comprobar en Python si dos objetos son
<em>idénticos</em> es usar el operador <code>is</code> que ya
conocemos:</p>
<div class="caja">
<p>La expresión <strong><em>o</em> <code>is</code> <em>p</em></strong>
devolverá <code>True</code> si tanto <strong><em>o</em></strong> como
<strong><em>p</em></strong> son referencias al mismo objeto.</p>
</div></li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> dep1</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="kw">is</span> dep2</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
</ul>
</div><div class="column">
<ul>
<li><p>En cambio:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep2 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep1 <span class="kw">is</span> dep2</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
</ul>
</div>
</div>
<ul>
<li><p>Como ya estudiamos en su día, la expresión <strong><em>o</em>
<code>is</code> <em>p</em></strong> equivale a
<strong><code>id(</code><em>o</em><code>) == id(</code><em>p</em><code>)</code></strong>.</p></li>
<li><p>Por tanto, lo que hace es comparar el resultado de la función
<code>id</code>, que devuelve un identificador único (un número) para
cada objeto.</p></li>
<li><p>Ese identificador es la dirección de memoria donde se almacena el
objeto. Por tanto, es la dirección a donde apuntan sus
referencias.</p></li>
</ul>
</section>

<section id="igualdad" class="title-slide slide level2"
data-number="4.2">
<h2 data-number="4.2"><span class="header-section-number">4.2</span>
Igualdad</h2>
<ul>
<li><p>Supongamos que queremos modelar el funcionamiento de una cola
(una estructura de datos en la que los elementos entran por un lado y
salen por el contrario en el orden en que se han introducido).</p></li>
<li><p>El código podría ser el siguiente, utilizando una lista para
almacenar los elementos:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Cola:</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, els):</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.items <span class="op">=</span> els</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meter(<span class="va">self</span>, el):</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.items.append(el)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sacar(<span class="va">self</span>):</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.items) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Cola vacía&quot;</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> <span class="va">self</span>.items[<span class="dv">0</span>]</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> elementos(<span class="va">self</span>):</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.items</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.0.0.1">

<ul>
<li><p>Si hacemos:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cola1 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>cola2 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div>
<p>es evidente que <code>cola1</code> y <code>cola2</code> hacen
referencia a objetos separados y, por tanto, <strong>no son
<em>idénticos</em></strong>, ya que no se refieren <em>al mismo</em>
objeto.</p></li>
<li><p>En cambio, sí podemos decir que <strong>son
<em>iguales</em></strong> ya que pertenecen a la misma clase, poseen el
mismo estado interno (el mismo contenido) y se comportan de la misma
forma al recibir la misma secuencia de mensajes en el mismo orden:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2 <span class="op">=</span> Cola([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.meter(<span class="dv">9</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.elementos()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.sacar()</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.elementos()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.meter(<span class="dv">9</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.elementos()</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.sacar()</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.elementos()</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.0.0.2">

<ul>
<li><p>Sin embargo, si preguntamos al intérprete si son iguales, nos
dice que no:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
<li><p>Esto se debe a que, en ausencia de otra definición de
<em>igualdad</em> y <strong>mientras no se diga lo contrario, dos
objetos de clases <em>definidas por el programador</em> son iguales sólo
si son idénticos</strong>.</p></li>
<li><p>Es decir: por defecto, <strong><em>x</em></strong>
<code>==</code> <strong><em>y</em></strong> sólo si
<strong><em>x</em></strong> <code>is</code>
<strong><em>y</em></strong>.</p></li>
<li><p>Para cambiar ese comportamiento predeterminado, tendremos que
definir qué significa que dos instancias de nuestra clase son
iguales.</p></li>
<li><p>Por ejemplo: ¿cuándo podemos decir que dos objetos de la clase
<code>Cola</code> son iguales?</p>
<p>Podemos decir que dos colas son iguales cuando tienen el mismo estado
interno. En este caso: <em>dos colas son iguales cuando tienen los
mismos elementos en el mismo orden</em>.</p></li>
</ul>
</section>
<section id="eq__" class="title-slide slide level3" data-number="4.2.1">
<h3 data-number="4.2.1"><span class="header-section-number">4.2.1</span>
<code>__eq__</code></h3>
<ul>
<li><p>Para implementar nuestra propia lógica de igualdad en nuestra
clase, debemos definir en ella el método mágico <code
class="sourceCode python"><span class="fu">__eq__</span></code>.</p></li>
<li><p>Este método se invoca automáticamente cuando se hace una
comparación con el operador <code>==</code> y el operando izquierdo es
una instancia de nuestra clase. El operando derecho se envía como
argumento en la llamada al método.</p></li>
<li><p>Dicho de otra forma:</p>
<ul>
<li><p>Si la clase de <code>cola1</code> tiene definido el método
<code>__eq__</code>, entonces <code>cola1 == cola2</code> equivale a
<code
class="sourceCode python">cola1.<span class="fu">__eq__</span>(cola2)</code>.</p></li>
<li><p>En caso contrario, <code>cola1 == cola2</code> seguirá valiendo
lo mismo que <code
class="sourceCode python">cola1 <span class="kw">is</span> cola2</code>,
como acabamos de ver.</p></li>
</ul></li>
<li><p>No es necesario definir el operador <code>!=</code>, ya que
Python 3 lo define automáticamente a partir del
<code>==</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.1.0.1">

<ul>
<li><p>Para crear una posible implementación del método <code
class="sourceCode python"><span class="fu">__eq__</span></code>, podemos
aprovecharnos del hecho de que dos listas son iguales cuando tienen
exactamente los mismos elementos en el mismo orden (justo lo que
necesitamos para nuestras colas):</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, otro):</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(<span class="va">self</span>) <span class="op">!=</span> <span class="bu">type</span>(otro):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">NotImplemented</span>   <span class="co"># no tiene sentido comparar objetos de distinto tipo</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.items <span class="op">==</span> otro.items  <span class="co"># son iguales si tienen los mismos elementos</span></span></code></pre></div>
<p>Se devuelve el valor especial <code
class="sourceCode python"><span class="va">NotImplemented</span></code>
cuando no tiene sentido comparar un objeto de la clase <code>Cola</code>
con un objeto de otro tipo.</p></li>
<li><p>Si introducimos este método dentro de la definición de la clase
<code>Cola</code>, tendremos el resultado deseado:</p></li>
</ul>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">=</span> Cola([<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">7</span>])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2 <span class="op">=</span> Cola([<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">7</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="kw">is</span> cola2</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div>
</div><div class="column">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1.sacar()</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola2.sacar()</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cola1 <span class="op">==</span> cola2</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div>
</div>
</div>
</section>

<section id="hash__" class="title-slide slide level3"
data-number="4.2.2">
<h3 data-number="4.2.2"><span class="header-section-number">4.2.2</span>
<code>__hash__</code></h3>
<ul>
<li><p>Recordatorio:</p>
<ul>
<li><p>Existen datos <em>hashables</em> y datos <em>no
hashables</em>.</p></li>
<li><p>Los datos <em>hashables</em> son aquellos que se pueden comparar
entre sí con <code>==</code> y además llevan asociado un número entero
llamado <em>hash</em>.</p></li>
<li><p>Los datos <em>hashables</em> pueden guardarse en un conjunto o
usarse como claves de un diccionario.</p></li>
<li><p>Los datos mutables no pueden ser <em>hashables</em>.</p></li>
<li><p>Si <span class="math inline">x</span> es <em>hashable</em>, <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> debe devolver un número que
nunca cambie durante la vida de <span
class="math inline">x</span>.</p></li>
<li><p>Si <span class="math inline">x</span> no es <em>hashable</em>,
<code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> lanza una excepción <code
class="sourceCode python"><span class="pp">TypeError</span></code>.</p></li>
</ul></li>
<li><p>Lo que hace la función <code
class="sourceCode python"><span class="bu">hash</span></code> es llamar
al método <code
class="sourceCode python"><span class="fu">__hash__</span></code> de su
argumento.</p></li>
<li><p>Por tanto, la llamada a <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> es equivalente a hacer <span
class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.1">

<ul>
<li><p>Los métodos <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> están
relacionados entre sí, porque siempre se tiene que cumplir la siguiente
condición:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> debe ser igual que <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Por tanto, siempre se tiene que cumplir que:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <span
class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
<code>==</code> <span class="math inline">y</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>.</p>
</div></li>
<li><p>Lo que equivale también a decir que:</p>
<div class="caja centered">
<p>Si <span class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
<code>!=</code> <span class="math inline">y</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>,
entonces <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>.</p>
</div></li>
<li><p>Para ello, debemos tener en cuenta varias consideraciones a la
hora de crear nuestras clases:</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.2">

<ol type="1">
<li><p>Si una clase define su propio método <code
class="sourceCode python"><span class="fu">__hash__</span></code>, debe
definir también un <code
class="sourceCode python"><span class="fu">__eq__</span></code> que vaya
a juego con el <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p>
<p>Por tanto (<em>contrarrecíproco</em> del anterior), si una clase no
define su propio método <code
class="sourceCode python"><span class="fu">__eq__</span></code>, tampoco
debe definir su propio método <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p></li>
<li><p>Las clases definidas por el programador ya traen de serie una
implementación predefinida de <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> que
cumplen que:</p>
<ul>
<li><p><span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span> sólo si <span class="math inline">x</span>
<code class="sourceCode python"><span class="kw">is</span></code> <span
class="math inline">y</span>, como ya vimos antes.</p></li>
<li><p><span class="math inline">x</span><code
class="sourceCode python">.<span class="fu">__hash__</span>()</code>
devuelve un valor que garantiza que si <span
class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p></li>
</ul>
<p>(Esto se debe a que la clase <em>hereda</em> los métodos <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code> de la
clase <code
class="sourceCode python"><span class="bu">object</span></code>, como
veremos en la siguiente unidad.)</p></li>
</ol>
</section>
<section class="slide level5" data-number="4.2.2.0.3">

<ol start="3" type="1">
<li><p>Si una clase no define <code
class="sourceCode python"><span class="fu">__eq__</span></code> pero no
se desea que sus instancias sean <em>hashables</em>, debe definir su
método <code
class="sourceCode python"><span class="fu">__hash__</span></code> como
<code class="sourceCode python"><span class="va">None</span></code>
incluyendo la sentencia:</p>
<div class="centered">
<p><code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code></p>
</div>
<p>en la definición de la clase.</p></li>
<li><p>Si una clase define <code
class="sourceCode python"><span class="fu">__eq__</span></code> pero no
define <code
class="sourceCode python"><span class="fu">__hash__</span></code>, es
como si implícitamente hubiera definido <code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code> (lo hace
el intérprete internamente).</p>
<p>Por tanto, en ese caso sus instancias no serán
<em>hashables</em>.</p></li>
<li><p>Si las instancias de la clase son mutables y ésta define <code
class="sourceCode python"><span class="fu">__eq__</span></code>, lo
normal es que no defina <code
class="sourceCode python"><span class="fu">__hash__</span></code>, ya
que los objetos mutables no deberían ser <em>hashables</em>, en
general.</p>
<p>No obstante, hay casos particulares de objetos mutables que pueden
ser <em>hashables</em>, como veremos en breve.</p></li>
</ol>
</section>
<section class="slide level5" data-number="4.2.2.0.4">

<ul>
<li><p>Hemos dicho que la condición principal que se tiene que cumplir
es que:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Y, por tanto, se tiene que cuplir su contrarrecíproco, que
es:</p>
<div class="centered">
<p>Si <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>, entonces <span
class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>.</p>
</div></li>
<li><p>Lo cual NO significa que se tenga que cumplir que:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Sin embargo, aunque no sea necesario que se cumpla, a efectos
prácticos sí que resulta conveniente cumplir la condición anterior en la
medida de lo posible, ya que de esta forma ganaremos en eficiencia
cuando intentemos acceder a nuestros objetos de manera directa si los
almacenamos en una colección.</p></li>
<li><p>Por desgracia, resulta prácticamente imposible poder cumplir la
condición anterior para todos los objetos, pero aún así deberíamos
intentar que nuestro algoritmo de <em>hashing</em> cumpla dicha
condición con el mayor número de objetos posible.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.5">

<ul>
<li><p>Cuando esa condición no se cumple, tenemos lo que se llama una
<strong>colisión</strong>.</p></li>
<li><p>Es decir: tenemos una colisión cuando varios objetos distintos
tienen el mismo valor de <em>hash</em>.</p></li>
<li><p>En tal caso, tenemos que:</p>
<div class="centered">
<p><span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, pero <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>Como dijimos antes, las colisiones son prácticamente inevitables,
pero hay que procurar implementar nuestro <code
class="sourceCode python"><span class="fu">__hash__</span></code> de
forma que se produzcan lo menos posible, ya que mejora el
rendimiento.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.6">

<ul>
<li><p>Dicho de otra forma, nuestro <code
class="sourceCode python"><span class="fu">__hash__</span></code> debe
cumplir <strong>siempre</strong>:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>==</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>==</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code></p>
</div>
<p>pero, al mismo tiempo, debe procurar cumplir <strong>siempre que
pueda</strong>:</p>
<div class="centered">
<p>Si <span class="math inline">x</span> <code>!=</code> <span
class="math inline">y</span>, entonces <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">x</span><code>)</code> <code>!=</code> <code
class="sourceCode python"><span class="bu">hash</span></code><code>(</code><span
class="math inline">y</span><code>)</code>.</p>
</div></li>
<li><p>En realidad, una buena implementación de <code
class="sourceCode python"><span class="fu">__hash__</span></code> es
aquella que reparte uniformemente los objetos entre los posibles valores
de <em>hash</em>.</p></li>
<li><p>Es decir: la idea principal es que el método <code
class="sourceCode python"><span class="fu">__hash__</span></code> no
asocie muchos objetos a un mismo valor de <em>hash</em> y al mismo
tiempo haya otros valores de <em>hash</em> a los que se les asocien
pocos objetos (o ninguno).</p>
<p>Si muchos objetos tienen el mismo <em>hash</em>, ese reparto no sería
uniforme, sino que estaría muy descompensado, y provocaría un peor
rendimiento en los accesos a los objetos dentro de las
colecciones.</p></li>
<li><p>Por otra parte, el cálculo del <em>hash</em> no debería ser
costoso.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.7">

<ul>
<li><p>Una forma sencilla de crear el <code
class="sourceCode python"><span class="fu">__hash__</span></code> de una
clase sería usar el <code
class="sourceCode python"><span class="bu">hash</span></code> de una
tupla que contenga las variables de estado de la clase (siempre que
estas sean <em>hashables</em> también):</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">hash</span>((<span class="va">self</span>.nombre, <span class="va">self</span>.apellidos))</span></code></pre></div></li>
<li><p>Las colas son mutables y, por tanto, no pueden ser
<em>hashables</em>, así que no definiremos ningún método <code
class="sourceCode python"><span class="fu">__hash__</span></code> en la
clase <code>Cola</code>.</p></li>
<li><p>De esta forma, como sí hemos definido un método <code
class="sourceCode python"><span class="fu">__eq__</span></code> en la
clase, el intérprete automáticamente hará <code
class="sourceCode python"><span class="fu">__hash__</span></code>
<code>=</code> <code
class="sourceCode python"><span class="va">None</span></code> y
convertirá a las colas en <em>no hashables</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.8">

<ul>
<li><p>Es importante no romper el contrato entre <code
class="sourceCode python"><span class="fu">__eq__</span></code> y <code
class="sourceCode python"><span class="fu">__hash__</span></code>.</p></li>
<li><p>Es decir, hay que garantizar que si dos objetos son iguales, sus
<em>hash</em> también deben ser iguales.</p></li>
<li><p>De lo contrario, se pueden dar situaciones extrañas:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> random</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Rara:</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">return</span> random.randint(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> Rara()</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> s.add(x)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="kw">in</span> s</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="kw">in</span> s</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.2.0.9">

<ul>
<li><p>Aunque los objetos mutables no deberían ser <em>hashables</em>, a
veces es posible hacer que el valor de <em>hash</em> de un objeto
dependa de un subconjunto de atributos inmutables del objeto.</p></li>
<li><p>En ese caso, el objeto sería mutable pero podría ser
<em>hashable</em> al mismo tiempo.</p></li>
<li><p>Por ejemplo, si el DNI de una persona nunca cambia, podríamos
usarlo para calcular su <em>hash</em>:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dni, nombre):</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">hash</span>(<span class="va">self</span>.__dni)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span></code></pre></div></li>
</ul>
</section>


<section id="otros-métodos-mágicos" class="title-slide slide level2"
data-number="4.3">
<h2 data-number="4.3"><span class="header-section-number">4.3</span>
Otros métodos mágicos</h2>

</section>
<section id="repr__" class="title-slide slide level3"
data-number="4.3.1">
<h3 data-number="4.3.1"><span class="header-section-number">4.3.1</span>
<code>__repr__</code></h3>
<ul>
<li>Existe una función llamada <code
class="sourceCode python"><span class="bu">repr</span></code> que
devuelve la <strong>forma normal</strong> de una expresión, es decir, la
cadena de símbolos que mejor <strong>representa</strong> al valor de la
expresión.</li>
</ul>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;5&#39;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div>
</div><div class="column">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="fl">3.50</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;3.5&#39;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">3.5</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fl">3.5</span></span></code></pre></div>
</div>
</div>
<ul>
<li><p>La expresión que vaya en esa cadena debe ser sintáctica y
semánticamente <strong>correcta</strong> según las reglas del
lenguaje.</p></li>
<li><p>Además, esa expresión debe contener toda la información necesaria
para <strong>reconstruir el valor</strong>.</p></li>
<li><p>El intérprete interactivo de Python usa <code
class="sourceCode python"><span class="bu">repr</span></code> cuando le
pedimos que evalúe una expresión:</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span>  <span class="co"># devuelve lo mismo que repr(2 + 3) pero sin comillas</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.1">

<ul>
<li><p>Recordemos que no toda expresión tiene forma normal:</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="bu">max</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&lt;built-in function max&gt;&#39;</span></span></code></pre></div>
<p>En este caso, lo que nos devuelve <code
class="sourceCode python"><span class="bu">repr</span></code> no tiene
la información suficiente como para construir la función <code
class="sourceCode python"><span class="bu">max</span></code>.</p>
<p>De hecho, ni siquiera es una expresión válida en el lenguaje:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="op">&lt;</span>built<span class="op">-</span><span class="kw">in</span> function <span class="bu">max</span><span class="op">&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>built<span class="op">-</span><span class="kw">in</span> function <span class="bu">max</span><span class="op">&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">^</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.2">

<ul>
<li><p>Al aplicar la función <code
class="sourceCode python"><span class="bu">repr</span></code> sobre una
instancia de una clase definida por el programador, obtenemos una
representación que, en general, no es correcta ni contiene la
información suficiente como para representar al objeto o
reconstruirlo.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&lt;__main__.Deposito object at 0x7fed83fd9160&gt;&#39;</span></span></code></pre></div>
<p>Nos devuelve una cadena que que simplemente nos informa de:</p>
<ul>
<li><p>La clase a la que pertenece el objeto, que se obtiene mediante
<code
class="sourceCode python"><span class="bu">type</span>(dep)</code>.</p></li>
<li><p>El <code
class="sourceCode python"><span class="bu">id</span></code> del objeto
en hexadecimal, que se obtiene mediante <code
class="sourceCode python"><span class="bu">hex</span>(<span class="bu">id</span>(dep))</code>.</p></li>
</ul>
<p>Pero esa cadena no contiene ninguna expresión válida en Python y
tampoco nos dice cuántos fondos contiene el depósito, por ejemplo.</p>
<p>Por tanto, con esa cadena no podemos reconstruir el objeto
<code>dep</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.3">

<ul>
<li><p>En este caso, lo ideal sería que <code
class="sourceCode python"><span class="bu">repr</span>(dep)</code>
devolviera una expresión <strong>no ambigua</strong> con la que
pudiéramos <strong>reconstruir</strong> el objeto <code>dep</code> con
toda la información que contiene (su estado interno).</p></li>
<li><p>Es decir, buscamos algo así:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;Deposito(70)&#39;</span></span></code></pre></div></li>
<li><p>En este último caso, la cadena resultante contiene la expresión
<code
class="sourceCode python">Deposito(<span class="dv">70</span>)</code>,
que sí representa adecuadamente al objeto <code>dep</code>:</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">==</span> Deposito(<span class="dv">70</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
<li><p>Es importante no confundir la cadena <code
class="sourceCode python"><span class="st">&#39;Deposito(70)&#39;</span></code>
que devuelve <code
class="sourceCode python"><span class="bu">repr</span></code> con la
expresión <code
class="sourceCode python">Deposito(<span class="dv">70</span>)</code>
que lleva dentro.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.4">

<ul>
<li><p>La función <code
class="sourceCode python"><span class="bu">eval</span></code> en Python
evalúa la expresión contenida en una cadena y devuelve el valor
resultante:</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="st">&#39;2 + 3 * 5&#39;</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span></code></pre></div></li>
<li><p>Sólo se puede aplicar a cadenas:</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: <span class="bu">eval</span>() arg <span class="dv">1</span> must be a string, <span class="bu">bytes</span> <span class="kw">or</span> code <span class="bu">object</span></span></code></pre></div></li>
<li><p>Y esas cadenas tienen que ser sintáctica y semánticamente
correctas:</p>
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="st">&#39;2 + * 3 5&#39;</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;string&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="op">+</span> <span class="op">*</span> <span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">^</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.5">

<ul>
<li><p>Las funciones <code
class="sourceCode python"><span class="bu">eval</span></code> y <code
class="sourceCode python"><span class="bu">repr</span></code> están
relacionadas de forma que <strong>siempre <em>debería</em> cumplirse lo
siguiente</strong>:</p>
<div class="centered">
<p><code>eval(repr(</code><em>v</em><code>))</code> <code>==</code>
<em>v</em></p>
</div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(<span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span>)) <span class="op">==</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
<li><p>En cambio, ahora mismo tenemos que:</p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(dep)) <span class="op">==</span> dep</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;string&gt;&quot;</span>, line <span class="dv">1</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>__main__.Deposito <span class="bu">object</span> at <span class="bn">0x7fed83fd9160</span><span class="op">&gt;</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">^</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.6">

<ul>
<li><p>Lo que hace realmente la expresión <code
class="sourceCode python"><span class="bu">repr</span>(v)</code> es
llamar al método <code
class="sourceCode python"><span class="fu">__repr__</span></code> del
objeto <code>v</code>.</p></li>
<li><p>Por tanto, la siguiente expresión:</p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">repr</span>(v)</span></code></pre></div>
<p>es equivalente a ésta:</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>v.<span class="fu">__repr__</span>()</span></code></pre></div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(<span class="dv">25</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (<span class="dv">25</span>).<span class="fu">__repr__</span>()</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span></code></pre></div></li>
<li><p>Lo que tenemos que hacer es definir adecuadamente un método <code
class="sourceCode python"><span class="fu">__repr__</span></code> en
nuestra clase.</p></li>
</ul>
</section>
<section id="ejercicio-2" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="3" class="example" type="1">
<li>Inténtalo primero.</li>
</ol>
</section>
<section class="slide level5" data-number="4.3.1.0.7">

<ul>
<li><p>En la clase <code>Deposito</code> podríamos hacer algo así:</p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Deposito(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>fondos<span class="sc">}</span><span class="ss">)&quot;</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... resto del código</span></span></code></pre></div></li>
<li><p>De esta forma, conseguimos el efecto deseado:</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dep.retirar(<span class="dv">30</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(dep)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;Deposito(70)&#39;</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">eval</span>(<span class="bu">repr</span>(dep)) <span class="op">==</span> dep</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.8">

<ul>
<li><p>Para implementar el método <code
class="sourceCode python"><span class="fu">__repr__</span></code> de la
clase <code>Persona</code>, podríamos probar a hacer:</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dni, nombre):</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__dni <span class="op">=</span> dni</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">hash</span>(<span class="va">self</span>.__dni)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__dni<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__nombre<span class="sc">}</span><span class="ss">)&#39;</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span></code></pre></div></li>
<li><p>Pero obtendríamos un resultado incorrecto, porque el DNI y el
nombre de la persona deberían ir entre comillas, ya que son cadenas
literales:</p>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Persona(<span class="st">&#39;28373482X&#39;</span>, <span class="st">&#39;Javier Rodríguez&#39;</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>Persona(<span class="dv">28373482</span>X, Javier Rodríguez)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Persona(<span class="dv">28373482</span>X, Javier Rodríguez)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="pp">SyntaxError</span>: invalid syntax</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.9">

<ul>
<li><p>La solución sería aplicar la función <code
class="sourceCode python"><span class="bu">repr</span></code> también a
los argumentos del constructor de <code>Persona</code>:</p>
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.__dni)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="bu">repr</span>(<span class="va">self</span>.__nombre)<span class="sc">}</span><span class="ss">)&#39;</span></span></code></pre></div></li>
<li><p>Esto se puede abreviar haciendo uso de la <em>conversión</em>
<code>r</code> en los campos de sustitución de la <em>f-string</em>:</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&#39;Persona(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__dni<span class="sc">!r}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>__nombre<span class="sc">!r}</span><span class="ss">)&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.10">

<ul>
<li><p>Es importante señalar que <strong>no siempre se puede definir un
<code class="sourceCode python"><span class="fu">__repr__</span></code>
adecuado para un objeto</strong>.</p></li>
<li><p>Esto es así porque no siempre es posible representar con una
expresión todo el estado interno del objeto.</p></li>
<li><p>De hecho, un objeto puede tener estado interno que no siquiera
sea visible ni conocido en el exterior.</p></li>
<li><p>Por ejemplo, si cada objeto de la clase <code>Deposito</code>
guardara un historial de las operaciones que se han ido realizando con
ese depósito, ese historial formaría parte del estado interno del objeto
pero no aparecería como parámetro en el constructor.</p>
<p>Por tanto, no podríamos describir con una expresión <code
class="sourceCode python">Deposito(...)</code> (ni con ninguna otra)
todo el estado interno del objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.1.0.11">

<ul>
<li><p>Una forma de solucionar este problema sería hacer que el
constructor de la clase pudiera recibir un parámetro adicional
<em>opcional</em> que contenga ese historial:</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos, historial<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> historial <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>           <span class="va">self</span>.historial <span class="op">=</span> []</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">else</span>:</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>           <span class="va">self</span>.historial <span class="op">=</span> historial</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Deposito(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>fondos<span class="sc">!r}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>historial<span class="sc">!r}</span><span class="ss">)&quot;</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... resto del código</span></span></code></pre></div></li>
<li><p>Ese parámetro sólo se usaría en ese caso, es decir, que no
estaría pensado para ser usado de forma habitual al crear objetos
<code>Deposito</code>.</p></li>
</ul>
</section>

<section id="str__" class="title-slide slide level3"
data-number="4.3.2">
<h3 data-number="4.3.2"><span class="header-section-number">4.3.2</span>
<code>__str__</code></h3>
<ul>
<li><p>El método <code
class="sourceCode python"><span class="fu">__str__</span></code> se
invoca automáticamente cuando se necesita convertir un valor al tipo
<code
class="sourceCode python"><span class="bu">str</span></code>.</p></li>
<li><p>Por tanto, la siguiente expresión:</p>
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span>(v)</span></code></pre></div>
<p>es equivalente a ésta:</p>
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>v.<span class="fu">__str__</span>()</span></code></pre></div></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">str</span>(<span class="dv">25</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (<span class="dv">25</span>).<span class="fu">__str__</span>()</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;25&#39;</span></span></code></pre></div></li>
<li><p>Existen muchos casos donde es necesario convertir un valor a
cadena, explícita o implícitamente. Por ejemplo, la función <code
class="sourceCode python"><span class="bu">print</span></code> convierte
a cadena su argumento antes de imprimirlo.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.2.0.1">

<ul>
<li><p>Si la clase del objeto <code>v</code> no tiene definido el método
<code class="sourceCode python"><span class="fu">__str__</span></code>,
por defecto se entiende que se tiene <code
class="sourceCode python"><span class="fu">__str__</span></code> = <code
class="sourceCode python"><span class="fu">__repr__</span></code>. Por
tanto, en tal caso se llama en su lugar al método <code
class="sourceCode python"><span class="fu">__repr__</span></code>.</p></li>
<li><p>¿Cuál es la diferencia entre <code
class="sourceCode python"><span class="fu">__repr__</span></code> y
<code
class="sourceCode python"><span class="fu">__str__</span></code>?</p>
<ul>
<li><p>La finalidad de <code
class="sourceCode python"><span class="fu">__repr__</span></code> es ser
<strong>no ambiguo</strong> y deberíamos implementarlo siempre en todas
nuestras clases (cuando sea posible).</p></li>
<li><p>La finalidad de <code
class="sourceCode python"><span class="fu">__str__</span></code> es ser
<strong>legible para el usuario</strong> y no es estrictamente necesario
implementarlo.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.2.0.2">

<ul>
<li><p>Por ejemplo, en el módulo <code
class="sourceCode python">datetime</code> tenemos clases que sirven para
manipular fechas y horas.</p></li>
<li><p>La clase <code class="sourceCode python">date</code> del módulo
<code class="sourceCode python">datetime</code> nos permite crear
objetos que representan fechas:</p>
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> datetime</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d <span class="op">=</span> datetime.date(<span class="dv">2020</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span></code></pre></div></li>
<li><p>Al llamar a <code
class="sourceCode python"><span class="bu">repr</span></code> sobre
<code>d</code> obtenemos una representación que nos permite reconstruir
el objeto:</p>
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">repr</span>(d)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;datetime.date(2020, 4, 30)&#39;</span></span></code></pre></div></li>
<li><p>Y al llamar a <code
class="sourceCode python"><span class="bu">str</span></code> sobre
<code>d</code> obtenemos una versión más fácil de entender para un ser
humano:</p>
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">str</span>(d)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;2020-04-30&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.3.2.0.3">

<ul>
<li><p>Se puede observar aquí que el intérprete usa <code
class="sourceCode python"><span class="bu">repr</span></code> para
mostrar la forma normal del objeto:</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;datetime.date(2020, 4, 30)&#39;</span></span></code></pre></div></li>
<li><p>Y que <code
class="sourceCode python"><span class="bu">print</span></code> usa <code
class="sourceCode python"><span class="bu">str</span></code> para
imprimir el objeto de una forma legible:</p>
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(d)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2020</span><span class="op">-</span><span class="dv">04</span><span class="op">-</span><span class="dv">30</span></span></code></pre></div></li>
<li><p>Recordemos que <code
class="sourceCode python"><span class="bu">print</span></code> imprime
una cadena por la salida (sin comillas) y devuelve <code
class="sourceCode python"><span class="va">None</span></code>.</p></li>
</ul>
</section>

</section>
<section>
<section id="encapsulación" class="title-slide slide level1"
data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span>
Encapsulación</h1>

</section>
<section id="encapsulación-1" class="title-slide slide level2"
data-number="5.1">
<h2 data-number="5.1"><span class="header-section-number">5.1</span>
Encapsulación</h2>
<ul>
<li><p>En programación orientada a objetos, decimos que los objetos
están <strong>encapsulados</strong>.</p></li>
<li><p>La encapsulación es un concepto fundamental en programación
orientada a objetos, aunque no pertenece exclusivamente a este
paradigma.</p></li>
<li><p>Aunque es uno de los conceptos más importantes de la programación
orientación a objetos, no hay un consenso general y universalmente
aceptado sobre su definición.</p></li>
<li><p>Además, es un concepto relacionado con la abstracción y la
ocultación de información, y a veces se confunde con estos, lo que
complica aún más la cosa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.0.0.1">

<ul>
<li><p>Nosotros vamos a estudiar la encapsulación como dos
<strong>mecanismos</strong> distintos pero relacionados:</p>
<ul>
<li><p>Por una parte, la encapsulación es un <strong>mecanismo</strong>
de los lenguajes de programación que permite que <strong>los datos y las
operaciones</strong> que se puedan realizar sobre esos datos <strong>se
agrupen juntos en una sola <em>unidad sintáctica</em></strong>.</p></li>
<li><p>Por otra parte, la encapsulación es un <strong>mecanismo</strong>
de los lenguajes de programación por el cual <strong>sólo se puede
acceder al interior de un objeto mediante las operaciones</strong> que
forman su <strong>barrera de abstracción</strong>, impidiendo acceder
directamente a los datos internos del mismo y garantizando así la
<strong>protección de datos</strong>.</p>
<p>En definitiva, nos referimos a un mecanismo que garantiza que los
objetos actúan como <strong>datos abstractos</strong>.</p></li>
</ul>
<!--
- Por otra parte, la encapsulación es un **principio** según el cual **las
  operaciones** de un objeto representan una **barrera de abstracción** a
  través de la cual el usuario puede manipular el estado interno del objeto,
  de forma que **sólo se pueda acceder al interior del objeto a través de sus
  operaciones**.

  Como principio, por sí solo no es suficiente para garantizar la protección
  de datos ni la ocultación de información, a no ser que se acompañe de otros
  mecanismos que proporcione el lenguaje.
--></li>
<li><p>Vamos a ver cada uno de ellos con más detalle.</p></li>
</ul>
</section>
<section id="la-encapsulación-como-mecanismo-de-agrupamiento"
class="title-slide slide level3" data-number="5.1.1">
<h3 data-number="5.1.1"><span class="header-section-number">5.1.1</span>
La encapsulación como mecanismo de agrupamiento</h3>
<ul>
<li><p>El mecanismo de las <strong>clases</strong> nos permite crear
estructuras que <strong>agrupan datos y operaciones en una misma
unidad</strong>.</p></li>
<li><p>Al instanciar esas clases, aparecen los <strong>objetos</strong>,
que conservan esa misma característica de agrupar datos (estado interno)
y operaciones en una sola cosa.</p></li>
<li><p>De esta forma, las operaciones acompañan a los datos allá donde
vaya el objeto.</p></li>
<li><p>Por tanto, al pasar un objeto a alguna otra parte del programa,
estamos también pasando las operaciones que se pueden realizar sobre ese
objeto, o lo que es lo mismo, los mensajes a los que puede
responder.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.1.0.1">

<ul>
<li><p>En un lenguaje de programación, llamamos <strong>ciudadano de
primera clase</strong> (<em>first-class citizen</em>) a todo aquello
que:</p>
<ul>
<li><p>Puede ser <strong>pasado como argumento</strong> de una
operación.</p></li>
<li><p>Puede ser <strong>devuelto como resultado</strong> de una
operación.</p></li>
<li><p>Puede ser <strong>asignado</strong> a una variable o
<strong>ligado</strong> a un identificador.</p></li>
</ul></li>
<li><p>En definitiva, un ciudadano de primera clase es <strong>un valor
de un determinado tipo</strong>, simple o compuesto.</p></li>
<li><p>Los objetos se pueden manipular (por ejemplo, enviarles mensajes)
a través de las <em>referencias</em>, y éstas se pueden pasar como
argumento, devolver como resultado y asignarse a una variable.</p></li>
<li><p>Por tanto, <strong>los objetos son <em>ciudadanos de primera
clase</em></strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.1.0.2">

<ul>
<li><p>Por ejemplo, si definimos una función que calcula la diferencia
entre los saldos de dos depósitos, podríamos hacer:</p>
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diferencia(dep1, dep2):</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dep1.saldo() <span class="op">-</span> dep2.saldo()</span></code></pre></div></li>
<li><p>Es decir:</p>
<ul>
<li><p>La función <code>diferencia</code> recibe como argumentos los dos
depósitos (que son objetos), por lo que éstos son ciudadanos de primera
clase.</p></li>
<li><p>Los objetos encapsulan:</p>
<ul>
<li><p>sus <em>datos</em> (su estado interno) y</p></li>
<li><p>sus <em>operaciones</em> (los mensajes a los que puede
responder)</p></li>
</ul>
<p>juntos en una sola unidad sintáctica, a la que podemos acceder usando
una sencilla referencia, como <code>dep1</code> o
<code>dep2</code>.</p></li>
<li><p>Para obtener el saldo no se usa una función externa al objeto,
sino que se le pregunta a este a través de la operación
<code>saldo</code> contenida dentro del objeto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.1.0.3">

<ul>
<li><p>En resumen, decir que los objetos están encapsulados es decir
que:</p>
<ul>
<li><p>Agrupan datos y operaciones en una sola unidad.</p></li>
<li><p>Son ciudadanos de primera clase.</p></li>
<li><p>Es posible manipularlos por completo usando simplemente una
referencia.</p></li>
<li><p>La referencia representa al objeto.</p></li>
</ul></li>
</ul>
</section>

<section id="la-encapsulación-como-mecanismo-de-protección-de-datos"
class="title-slide slide level3" data-number="5.1.2">
<h3 data-number="5.1.2"><span class="header-section-number">5.1.2</span>
La encapsulación como mecanismo de protección de datos</h3>
<ul>
<li><p>Un dato abstracto es aquel que se define en función de las
operaciones que se pueden realizar sobre él.</p></li>
<li><p>Los objetos son datos abstractos y, por tanto, su estado interno
debería manejarse únicamente mediante operaciones definidas a tal
efecto, impidiendo el acceso directo a los atributos internos del
objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.0.1">

<ul>
<li><p>Según esto, podemos imaginar que:</p>
<ul>
<li><p>Los atributos que almacenan el estado interno del objeto están
<em>encapsulados</em> dentro del mismo.</p></li>
<li><p>Las operaciones con las que se puede manipular el objeto
<em>rodean</em> a esos atributos formando una <em>cápsula</em>, de forma
que, para poder acceder al interior, hay que hacerlo necesariamente a
través de esas operaciones.</p></li>
</ul></li>
</ul>
<div class="centered">
<figure>
<img data-src="images/operaciones-capsula.png" class="plain"
style="width:30.0%" alt="Las operaciones forman una cápsula" />
<figcaption aria-hidden="true">Las operaciones forman una
<em>cápsula</em></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="5.1.2.0.2">

<ul>
<li>Esas operaciones son las que aparecen en la
<strong>especificación</strong> de su tipo abstracto y, por tanto,
definen de qué manera podemos manipular al objeto desde el exterior del
mismo.</li>
</ul>
<div class="centered">
<figure>
<img data-src="images/operaciones-capsula.jpg" style="width:50.0%"
alt="Las operaciones forman una cápsula" />
<figcaption aria-hidden="true">Las operaciones forman una
<em>cápsula</em></figcaption>
</figure>
</div>
</section>
<section id="visibilidad" class="title-slide slide level4"
data-number="5.1.2.1">
<h4 data-number="5.1.2.1"><span
class="header-section-number">5.1.2.1</span> Visibilidad</h4>
<ul>
<li><p>Para garantizar esta restricción de acceso, los lenguajes de
programación a menudo facilitan un mecanismo por el cual el programador
puede definir la <strong>visibilidad</strong> de cada miembro de una
clase.</p></li>
<li><p>De esta forma, el programador puede «marcar» que determinadas
variables de instancia o métodos sólo sean accesibles desde el interior
de esa clase o que, por el contrario, sí se pueda acceder a ellos desde
el exterior de la misma.</p></li>
</ul>
<p><span class="math display">\text{Visibilidad} \begin{cases}
\text{No se puede acceder desde el exterior, o} \\
\text{Sí se puede acceder desde el exterior}
\end{cases}</span></p>
</section>
<section class="slide level5" data-number="5.1.2.1.1">

<ul>
<li><p>Cada una de estas dos posibilidades da lugar a un tipo distinto
de visibilidad:</p>
<ul>
<li><p><strong>Visibilidad <em>privada</em>:</strong> si un miembro
tiene visibilidad privada, sólo podrá accederse a él desde dentro de esa
clase, pero no desde fuera de ella.</p></li>
<li><p><strong>Visibilidad <em>pública</em>:</strong> si un miembro
tiene visibilidad pública, podrá accederse a él tanto desde dentro como
desde fuera de la clase.</p></li>
<li><p>Por tanto, <strong>desde el exterior de un objeto sólo podremos
acceder a los miembros <em>públicos</em> de ese
objeto</strong>.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.1.2">

<div class="centered">
<figure>
<img data-src="images/encapsulacion.png" class="plain"
style="width:60.0%" alt="Miembros públicos y privados" />
<figcaption aria-hidden="true">Miembros <em>públicos</em> y
<em>privados</em></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="5.1.2.1.3">

<ul>
<li><p>Cada lenguaje de programación tiene su propia manera de
implementar mecanismos de visibilidad.</p></li>
<li><p>En Python, el mecanismo es muy sencillo:</p>
<div class="caja">
<p>Si el nombre de un miembro (de clase o de objeto) definido dentro del
cuerpo de una clase empieza (pero no acaba) por <code>__</code>,
entonces es <em>privado</em>. En caso contrario, es
<em>público</em>.</p>
</div></li>
<li><p>Los <em>métodos mágicos</em> (como <code
class="sourceCode python"><span class="fu">__init__</span></code>, <code
class="sourceCode python"><span class="fu">__eq__</span></code>, etc.)
tienen nombres que empiezan <strong>y acaban</strong> por
<code>__</code>, así que no cumplen la condición anterior y, por tanto,
son <em>públicos</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.1.4">

<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Prueba:</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __uno(<span class="va">self</span>):</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método es privado, ya que su nombre empieza por __&quot;</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método es público&quot;</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __tres__(<span class="va">self</span>):</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Este método también es público, porque su nombre empieza y acaba por __&quot;</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Prueba()</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>p.__uno()    <span class="co"># No funciona, ya que __uno es un método privado</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>p.dos()      <span class="co"># Funciona, ya que el método dos es público</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>p.__tres__() <span class="co"># También funciona</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.1.5">

<ul>
<li><p>Los miembros privados sólo son accesibles desde dentro de la
clase:</p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> __uno(<span class="va">self</span>):</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>...         <span class="bu">print</span>(<span class="st">&quot;Este método es privado, ya que su nombre empieza por __&quot;</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> dos(<span class="va">self</span>):</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>...         <span class="bu">print</span>(<span class="st">&quot;Este método es público&quot;</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__uno() <span class="co"># Llama al método privado desde dentro de la clase</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba()</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.__uno()    <span class="co"># No funciona, ya que __uno es un método privado</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Prueba&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;__uno&#39;</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.dos()      <span class="co"># Funciona, ya que el método dos es público</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>Este método es público</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>Este método es privado, ya que su nombre empieza por __</span></code></pre></div></li>
<li><p>El método <code>__uno</code> se ha creado dentro de la clase
<code>Prueba</code> y pertenece a la misma clase <code>Prueba</code>,
así que ese método es <em>privado</em>, se puede acceder a él dentro del
cuerpo de la clase <code>Prueba</code>, pero no es visible fuera de
ella.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.1.6">

<ul>
<li><p>Con las variables de instancia ocurre exactamente igual:</p>
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x):</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__x <span class="op">=</span> x       <span class="co"># __init__ puede acceder a __x</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>...                            <span class="co"># ya que los dos están dentro de la misma clase</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba(<span class="dv">1</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.__x   <span class="co"># No funciona, ya que __x es privada</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="pp">AttributeError</span>: <span class="st">&#39;Prueba&#39;</span> <span class="bu">object</span> has no attribute <span class="st">&#39;__x&#39;</span></span></code></pre></div></li>
<li><p>La variable de instancia <code>__x</code> se ha creado dentro de
la clase <code>Prueba</code> y pertenece a un objeto de la misma clase
<code>Prueba</code>, así que esa variable es <em>privada</em>, se puede
acceder a ella dentro del cuerpo de la clase <code>Prueba</code>, pero
no es visible fuera de ella.</p></li>
</ul>
</section>

<section id="accesores-y-mutadores" class="title-slide slide level4"
data-number="5.1.2.2">
<h4 data-number="5.1.2.2"><span
class="header-section-number">5.1.2.2</span> Accesores y mutadores</h4>
<ul>
<li><p>En muchas ocasiones, ocurre que necesitamos manipular el valor
contenido en una variable de instancia privada, pero desde fuera del
objeto.</p></li>
<li><p>Para ello, necesitamos definir operaciones (métodos) que nos
permitan acceder y/o modificar el valor de la variable de instancia
privada del objeto desde fuera del mismo.</p></li>
<li><p>Estos métodos pueden ser:</p>
<ul>
<li><p><strong>Accesores o <em>getters</em>:</strong> permiten acceder
al valor de una variable de instancia privada desde fuera del
objeto.</p></li>
<li><p><strong>Mutadores o <em>setters</em>:</strong> permiten modificar
el valor de una variable de instancia privada desde fuera del
objeto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.2.1">

<ul>
<li><p>Por ejemplo, si tenemos una variable de instancia privada que
deseamos manipular desde el exterior del objeto, podemos definir una
pareja de métodos <code>get</code> y <code>set</code> de la siguiente
forma:</p>
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="kw">class</span> Prueba:</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, x):</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.set_x(x)        <span class="co"># En el constructor aprovechamos el setter</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> get_x(<span class="va">self</span>):         <span class="co"># Este es el getter de la variable __x</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>...         <span class="cf">return</span> <span class="va">self</span>.__x</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>...     <span class="kw">def</span> set_x(<span class="va">self</span>, x):      <span class="co"># Este es el setter de la variable __x</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>...         <span class="va">self</span>.__x <span class="op">=</span> x</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Prueba(<span class="dv">1</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.get_x()                    <span class="co"># Accedemos al valor de __x</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.set_x(<span class="dv">5</span>)                   <span class="co"># Cambiamos el valor de __x</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p.get_x()                    <span class="co"># Accedemos de nuevo al valor de __x</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div></li>
<li><p>La pregunta es: ¿qué ganamos con todo esto?</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.2.2">

<p><strong>¡CUIDADO!</strong></p>
<ul>
<li><p>Supogamos que tenemos el siguiente código que implementa
colas:</p>
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Cola:</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;Invariante: self.__cantidad == len(self.__items).&quot;&quot;&quot;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items <span class="op">=</span> []</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meter(<span class="va">self</span>, el):</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__items.append(el)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sacar(<span class="va">self</span>):</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.__cantidad <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Cola vacía&quot;</span>)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> <span class="va">self</span>.__items[<span class="dv">0</span>]</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__cantidad <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_items(<span class="va">self</span>):</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__items</span></code></pre></div></li>
<li><p>Se supone que la variable de instancia <code>__items</code> es
privada y, por tanto, sólo se puede acceder a ella desde el interior de
la clase.</p></li>
<li><p>El método <code>get_items</code> es un <em>getter</em> para la
variable de instancia <code>__items</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.2.3">

<ul>
<li><p>En teoría, los únicos métodos con los que podemos modificar el
contenido de la variable de instancia <code>__items</code> son
<code>meter</code> y <code>sacar</code>.</p></li>
<li><p>Sin embargo, podemos hacer así:</p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Cola()</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>c.meter(<span class="dv">1</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>c.meter(<span class="dv">2</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> c.get_items() <span class="co"># Obtenemos la lista contenida en __items</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> l[<span class="dv">0</span>]          <span class="co"># Eliminamos un elemento de la lista desde fuera de la cola</span></span></code></pre></div></li>
<li><p>Esto se debe a que <code>get_items</code> devuelve una referencia
a la lista contenida dentro de la instancia de <code>Cola</code>, con lo
cual podemos modificar la lista desde el exterior sin necesidad de usar
los <em>setters</em>.</p></li>
<li><p>Por tanto, podemos romper los invariantes de la clase, ya que
ahora se cumple que <code>c.__cantidad</code> vale 2 y <code
class="sourceCode python"><span class="bu">len</span></code><code>(c.__items)</code>
vale <code class="sourceCode python"><span class="dv">1</span></code>
(no coinciden).</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.2.4">

<ul>
<li><p>Para solucionar el problema, tenemos dos opciones:</p>
<ul>
<li><p>Quitar el método <code>get_items</code> si es posible.</p></li>
<li><p>Si es estrictamente necesario que exista, cambiarlo para que no
devuelva una referencia a la lista, sino una <strong>copia</strong> de
la lista:</p></li>
</ul>
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_items(<span class="va">self</span>):</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>.__items[:]</span></code></pre></div></li>
</ul>
</section>

<section id="invariantes-de-clase" class="title-slide slide level4"
data-number="5.1.2.3">
<h4 data-number="5.1.2.3"><span
class="header-section-number">5.1.2.3</span> Invariantes de clase</h4>
<ul>
<li><p>Si necesitamos acceder y/o cambiar el valor de una variable de
instancia desde fuera del objeto, ¿por qué hacerlo privado? ¿Por qué no
simplemente hacerlo público y así evitamos tener que hacer
<em>getters</em> y <em>setters</em>?:</p>
<ul>
<li><p>Las variables de instancia públicas del objeto rompen con los
conceptos de <em>encapsulación</em> y de <em>abstracción de datos</em>,
ya que permite acceder al interior de un objeto directamente, en lugar
de hacerlo a través de operaciones.</p></li>
<li><p>Ya sabemos que con eso se rompe con el principio de
<em>ocultación de información</em>, ya que exponemos públicamente el
tipo y la representación del dato, por lo que nos resultará muy difícil
cambiarlos posteriormente si en el futuro nos hace falta
hacerlo.</p></li>
<li><p>Pero además, los <em>setters</em> nos garantizan que los valores
que se almacenan en una variable de instancia cumplen con las
<strong>condiciones</strong> necesarias.</p>
<div class="caja">
<p>Las condiciones que deben cumplir en todo momento las instancias de
una clase se denominan <strong>invariantes de la clase</strong>.</p>
</div></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.3.1">

<ul>
<li><p>Por ejemplo: si queremos almacenar los datos de una persona y
queremos garantizar que la edad no sea negativa, podemos hacer:</p>
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;Invariante: todas las personas deben tener edad no negativa.&quot;&quot;&quot;</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, nombre, edad):</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_nombre(nombre)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_edad(edad)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_nombre(<span class="va">self</span>):</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__nombre</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_edad(<span class="va">self</span>, edad):</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edad <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;La edad no puede ser negativa&quot;</span>)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> Persona(<span class="st">&quot;Manuel&quot;</span>, <span class="dv">30</span>)   <span class="co"># Es correcto</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p.set_nombre())       <span class="co"># Imprime &#39;Manuel&#39;</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>p.set_edad(<span class="dv">25</span>)              <span class="co"># Cambia la edad a 25</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>p.set_edad(<span class="op">-</span><span class="dv">14</span>)             <span class="co"># Provoca un error</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>p.__edad <span class="op">=</span> <span class="op">-</span><span class="dv">14</span>              <span class="co"># Funcionaría si __edad no fuese privada</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.3.2">

<ul>
<li><p>En conclusión, se recomienda:</p>
<ul>
<li><p>Hacer <strong>privados</strong> todos los miembros excepto los
que sean estrictamente necesarios para poder manipular el objeto desde
el exterior del mismo (su <strong><em>interfaz</em></strong>).</p></li>
<li><p>Crear <em>getters</em> y <em>setters</em> para los atributos que
se tengan que manipular desde el exterior del objeto.</p></li>
<li><p>Dejar claros los <em>invariantes</em> de las clases en el código
fuente de las mismas mediante comentarios, y comprobarlos adecuadamente
donde corresponda (en los <em>setters</em>, principalmente).</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.3.3">

<ul>
<li><p>El concepto de invariante de una clase, aunque puede parecer
nuevo, en realidad es el mismo concepto que ya vimos al estudiar las
<strong>abstracciones de datos</strong>.</p></li>
<li><p>Entonces dijimos que una abstracción de datos se define por unas
<strong>operaciones</strong> y por las <strong>propiedades</strong> que
deben cumplir esas operaciones.</p></li>
<li><p>También dijimos que esas propiedades se describen como
<em>ecuaciones</em> en la <strong>especificación</strong> del tipo
abstracto (y, por tanto, se deben cumplir independientemente de la
implementación).</p></li>
</ul>
<div class="caja">
<p>Cuando implementamos un tipo abstracto mediante una clase,
<strong>algunas de esas propiedades se traducen en invariantes</strong>
de la clase.</p>
</div>
</section>
<section class="slide level5" data-number="5.1.2.3.4">

<ul>
<li><p>En cambio, otras de esas propiedades <strong>no serán
<em>invariantes</em> de la clase, sino <em>condiciones</em> que tienen
que cumplir los métodos</strong> (es decir, las operaciones) al entrar o
salir de los mismos.</p></li>
<li><p>Esas condiciones son las que forman la <strong>especificación
funcional</strong> de cada método de la clase.</p></li>
<li><p>Recordemos que una especificación funcional contiene dos
condiciones:</p>
<ul>
<li><p><strong>Precondición</strong>: condición que tiene que cumplir el
método para poder ejecutarse.</p></li>
<li><p><strong>Postcondición</strong>: condición que tiene que cumplir
el método al acabar de ejecutarse.</p></li>
</ul></li>
<li><p>Si se cumple la precondición de un método y éste se ejecuta, al
finalizar su ejecución se debe cumplir su postcondición.</p></li>
<li><p>Forman una especificación porque describen qué tiene que hacer el
método sin entrar a ver el cómo.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.3.5">

<ul>
<li><p>Resumiendo:</p>
<ul>
<li><p>Las clases implementan <strong>tipos abstractos de
datos</strong>.</p></li>
<li><p>Los tipos abstractos de datos se <strong>especifican</strong>
indicando sus <strong>operaciones</strong> y las
<strong>propiedades</strong> que deben cumplir esas
operaciones.</p></li>
<li><p>Esas propiedades se traducirán en:</p>
<ul>
<li><p><strong>Invariantes</strong> de la clase.</p></li>
<li><p><strong>Precondiciones</strong> o
<strong>postcondiciones</strong> de los métodos que implementan las
operaciones del tipo abstracto.</p></li>
</ul></li>
<li><p>El <strong>usuario de la clase</strong> es
<strong>responsable</strong> de garantizar que se cumple la
<strong>precondición</strong> de un método cuando lo invoca.</p></li>
<li><p>La <strong>implementación</strong> de la clase es
<strong>responsable</strong> de garantizar que se cumple en todo momento
las <strong>invariantes</strong> de la clase, así como las
<strong>postcondiciones</strong> de los métodos cuando se les invoca en
un estado que cumple su precondición.</p></li>
</ul></li>
</ul>
</section>

<section id="interfaz-y-especificación-de-una-clase"
class="title-slide slide level4" data-number="5.1.2.4">
<h4 data-number="5.1.2.4"><span
class="header-section-number">5.1.2.4</span> Interfaz y especificación
de una clase</h4>
<ul>
<li><p>La <strong>interfaz de una clase</strong> (o de un objeto de esa
clase) está formada por todo lo que es público y visible desde fuera de
la clase.</p></li>
<li><p>En concreto, la interfaz de una clase indica:</p>
<ul>
<li><p>El <strong>nombre de la clase</strong>.</p></li>
<li><p>El nombre y tipo de las <strong>variables de instancia
públicas</strong>.</p></li>
<li><p>La <strong>signatura</strong> de los <strong>métodos
públicos</strong>.</p></li>
</ul></li>
<li><p>Es un concepto puramente sintáctico, porque describe
<strong>qué</strong> proporciona la clase pero no qué propiedades debe
cumplir (para qué sirve la clase).</p></li>
<li><p>Por tanto, podemos decir que el usuario de la clase no tiene
suficiente con conocer la interfaz de la clase.</p></li>
<li><p>También necesita saber qué hace, y eso no se indica en la
interfaz.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.4.1">

<ul>
<li><p>La <strong>especificación de una clase</strong> representa todo
lo que es necesario conocer para usar la clase (y, por tanto, cualquier
objeto de esa clase).</p></li>
<li><p>Describe qué hace la clase (o el objeto) sin detallar
cómo.</p></li>
<li><p>Tiene un papel similar a la especificación de un tipo abstracto
de datos.</p></li>
<li><p>Está formado por:</p>
<ul>
<li><p>La <strong>interfaz</strong> de la clase.</p></li>
<li><p>Los <strong>invariantes</strong> de la clase.</p></li>
<li><p>La <strong>especificación funcional</strong> (precondición,
postcondición y signatura) de todos los <strong>métodos
públicos</strong> de la clase.</p></li>
<li><p><strong>Documentación adicional</strong> que explique la función
de la clase y sus operaciones, así como posible información extra que
pueda resultar de interés para el usuario de la clase.</p></li>
</ul></li>
</ul>
</section>

<section id="asertos" class="title-slide slide level4"
data-number="5.1.2.5">
<h4 data-number="5.1.2.5"><span
class="header-section-number">5.1.2.5</span> Asertos</h4>
<ul>
<li><p>La <strong>comprobación</strong> continua de las condiciones
(invariantes, precondiciones o postcondiciones) cada vez que se
actualiza el estado interno de un objeto puede dar lugar a
<strong>problemas de rendimiento</strong>, ya que las comprobaciones
consumen tiempo de CPU.</p></li>
<li><p>Una técnica alternativa a la comprobación con sentencias
condicionales (<code
class="sourceCode python"><span class="cf">if</span></code>s) es el uso
de <strong>asertos</strong>.</p></li>
<li><p>Un aserto es una <strong>condición que se debe cumplir en un
determinado punto del programa</strong>, de forma que el programa
abortará en ese punto si no se cumple.</p></li>
<li><p>Para insertar un aserto en un punto del programa, se usa la
sentencia <code
class="sourceCode python"><span class="cf">assert</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.5.1">

<ul>
<li><p>El código anterior quedaría así usando <code
class="sourceCode python"><span class="cf">assert</span></code>:</p>
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="st">Invariante: todas las personas deben tener edad no negativa.</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona:</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, nombre, edad):</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_nombre(nombre)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_edad(edad)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_nombre(<span class="va">self</span>, nombre):</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__nombre <span class="op">=</span> nombre</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_nombre(<span class="va">self</span>):</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__nombre</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_edad(<span class="va">self</span>, edad):</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> edad <span class="op">&gt;=</span> <span class="dv">0</span>      <span class="co"># La edad tiene que ser &gt;= 0</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__edad <span class="op">=</span> edad</span></code></pre></div></li>
<li><p>El intérprete comprobará el aserto cuando el flujo de control
llegue a la sentencia <code
class="sourceCode python"><span class="cf">assert</span></code> y, en
caso de que no se cumpla, lanzará una excepción de tipo <code
class="sourceCode python"><span class="pp">AssertionError</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.5.2">

<ul>
<li><p>Lo interesante de los asertos es que podemos pedirle al
intérprete que ignore todas las sentencias <code
class="sourceCode python"><span class="cf">assert</span></code> cuando
ejecute el código.</p></li>
<li><p>Para ello, usamos la opción <code>-O</code> al llamar al
intérprete de Python desde la línea de comandos del sistema
operativo:</p></li>
</ul>
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prueba.py</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Antes&quot;</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Después&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre
class="sourceCode console"><code class="sourceCode console"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">$ </span>python prueba.py</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>Antes</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  File &quot;prueba.py&quot;, line 2, in <span class="co">&lt;module&gt;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    assert False</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>AssertionError</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="kw">$ </span>python -O prueba.py</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>Antes</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>Después</span></code></pre></div>
<ul>
<li>Con la opción <code>-O</code> (de «<strong>O</strong>ptimizado»)
podemos elegir entre mayor rendimiento o mayor seguridad al ejecutar
nuestros programas.</li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.5.3">

<ul>
<li><p>Aún así, no siempre es conveniente poder saltarse los asertos. De
hecho, a veces lo mejor sigue siendo comprobar condiciones con un <code
class="sourceCode python"><span class="cf">if</span></code> y lanzar un
error adecuado si la condición no se cumple.</p></li>
<li><p>Por ejemplo, si intentamos retirar fondos de un depósito pero no
hay saldo suficiente, eso se debería comprobar siempre:</p></li>
</ul>
<div class="sourceCode" id="cb100"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:                    <span class="co"># Si no hay fondos:</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Fondos insuficientes&quot;</span>)  <span class="co"># Error</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</section>
<section class="slide level5" data-number="5.1.2.5.4">

<ul>
<li><p>¿Cuándo usar asertos y cuándo usar excepciones?</p>
<ul>
<li><p>Las <strong>excepciones</strong> se deben usan para detectar
errores de programación de los <strong>usuarios</strong> del método o
clase.</p></li>
<li><p>Los <strong>asertos</strong> se deben usar para detectar errores
de funcionamiento del <strong>interior</strong> del método o clase, es
decir, errores que haya cometido el <strong>implementador</strong> o
<strong>creador</strong> del método o clase.</p></li>
<li><p>Además, los asertos están pensados para detectar errores muy
anormales que no se espera que se puedan capturar ni gestionar.</p></li>
<li><p>Por eso, el objetivo principal de los asertos es servir al
creador de una clase como mecanismo de comprobación de que su clase
funciona correctamente.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="5.1.2.5.5">

<ul>
<li><p>Resumiendo:</p>
<ul>
<li><p>Un <strong>invariante de una clase</strong> es una condición que
se debe cumplir durante toda la vida de todas las instancias de una
clase.</p></li>
<li><p>Una <strong>precondición de un método</strong> es una condición
que se debe cumplir justo antes de ejecutar el método.</p></li>
<li><p>Una <strong>postcondición de un método</strong> es una condición
que se debe cumplir justo al finalizar la ejecución del método.</p></li>
<li><p>Un <strong>aserto</strong> es una condición que se debe cumplir
en un determinado punto del programa.</p></li>
<li><p>Para <strong>implementar invariantes de clase, precondiciones o
postcondiciones de métodos</strong> se pueden usar excepciones, asertos
y sentencias <code
class="sourceCode python"><span class="cf">assert</span></code> en
puntos adecuados del código fuente de la clase.</p></li>
</ul></li>
</ul>
</section>

<section id="un-ejemplo-completo" class="title-slide slide level4"
data-number="5.1.2.6">
<h4 data-number="5.1.2.6"><span
class="header-section-number">5.1.2.6</span> Un ejemplo completo</h4>
<ul>
<li>Recordemos la especificación del tipo <em>pila</em>
<strong>inmutable</strong>:</li>
</ul>
<div class="line-block"><strong>espec</strong> <em>pila</em><br />
    <strong>parámetros</strong><br />
          <em>elemento</em><br />
    <strong>operaciones</strong><br />
          <code>pvacia</code> : <span
class="math inline">\rightarrow</span> <em>pila</em><br />
          <code>apilar</code> : <em>pila</em> <span
class="math inline">\times</span> <em>elemento</em> <span
class="math inline">\rightarrow</span> <em>pila</em><br />
          <strong>parcial</strong> <code>desapilar</code> :
<em>pila</em> <span class="math inline">\rightarrow</span>
<em>pila</em><br />
          <strong>parcial</strong> <code>cima</code> : <em>pila</em>
<span class="math inline">\rightarrow</span> <em>elemento</em><br />
          <code>vacia?</code> : <em>pila</em> <span
class="math inline">\rightarrow</span> <span
class="math inline">\mathfrak{B}</span><br />
    <strong>var</strong><br />
          <span class="math inline">p</span> : <em>pila</em>; <span
class="math inline">x</span> : <em>elemento</em><br />
    <strong>ecuaciones</strong><br />
          <code>cima</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\doteq</span> <span
class="math inline">x</span><br />
          <code>desapilar</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\doteq</span> <span
class="math inline">p</span><br />
          <code>vacia?</code>(<code>pvacia</code>) <span
class="math inline">\doteq</span> <span
class="math inline">V</span><br />
          <code>vacia?</code>(<code>apilar</code>(<span
class="math inline">p</span>, <span class="math inline">x</span>)) <span
class="math inline">\doteq</span> <span
class="math inline">F</span><br />
          <code>cima</code>(<code>pvacia</code>) <span
class="math inline">\doteq</span> <span
class="math inline">error</span><br />
          <code>desapilar</code>(<code>pvacia</code>) <span
class="math inline">\doteq</span> <span
class="math inline">error</span></div>
</section>
<section class="slide level5" data-number="5.1.2.6.1">

<ul>
<li>La especificación del mismo tipo <em>pila</em> pero
<strong>mutable</strong> podría ser:</li>
</ul>
<div class="line-block"><strong>espec</strong> <em>pila</em><br />
    <strong>parámetros</strong><br />
          <em>elemento</em><br />
    <strong>operaciones</strong><br />
          <code>pila</code> : <span
class="math inline">\rightarrow</span> <em>pila</em><br />
          <code>apilar</code> : <em>pila</em> <span
class="math inline">\times</span> <em>elemento</em> <span
class="math inline">\rightarrow</span> <span
class="math inline">\empty</span><br />
          <strong>parcial</strong> <code>desapilar</code> :
<em>pila</em> <span class="math inline">\rightarrow</span> <span
class="math inline">\empty</span><br />
          <strong>parcial</strong> <code>cima</code> : <em>pila</em>
<span class="math inline">\rightarrow</span> <em>elemento</em><br />
          <code>vacía?</code> : <em>pila</em> <span
class="math inline">\rightarrow</span> <span
class="math inline">\mathfrak{B}</span><br />
          _ <code>==</code> _ : <em>pila</em> <span
class="math inline">\times</span> <em>pila</em> <span
class="math inline">\rightarrow</span> <span
class="math inline">\mathfrak{B}</span><br />
    <strong>var</strong><br />
          <span class="math inline">p</span>, <span
class="math inline">p_1</span>, <span class="math inline">p_2</span> :
<em>pila</em>; <span class="math inline">x</span> :
<em>elemento</em><br />
    <strong>ecuaciones</strong><br />
          <span class="math inline">p_1</span> <code>==</code> <span
class="math inline">p_2</span> <span class="math inline">\doteq</span>
«<span class="math inline">p_1</span> y <span
class="math inline">p_2</span> tienen los mismos elementos en el mismo
orden»<br />
          <code>vacía?</code>(<span class="math inline">p</span>) <span
class="math inline">\doteq</span> <span class="math inline">p</span>
<code>==</code> <code>pila</code><br />
          <code>apilar</code>(<span class="math inline">p</span>, <span
class="math inline">x</span>)   { Apila el elemento <span
class="math inline">x</span> en la cima de la pila <span
class="math inline">p</span> }<br />
          <code>desapilar</code>(<span class="math inline">p</span>)   {
Saca de la pila <span class="math inline">p</span> el elemento situado
en su cima }<br />
          <code>cima</code>(<span class="math inline">p</span>) <span
class="math inline">\doteq</span> «el último elemento apilado en <span
class="math inline">p</span> y aún no desapilado»<br />
          <code>vacía?</code>(<span class="math inline">p</span>) <span
class="math inline">\Rightarrow</span> <code>desapilar</code>(<span
class="math inline">p</span>) <span class="math inline">\doteq</span>
<span class="math inline">error</span><br />
          <code>vacía?</code>(<span class="math inline">p</span>) <span
class="math inline">\Rightarrow</span> <code>cima</code>(<span
class="math inline">p</span>) <span class="math inline">\doteq</span>
<span class="math inline">error</span></div>
</section>
<section class="slide level5" data-number="5.1.2.6.2">

<ul>
<li><p>A veces, la especificación de un tipo abstracto resulta más
conveniente redactarla en lenguaje natural, simplemente porque queda más
fácil de entender o más claro o fácil de leer.</p></li>
<li><p>Por ejemplo, podríamos crear un documento de
<strong>especificación en lenguaje natural</strong> del tipo abstracto
<em>pila</em> explicando qué funcionalidad tiene y las operaciones que
contiene:</p></li>
</ul>
<div class="caja">
<p><strong>Tipo</strong>: <em>pila</em></p>
<ul>
<li><p>Define una pila de elementos, de forma que se van almacenando en
el orden en que han sido introducidos y se van extrayendo en orden
contrario siguiendo una estrategia <em>LIFO</em> (<em>L</em>ast
<em>I</em>n, <em>F</em>irst <em>O</em>ut).</p></li>
<li><p>Los elementos pueden ser de cualquier tipo.</p></li>
<li><p>Dos pilas son iguales si tienen los mismos elementos y en el
mismo orden.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="5.1.2.6.3">

<div class="caja">
<p><strong>Operaciones constructoras y modificadoras:</strong></p>
<ul>
<li><p><code>pila()</code> <span class="math inline">\rightarrow</span>
<em>pila</em></p>
<p>Crea una pila vacía (es decir, sin elementos) y la devuelve.</p></li>
<li><p><code>apilar(</code><span class="math inline">p</span>:
<em>pila</em>, <span class="math inline">elem</span><code>)</code> <span
class="math inline">\rightarrow</span> <span
class="math inline">\empty</span></p>
<p>Introduce el elemento <span class="math inline">elem</span> encima de
la pila <span class="math inline">p</span>. Ese elemento pasa a estar
ahora en la cima de la pila, por lo que tras su ejecución se debe
cumplir que <code>cima(</code><span
class="math inline">p</span><code>)</code> <code>==</code> <span
class="math inline">elem</span>. La operación no devuelve ningún
resultado.</p></li>
<li><p><code>desapilar(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span class="math inline">\rightarrow</span>
<span class="math inline">\empty</span></p>
<p>Extrae de la pila <span class="math inline">p</span> el elemento
situado en la cima. Si <span class="math inline">p</span> está vacía, da
error. El elemento que queda ahora en la cima es el que había justo
antes de apilar el elemento recién extraído. La operación no devuelve
ningún resultado.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="5.1.2.6.4">

<div class="caja">
<p><strong>Operaciones selectoras:</strong></p>
<ul>
<li><p><span class="math inline">p_1</span>: <em>pila</em>
<code>==</code> <span class="math inline">p_2</span>: <em>pila</em>
<span class="math inline">\rightarrow</span> <span
class="math inline">\mathfrak{B}</span></p>
<p>Devuelve <span class="math inline">V</span> si <span
class="math inline">p_1</span> y <span class="math inline">p_2</span>
son dos pilas iguales, y <span class="math inline">F</span> en caso
contrario.</p>
<p>Dos pilas son iguales si tienen los mismos elementos y en el mismo
orden.</p></li>
<li><p><code>vacía?(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span class="math inline">\rightarrow</span>
<span class="math inline">\mathfrak{B}</span></p>
<p>Devuelve <span class="math inline">V</span> si la pila <span
class="math inline">p</span> no tiene elementos, y <span
class="math inline">F</span> en caso contrario.</p></li>
<li><p><code>cima(</code><span class="math inline">p</span>:
<em>pila</em><code>)</code> <span class="math inline">\rightarrow</span>
<span class="math inline">cualquiera</span></p>
<p>Devuelve el elemento situado en la cima de la pila. Si la pila está
vacía, da error.</p>
<p>El tipo del dato devuelto es el tipo del elemento que hay en la
cima.</p></li>
</ul>
</div>
</section>
<section class="slide level5" data-number="5.1.2.6.5">

<ul>
<li>Una posible implementación con una clase Python podría ser:</li>
</ul>
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Pila:</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems <span class="op">=</span> []</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, otra):</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="bu">type</span>(<span class="va">self</span>) <span class="op">!=</span> <span class="bu">type</span>(otra):</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>           <span class="cf">return</span> <span class="va">NotImplemented</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems <span class="op">==</span> otra.__elems</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> vacia(<span class="va">self</span>):</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems <span class="op">==</span> []</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> apilar(<span class="va">self</span>, elem):</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems.append(elem)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> desapilar(<span class="va">self</span>):</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="va">self</span>.vacia():</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>           <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;No se puede desapilar una pila vacía&#39;</span>)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>       <span class="va">self</span>.__elems.pop()</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>   <span class="kw">def</span> cima(<span class="va">self</span>):</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> <span class="va">self</span>.vacia():</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>           <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;Una pila vacía no tiene cima&#39;</span>)</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>       <span class="cf">return</span> <span class="va">self</span>.__elems[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
</section>
<section class="slide level5" data-number="5.1.2.6.6">

<ul>
<li><p>Resulta curioso observar que la implementación, en este caso, es
probablemente más corta, elegante, precisa y fácil de entender que
cualquiera de las especificaciones que hemos visto
anteriormente.</p></li>
<li><p>De hecho, si considerásemos al lenguaje Python como un lenguaje
con el que escribir especificaciones, el código anterior resultaría la
mejor especificación de todas las que hemos visto.</p></li>
<li><p>Eso se debe a que la riqueza de tipos de Python, junto con su
sintaxis sencilla, lo hacen un lenguaje fácil de leer y con el que se
pueden expresar muchas ideas con pocos caracteres.</p></li>
<li><p>Así que una implementación puede verse como una especificación, y
un lenguaje de programación puede usarse para escribir especificaciones
(combinándolo, posiblemente, con algo de lenguaje natural).</p></li>
<li><p>Aunque esto puede parecer raro en un principio, es algo que se
hace a menudo.</p></li>
<li><p>Las especificaciones escritas con un lenguaje de programación se
denominan <strong>especificaciones operacionales</strong>.</p></li>
</ul>
</section>


</section>
<section>
<section id="miembros-de-clase" class="title-slide slide level1"
data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span>
Miembros de clase</h1>

</section>
<section id="variables-de-clase" class="title-slide slide level2"
data-number="6.1">
<h2 data-number="6.1"><span class="header-section-number">6.1</span>
Variables de clase</h2>
<ul>
<li><p>Supogamos que el banco que guarda los depósitos paga intereses a
sus clientes en un porcentaje fijo sobre el saldo de sus
depósitos.</p></li>
<li><p>Ese porcentaje puede cambiar con el tiempo, pero es el mismo para
todos los depósitos.</p></li>
<li><p>Como es un valor compartido por todos los objetos de la misma
clase, se guardará en una variable local a la clase y, por tanto, se
almacenará como un atributo de la propia clase, no en una instancia
concreta de la clase.</p></li>
<li><p>Esas variables que pertenecen a la propia clase (en lugar de a
instancias concretas) se denominan <strong>variables de clase</strong> o
<strong>variables estáticas</strong>, a diferencia de las
<strong>variables de instancia</strong> que hemos estado usando hasta
ahora y que pertenecen a las instancias de la clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.1.0.0.1">

<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Las variables de clase se pueden crear y modificar mediante
<strong>sentencias de asignación</strong> directamente en el
<em>cuerpo</em> de la clase, fuera de cualquier definición de
método:</li>
</ul>
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    interes <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># Una variable de clase</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span></code></pre></div>
</div><div class="column" style="width:40%;">
<ul>
<li>Fuera de la clase, o dentro de un método de la clase, estas
variables también se pueden crear y manipular a través de una referencia
a la clase usando la sintaxis:</li>
</ul>
<p><em>clase</em><code>.</code><em>atributo</em></p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes <span class="op">=</span> <span class="fl">0.08</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.nueva <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.nueva</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div>
<ul>
<li>Esto nos indica que las variables de clase se almacenan en la propia
clase, es decir, en el objeto que representa a la clase.</li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="6.1.0.0.2">

<ul>
<li><p>Las variables de clase también se pueden acceder como cualquier
variable de instancia, a partir de una instancia de la clase:</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2 <span class="op">=</span> Deposito(<span class="dv">400</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes          <span class="co"># Accede al interés de la clase Deposito</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># También</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2.interes                <span class="co"># También</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes <span class="op">=</span> <span class="fl">0.08</span>   <span class="co"># Cambia la variable de clase</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span>                          <span class="co"># Se comprueba que ha cambiado</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># Cambia también para la instancia</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d2.interes                <span class="co"># Cambia para todas las instancias</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span></code></pre></div>
<p>Pero esta segunda forma no es conveniente, como ahora
veremos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.1.0.0.3">

<ul>
<li>Si intentamos cambiar el valor de una variable de clase desde una
instancia, lo que ocurre en realidad es que <strong>creamos una nueva
variable de instancia con el mismo nombre</strong> que la variable de
clase:</li>
</ul>
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1 <span class="op">=</span> Deposito(<span class="dv">100</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes <span class="op">=</span> <span class="fl">0.08</span>         <span class="co"># Crea una nueva variable de instancia</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> d1.interes                <span class="co"># Accede a la variable de instancia</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Deposito.interes          <span class="co"># Accede a la variable de clase</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02</span></span></code></pre></div>
<ul>
<li><p>Esto ocurre porque la variable de instancia se almacena en el
objeto, no en la clase, y al acceder desde el objeto tiene
preferencia.</p></li>
<li><p>Por ello, es conveniente acostumbrarse a usar siempre el nombre
de la clase para acceder y cambiar el valor de una variable de clase, en
lugar de hacerlo a través de una instancia.</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.1.0.0.4">

<ul>
<li>Para acceder al valor de una variable de clase dentro de un método,
aunque sea de la misma clase, usaremos la misma sintaxis
<em>clase</em><code>.</code><em>variable</em>, ya que de lo contrario la
variable no estará en el entorno:</li>
</ul>
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Deposito:</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    interes <span class="op">=</span> <span class="fl">0.02</span>   <span class="co"># Una variable de clase</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, fondos):</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">=</span> fondos</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retirar(<span class="va">self</span>, cantidad):</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cantidad <span class="op">&gt;</span> <span class="va">self</span>.fondos:</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Fondos insuficientes&#39;</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">-=</span> cantidad</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ingresar(<span class="va">self</span>, cantidad):</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fondos <span class="op">+=</span> cantidad</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> saldo(<span class="va">self</span>):</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.fondos</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> total(<span class="va">self</span>):</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accede a la variable de clase Deposito.interes para calcular</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># el saldo total más los intereses (no funciona si intentamos</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># poner interes en lugar de Deposito.interes):</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.saldo() <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> Deposito.interes)</span></code></pre></div>
</section>
<section id="ejercicios" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicios</h5>
<ol start="4" class="example" type="1">
<li><p>¿Qué ocurre si en el método <code>total</code> del código
anterior usamos <code class="sourceCode python">interes</code> en lugar
de <code>Deposito.interes</code>? ¿Por qué?</p></li>
<li><p>¿Qué problema puede haber si en el método <code>total</code> del
código anterior usamos <code
class="sourceCode python"><span class="va">self</span>.interes</code> en
lugar de <code>Deposito.interes</code>? ¿Por qué?</p></li>
</ol>
</section>

<section id="métodos-estáticos" class="title-slide slide level2"
data-number="6.2">
<h2 data-number="6.2"><span class="header-section-number">6.2</span>
Métodos estáticos</h2>
<ul>
<li><p>Los <strong>métodos estáticos</strong> son métodos definidos
dentro de una clase pero que <strong>no se ejecutan sobre ninguna
instancia</strong>.</p></li>
<li><p>Al no haber instancia, <strong>los métodos estáticos no reciben
ninguna instancia como argumento</strong> a través del primer parámetro
<code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
<li><p>En realidad, un método estático es básicamente <strong>una
función normal definida dentro de una clase</strong> y que está pensada
para ser ejecutada como cualquier otra función.</p></li>
<li><p>Por contraste, los métodos que se ejecutan sobre un objeto se
denominan <strong>métodos de instancia</strong>, para distinguirlos de
los estáticos.</p></li>
<li><p>Al estar definida dentro de la clase, para acceder a un método
estático desde fuera de la clase o desde un método de la propia clase,
hay que usar el operador punto (<code>.</code>) desde una referencia a
la clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.2.0.0.1">

<ul>
<li><p>Por ejemplo, supongamos una clase <code>Numero</code> que
representa números.</p>
<p>Una manera de implementarla sin métodos estáticos sería suponer que
cada instancia de la clase representa un número y que las operaciones
modifican ese número, recibiendo el resto de operandos mediante
argumentos:</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Numero:</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valor):</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(valor)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_valor(<span class="va">self</span>, valor):</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__valor <span class="op">=</span> valor</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_valor(<span class="va">self</span>):</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__valor</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(<span class="va">self</span>, otro):</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">+</span> otro)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(<span class="va">self</span>, otro):</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">*</span> otro)</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">7</span>)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n.get_valor())       <span class="co"># Imprime 11</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>n.mult(<span class="dv">5</span>)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n.get_valor())       <span class="co"># Imprime 55</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="6.2.0.0.2">

<ul>
<li><p>Para crear un método estático dentro de una clase:</p>
<ul>
<li><p>Se añade el <strong>decorador</strong> <code
class="sourceCode python"><span class="at">@staticmethod</span></code>
justo encima de la definición del método.</p></li>
<li><p>El método no debe recibir el parámetro <code
class="sourceCode python"><span class="va">self</span></code>.</p></li>
</ul></li>
<li><p>Sabiendo eso, podemos crear una clase <code>Calculadora</code>
que ni siquiera haría falta instanciar y que contendría las operaciones
a realizar con los números.</p></li>
<li><p>Esas operaciones serían métodos estáticos.</p></li>
<li><p>Al estar definidos dentro de la clase <code>Calculadora</code>,
para acceder a ellos habrá que usar el operador punto
(<code>.</code>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.2.0.0.3">

<ul>
<li><p>Tendríamos, por tanto:</p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Calculadora:</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(x, y):</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(x, y):</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">*</span> y</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Calculadora.suma(<span class="dv">4</span>, <span class="dv">7</span>)   <span class="co"># Llamamos al método suma directamente sobre la clase</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s)                     <span class="co"># Imprime 11</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> Calculadora.mult(<span class="dv">11</span>, <span class="dv">5</span>)  <span class="co"># Llamamos al método mult directamente sobre la clase</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m)                     <span class="co"># Imprime 55</span></span></code></pre></div></li>
<li><p>De este modo, los números no se modifican.</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.2.0.0.4">

<ul>
<li>Lo que hace básicamente el decorador <code
class="sourceCode python"><span class="at">@staticmethod</span></code>
es decirle al intérprete que se salte el mecanismo interno habitual de
pasar automáticamente una referencia del objeto como primer parámetro
del método (el que normalmente se llama <code
class="sourceCode python"><span class="va">self</span></code>).</li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo, con la clase <code>Numero</code>, si tenemos
que:</p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span></code></pre></div>
<p>es lo mismo hacer:</p>
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">5</span>)</span></code></pre></div>
<p>que hacer:</p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>Numero.suma(n, <span class="dv">5</span>)</span></code></pre></div>
<p>ya que <code>suma</code> es un método de instancia en la clase
<code>Numero</code>.</p>
<p>(Esta última forma no se usa nunca, ya que confunde al
lector.)</p></li>
</ul>
</div><div class="column">
<ul>
<li><p>En cambio, en la clase <code>Calculadora</code>, el método
<code>suma</code> es estático, no hay objeto <em>sobre</em> el que
actuar, así que no se pasa automáticamente ninguna referencia.</p></li>
<li><p>Todos los argumentos deben pasarse expresamente al método:</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Calculadora.suma(<span class="dv">4</span>, <span class="dv">3</span>)</span></code></pre></div></li>
<li><p>Como lo que se reciben son enteros y no instancias de
<code>Numero</code>, no los puede modificar.</p></li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="6.2.0.0.5">

<ul>
<li><p>Podemos combinar métodos estáticos y no estáticos en la misma
clase.</p></li>
<li><p>En tal caso, debemos recordar que los métodos estáticos de una
clase no pueden acceder a los miembros no estáticos de esa clase, ya que
no disponen de la referencia al objeto (<code
class="sourceCode python"><span class="va">self</span></code>).</p></li>
<li><p>En cambio, un método estático sí puede acceder a variables de
clase o a otros métodos estáticos (de la misma clase o de cualquier otra
clase) usando el operador punto (<code>.</code>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="6.2.0.0.6">

<div class="columns">
<div class="column" style="width:65%;">
<ul>
<li>Por ejemplo:</li>
</ul>
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Numero:</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, valor):</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(valor)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_valor(<span class="va">self</span>, valor):</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__valor <span class="op">=</span> valor</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_valor(<span class="va">self</span>):</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__valor</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma(<span class="va">self</span>, otro):</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">+</span> otro)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult(<span class="va">self</span>, otro):</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.set_valor(<span class="va">self</span>.get_valor() <span class="op">*</span> otro)</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> suma_es(x, y):</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mult_es(x, y):</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>        ret <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(y):</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Hay que poner «Numero.»:</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>            ret <span class="op">=</span> Numero.suma_es(ret, x)</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ret</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ret</span></code></pre></div>
</div><div class="column" style="width:35%;">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El número es 4:</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> Numero(<span class="dv">4</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora el número es 9:</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>n.suma(<span class="dv">5</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Devuelve 15:</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> Numero.suma_es(<span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Devuelve 56:</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> Numero.mult_es(<span class="dv">7</span>, <span class="dv">8</span>)</span></code></pre></div>
</div>
</div>
</section>
</section>
<section id="bibliografía"
class="title-slide slide level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Bibliografía</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-abelson_structure_1996" class="csl-entry"
role="doc-biblioentry">
Abelson, Harold, Gerald Jay Sussman, and Julie Sussman. 1996.
<em>Structure and Interpretation of Computer Programs</em>. 2nd ed.
Cambridge, Mass. : New York: MIT Press ; McGraw-Hill.
</div>
<div id="ref-denero_composing_nodate" class="csl-entry"
role="doc-biblioentry">
DeNero, John. n.d. <span>“Composing <span>Programs</span>.”</span> <a
href="http://www.composingprograms.com">http://www.composingprograms.com</a>.
</div>
<div id="ref-python_software_foundation_sitio_nodate" class="csl-entry"
role="doc-biblioentry">
Python Software Foundation. n.d. <span>“Sitio Web de Documentación de
<span>Python</span>.”</span> <a
href="https://docs.python.org/3">https://docs.python.org/3</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script src="./reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="./reveal.js/plugin/notes/notes.js"></script>
  <script src="./reveal.js/plugin/search/search.js"></script>
  <script src="./reveal.js/plugin/zoom/zoom.js"></script>
  <script src="./reveal.js/plugin/reveal.js-menu/menu.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 1080,
        // The display mode that will be used to show slides
        display: 'block',

        menu: {
          hideMissingTitles: true,
        },

        dependencies: [
          { src: './reveal.js/plugin/reveal.js-quiz/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, checkAnswerText: 'Comprueba la respuesta', nextQuestionText: 'Siguiente &raquo;', backButtonText: '&laquo; Anterior', tryAgainText: 'Prueba de nuevo', preventUnansweredText: 'Selecciona una respuesta', questionCountText: 'Pregunta %current de %total', skipStartButton: true}); } }
        ],

        // reveal.js plugins
        plugins: [
          RevealMenu,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
