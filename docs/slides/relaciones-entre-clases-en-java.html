<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Ricardo Pérez López">
  <title>Relaciones entre clases en Java</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="./reveal.js/dist/reset.css">
  <link rel="stylesheet" href="./reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #268bd2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #cb4b16; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #d33682; } /* BaseN */
    code span.bu { color: #4070a0; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #dc322f; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #93a1a1; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #6c71c4; } /* DataType */
    code span.dv { color: #d33682; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #d33682; } /* Float */
    code span.fu { color: #4070a0; } /* Function */
    code span.im { font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #268bd2; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #a57800; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #2aa198; } /* SpecialString */
    code span.st { color: #2aa198; } /* String */
    code span.va { color: #6c71c4; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="./reveal.js/dist/theme/solarized.css" id="theme">
  <link rel="stylesheet" href="custom.css"/>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
  <style type="text/css">
      #header-left {
          position: absolute;
          font-size: 25%;
          top: 0%;
          left: 0%;
          margin-left: 10px;
          margin-top: 10px;
      }
      #header-right {
          position: absolute;
          font-size: 25%;
          top: 0%;
          right: 0%;
          margin-right: 10px;
          margin-top: 10px;
      }
      #footer-left {
          position: absolute;
          font-size: 25%;
          bottom: 0%;
          left: 0%;
          margin-left: 10px;
          margin-bottom: 10px;
      }
  </style>
</head>
<body>
<div id="hidden" style="display:none;">
    <div id="header">
        <div id="header-left"></div>
        <div id="header-right"></div>
        <div id="footer-left"></div>
    </div>
</div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Relaciones entre clases en Java</h1>
  <p class="author">Ricardo Pérez López</p>
  <p class="date">IES Doñana, curso 2024/2025</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<ul>
<li><a href="#/asociaciones-básicas"
id="/toc-asociaciones-básicas"><span class="toc-section-number">1</span>
Asociaciones básicas</a></li>
<li><a href="#/generalización" id="/toc-generalización"><span
class="toc-section-number">2</span> Generalización</a></li>
<li><a href="#/polimorfismo" id="/toc-polimorfismo"><span
class="toc-section-number">3</span> Polimorfismo</a></li>
<li><a href="#/restricciones" id="/toc-restricciones"><span
class="toc-section-number">4</span> Restricciones</a></li>
</ul>
</nav>
</section>

<section>
<section id="asociaciones-básicas" class="title-slide slide level1"
data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span>
Asociaciones básicas</h1>

</section>
<section id="agregación" class="title-slide slide level2"
data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span>
Agregación</h2>
<ul>
<li><p>La <strong>agregación</strong> se consigue haciendo que el objeto
agregador contenga, entre sus variables de instancia, una referencia al
objeto agregado.</p></li>
<li><p>Para que sea agregación, la vida del objeto agregado
<strong>no</strong> debe depender necesariamente del objeto agregador;
es decir, que al destruirse el objeto agregador, eso no signifique que
se tenga que destruir también al objeto agregado.</p></li>
<li><p>Eso implica que puede haber en el programa varias referencias al
objeto agregado, no sólo la que almacena el agregador.</p></li>
<li><p>Lo habitual en la agregación es que la variable de instancia que
almacene la referencia al objeto agregado se asigne, o bien directamente
(si la variable tiene la suficiente visibilidad) o bien a través de un
método que reciba la referencia y se la asigne a la variable de
instancia.</p></li>
<li><p>Ese método puede ser (y suele ser) un constructor de la
clase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.1">

<ul>
<li><p>Ejemplo:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Agregador <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> Agregado ag<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="fu">Agregador</span><span class="op">(</span>Agregado ag<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">setAg</span><span class="op">(</span>ag<span class="op">);</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> Agregado <span class="fu">getAg</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ag<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setAg</span><span class="op">(</span>Agregado ag<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">ag</span> <span class="op">=</span> ag<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>En la agregación, es frecuente encontrarnos con métodos
<em>getter</em> y <em>setter</em> para la variable de instancia que hace
referencia al agregado.</p></li>
</ul>
</section>

<section id="composición" class="title-slide slide level2"
data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span>
Composición</h2>
<ul>
<li><p>La <strong>composición</strong> se consigue haciendo que el
objeto compuesto contenga, entre sus variables de instancia, una
referencia al objeto componente.</p></li>
<li><p>Para que sea composición, la vida del objeto componente
<strong>debe depender</strong> necesariamente del objeto compuesto; es
decir, que al destruirse el objeto compuesto, se debe destruir también
al objeto componente.</p></li>
<li><p>Eso implica que sólo puede haber en el programa una sola
referencia al objeto componente, que es la que almacena el objeto
compuesto.</p></li>
<li><p>Por eso, lo habitual en la composición es que el objeto compuesto
sea el responsable de crear al objeto componente.</p></li>
<li><p>Normalmente, no hay <em>setters</em> para el componente y, en
caso de haber <em>getters</em>, deberían devolver una copia del objeto
componente, y no el objeto componente original.</p></li>
</ul>
</section>
</section>
<section>
<section id="generalización" class="title-slide slide level1"
data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span>
Generalización</h1>

</section>
<section id="declaración" class="title-slide slide level2"
data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span>
Declaración</h2>
<ul>
<li><p>Java es un lenguaje con generalización simple, por lo que una
clase sólo puede ser subclase directa de una única superclase.</p></li>
<li><p>La relación de generalización directa entre dos clases se declara
en la propia definición de la subclase usando la cláusula <code
class="sourceCode java"><span class="kw">extends</span></code>:</p>
<div class="line-block"><span style="color:teal">⟨<em>clase</em>⟩</span>
::= [<strong><code>public</code></strong>]
[<strong><code>abstract</code></strong> |
<strong><code>final</code></strong>] <strong><code>class</code></strong>
<span style="color:teal">⟨<em>subclase</em>⟩</span>
[<strong><code>extends</code></strong> <span
style="color:teal">⟨<em>superclase</em>⟩</span>]
<strong><code>{</code></strong><br />
        <span style="color:teal">⟨<em>miembro_clase</em>⟩</span>*<br />
<strong><code>}</code></strong><br />
<span style="color:teal">⟨<em>superclase</em>⟩</span> ::= [<span
style="color:teal">⟨<em>paquete</em>⟩</span><strong><code>.</code></strong>]<strong><code>identificador</code></strong></div>
<p>donde <span style="color:teal">⟨<em>subclase</em>⟩</span> y <span
style="color:teal">⟨<em>superclase</em>⟩</span> son los nombres de la
subclase directa y la superclase directa, respectivamente.</p></li>
<li><p>En Java también se dice que la subclase
<strong><em>extiende</em></strong> a su superclase directa.</p></li>
<li><p>Cuando no se especifica la superclase directa a la hora de
definir una clase, el compilador sobreentiende que esa clase es subclase
directa de la clase <code
class="sourceCode java"><span class="bu">Object</span></code>.</p></li>
</ul>
</section>

<section id="subtipado-entre-tipos-referencia"
class="title-slide slide level2" data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span>
Subtipado entre tipos referencia</h2>
<ul>
<li><p>A partir de ese momento, se introduce en el sistema de tipos una
regla que dice que:</p>
<div class="centered">
<p><span style="color:teal">⟨<em>subclase</em>⟩</span> <span
class="math inline">&lt;_1</span> <span
style="color:teal">⟨<em>superclase</em>⟩</span> <!-- _1 --></p>
</div></li>
<li><p>Por tanto, se puede decir que el tipo definido por la subclase es
un subtipo del tipo definido por la superclase.</p></li>
<li><p>Esto va a permitir, entre otras cosas, el
<strong>polimorfismo</strong> entre la subclase y la
superclase.</p></li>
</ul>
</section>

<section id="herencia" class="title-slide slide level2"
data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span>
Herencia</h2>
<ul>
<li><p>Mediante el mecanismo de la herencia, una subclase hereda ciertos
miembros de sus superclases (directas o indirectas), dependiendo de la
visibilidad de esos miembros.</p></li>
<li><p>Los miembros con visibilidad <strong>privada</strong> no se
heredan.</p></li>
<li><p>Los miembros con visibilidad <strong>pública</strong> se heredan
siempre.</p></li>
<li><p>Los miembros con visibilidad <strong>predeterminada</strong> se
heredan si la subclase y la superclase pertenecen al mismo
paquete.</p></li>
<li><p>Los miembros con visibilidad <strong>protegida</strong> se
heredan siempre, aunque la subclase y la superclase pertenezcan a
paquetes distintos.</p></li>
</ul>
</section>

<section id="la-clase-object" class="title-slide slide level2"
data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span> La
clase <code>Object</code></h2>
<ul>
<li><p>La clase <code
class="sourceCode java"><span class="bu">Object</span></code> es la raíz
de la jerarquía de clases en Java.</p></li>
<li><p>Toda clase en Java es subclase (directa o indirecta) de <code
class="sourceCode java"><span class="bu">Object</span></code>.</p></li>
<li><p>Eso significa que todas las clases heredarán los métodos
definidos en <code
class="sourceCode java"><span class="bu">Object</span></code>.</p></li>
<li><p>Los más interesantes son <code
class="sourceCode java">equals</code>, <code
class="sourceCode java">hashCode</code> y <code
class="sourceCode java">toString</code>.</p></li>
<li><p>Más información en:</p>
<p><a
href="https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/lang/Object.html">https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/lang/Object.html</a></p></li>
</ul>
</section>

<section id="visibilidad-protegida" class="title-slide slide level2"
data-number="2.5">
<h2 data-number="2.5"><span class="header-section-number">2.5</span>
Visibilidad protegida</h2>
<ul>
<li><p>La visibilidad protegida está pensada para cuando queremos
limitar la visibilidad de un miembro de una clase a sus posibles
subclases.</p></li>
<li><p>Pero no debemos olvidar que, en Java, un miembro con visibilidad
protegida también puede ser accesible desde cualquier clase que
pertenezca al mismo paquete que la clase donde está declarado el
miembro.</p></li>
<li><p>Las variables protegidas de una clase son visibles para sus
subclases, pero sólo a través de objetos del tipo de la subclase o sus
subtipos.</p>
<p>En otras palabras, <strong>una subclase puede ver una variable
protegida de su superclase como una variable heredada, pero no puede
acceder a esa misma variable a través de una referencia a la propia
superclase</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.5.0.0.1">

<ul>
<li><p>Esto puede parecer un poco confuso al principio, ya que puede que
no resulte obvio que los modificadores de visibilidad no restringen el
acceso entre instancias de la misma clase de la misma manera que
restringen el acceso entre instancias de diferentes clases.</p></li>
<li><p><strong>Dos instancias de la misma clase pueden acceder a todos
los miembros de la otra, incluidos los privados, siempre que se acceda a
través de una referencia del tipo correcto</strong>.</p>
<p>Dicho de otra manera: dos instancias de <code>Gato</code> pueden
acceder a todas las variables y métodos de cada uno (incluidos los
privados), pero un <code>Gato</code> no puede acceder a un miembro
protegido de una instancia de <code>Animal</code> a menos que el
compilador pueda probar que el <code>Animal</code> es un
<code>Gato</code>.</p></li>
</ul>
</section>
</section>
<section>
<section id="polimorfismo" class="title-slide slide level1"
data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span>
Polimorfismo</h1>

</section>
<section id="el-principio-de-sustitución-de-liskov"
class="title-slide slide level2" data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span> El
principio de sustitución de Liskov</h2>
<ul>
<li><p>Recordemos que, por el principio de sustitución de Liskov, se
puede usar una instancia de una clase allí donde se espere una instancia
de una superclase suya:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span>   <span class="co">// Si «Derivada» es subclase de «Base»</span></span></code></pre></div>
<p>Eso hace que el tipo estático y el tipo dinámico de <code>b</code>
puedan no coincidir.</p></li>
<li><p>¿Qué ocurre si intentamos invocar un método sobre
<code>b</code>?</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">.</span><span class="fu">metodo</span><span class="op">();</span></span></code></pre></div></li>
<li><p>En un lenguaje de tipado estático como Java, el compilador
comprueba que el método que se quiere invocar sobre un objeto es
compatible con el tipo declarado (el tipo <em>estático</em>) para ese
objeto.</p></li>
<li><p>Eso quiere decir que el compilador tiene que determinar, en
tiempo de compilación, si un objeto de ese tipo puede responder a la
invocación de ese método.</p></li>
</ul>
</section>
<section id="ligadura-temprana-early-binding"
class="title-slide slide level3" data-number="3.1.1">
<h3 data-number="3.1.1"><span class="header-section-number">3.1.1</span>
Ligadura temprana (<em>early binding</em> )</h3>
<ul>
<li><p>Para comprobar si el método es compatible con el tipo del objeto
sobre el que se está invocando, el compilador hace un análisis estático
de la expresión de la invocación del método para determinar cuál es el
tipo estático del objeto sobre el que se invoca.</p></li>
<li><p>Eso significa que, en la invocación:</p>
<div class="centered">
<p><span style="color:teal">⟨<em>expr</em>⟩</span><code>.m()</code></p>
</div>
<p>el compilador determina el tipo de <span
style="color:teal">⟨<em>expr</em>⟩</span> en tiempo de compilación, y
comprueba si el método <code>m</code> es compatible con ese tipo.</p>
<p>Por ejemplo, si ese tipo es una clase, comprueba si esa clase posee
ese método (porque lo ha definido ella o porque lo ha heredado) y si es
accesible según las reglas de visibilidad.</p></li>
<li><p>Como esa comprobación se hace en tiempo de compilación y buscando
el tipo estático, al mecanismo de comprobación de la existencia del
método se le denomina <strong>ligadura temprana (<em>early
binding</em>)</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.1.0.1">

<ul>
<li><p>Ejemplos:</p>
<ul>
<li><p>Si se está invocando el método sobre una variable, el tipo será
el tipo estático de la variable:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Trabajador t<span class="op">;</span> <span class="co">// Declara la variable de tipo «Trabajador» (tipo estático)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="kw">new</span> <span class="fu">Docente</span><span class="op">();</span> <span class="co">// «t» contiene una referencia a un objeto</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>t<span class="op">.</span><span class="fu">despedir</span><span class="op">();</span> <span class="co">// El método «despedir» debe ser compatible con «Trabajador»</span></span></code></pre></div></li>
<li><p>Si se está invocando el método sobre una expresión más
complicada, el tipo será el tipo de esa expresión calculado por el
compilador en tiempo de compilación:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">// El método «despedir» debe ser compatible con «Docente», porque un</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">// docente es un trabajador:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="kw">new</span> <span class="fu">Docente</span><span class="op">()).</span><span class="fu">despedir</span><span class="op">();</span> </span></code></pre></div>
<p>Aquí, la expresión <code
class="sourceCode java"><span class="op">(</span><span class="kw">new</span> <span class="fu">Docente</span><span class="op">())</span></code>
tiene el tipo <code>Docente</code>, cosa que el compilador puede
calcular perfectamente.</p></li>
</ul></li>
</ul>
</section>


<section id="sobreescritura-de-métodos" class="title-slide slide level2"
data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span>
Sobreescritura de métodos</h2>
<ul>
<li><p>Los métodos heredados desde una superclase (siempre que no se
hayan marcado como <code
class="sourceCode java"><span class="dt">final</span></code>) se pueden
sobreescribir.</p></li>
<li><p><strong><em>Sobreescribir</em> o <em>redefinir</em> un método
heredado</strong> consiste en definir, en la subclase, un método (el
método que <em>sobreescribe</em> o que <em>redefine</em>) con el mismo
nombre y la misma lista de parámetros que el método heredado de la
superclase (el método <em>sobreescrito</em> o
<em>redefinido</em>).</p></li>
<li><p>El tipo de retorno del método que redefine tiene que ser
<em>compatible</em> con el tipo de retorno del método redefinido, cosa
que estudiaremos luego con más profundidad.</p>
<p>Por ahora sólo diremos que si dos tipos de retorno son iguales,
entonces son compatibles.</p></li>
<li><p>En Java, se recomienda (pero no es obligatorio) que el método que
redefine (el de la subclase) se defina usando el decorador <code
class="sourceCode java"><span class="at">@Override</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.1">

<ul>
<li><p>Ejemplo:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Base&quot;</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Derivada&quot;</span><span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section id="despacho-dinámico-dynamic-dispatch"
class="title-slide slide level3" data-number="3.2.1">
<h3 data-number="3.2.1"><span class="header-section-number">3.2.1</span>
Despacho dinámico (<em>dynamic dispatch</em> )</h3>
<ul>
<li><p>Al invocar un método sobre un objeto, <strong>el método concreto
que se ejecutará dependerá del <em>tipo dinámico</em> del objeto sobre
el que se invoca el método</strong>.</p></li>
<li><p>Por tanto, el método que acabará ejecutándose se elige en tiempo
de ejecución dependiendo del objeto que recibe el mensaje, es decir,
dependiendo del objeto sobre el que se está intentando invocar el
método.</p></li>
<li><p>A este mecanismo se le denomina <strong>despacho dinámico
(<em>dynamic dispatch</em>)</strong>.</p></li>
</ul>
<div class="caja">
<p><strong>Java implementa el despacho dinámico</strong> en todos los
métodos excepto en los <code
class="sourceCode java"><span class="kw">private</span></code>, <code
class="sourceCode java"><span class="dt">final</span></code> o <code
class="sourceCode java"><span class="dt">static</span></code>.</p>
</div>
</section>
<section id="ejemplo" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejemplo</h5>
<div class="sourceCode" id="cb7"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Base&quot;</span><span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Derivada&quot;</span><span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="bu">Principal</span> <span class="op">{</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        Base a <span class="op">=</span> <span class="kw">new</span> <span class="fu">Base</span><span class="op">();</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        Derivada b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        Base c <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        a<span class="op">.</span><span class="fu">hola</span><span class="op">(</span><span class="st">&quot;Pepe&quot;</span><span class="op">);</span>           <span class="co">// Invoca el «hola» de «Base»</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        b<span class="op">.</span><span class="fu">hola</span><span class="op">(</span><span class="st">&quot;Pepe&quot;</span><span class="op">);</span>           <span class="co">// Invoca el «hola» de «Derivada»</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        c<span class="op">.</span><span class="fu">hola</span><span class="op">(</span><span class="st">&quot;Pepe&quot;</span><span class="op">);</span>           <span class="co">// Invoca el «hola» de «Derivada»</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="columns">
<div class="column">
<ul>
<li>Imprime:</li>
</ul>
</div><div class="column">
<pre><code>Hola, Pepe, soy la clase Base
Hola, Pepe, soy la clase Derivada
Hola, Pepe, soy la clase Derivada</code></pre>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.1.0.1">

<ul>
<li><p>La <strong>ligadura temprana (<em>early binding</em>)</strong>
garantiza, <em>en tiempo de compilación</em>, que es seguro ejecutar el
método <code>hola</code> sobre los objetos que hay en las variables
<code>a</code>, <code>b</code> y <code>c</code>, ya que todas ellas
tienen un tipo estático compatible con la existencia de un método
<code>hola</code> (las clases <code>Base</code> y <code>Derivada</code>
disponen del método <code>hola</code>).</p></li>
<li><p>El <strong>despacho dinámico (<em>dynamic dispatch</em>)</strong>
selecciona, <em>en tiempo de ejecución</em>, el método concreto que se
ejecutará al invocar al método <code>hola</code> sobre los objetos que
hay en las variables <code>a</code>, <code>b</code> y <code>c</code>,
según el tipo dinámico del objeto que recibe el mensaje.</p>
<p>Por ejemplo:</p>
<ul>
<li><p>El objeto que hay en la variable <code>a</code> es una instancia
de <code>Base</code>, por lo que el método <code>hola</code> que se
ejecutará será el de <code>Base</code>.</p></li>
<li><p>El objeto que hay en la variable <code>c</code> es una instancia
de <code>Derivada</code>, por lo que el método <code>hola</code> que se
ejecutará será el de <code>Derivada</code>.</p></li>
</ul>
<p>Esto es así aunque ambas variables (<code>a</code> y <code>c</code>)
estén declaradas de tipo <code>Base</code>, porque lo que importa aquí
es el tipo dinámico, no el estático.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.1.0.2">

<ul>
<li><p>En el siguiente ejemplo, un método llama a otro. El método que se
ejecute dependerá del tipo dinámico del objeto sobre el que se
invoque:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode numberSource java number-lines"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">hola</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="fu">nombre</span><span class="op">());</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="op">}</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">nombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>        <span class="cf">return</span> <span class="st">&quot;Base&quot;</span><span class="op">;</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="op">}</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="op">}</span></span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="at">@Override</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">nombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>        <span class="cf">return</span> <span class="st">&quot;Derivada&quot;</span><span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="op">}</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="op">}</span></span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="kw">public</span> <span class="kw">class</span> <span class="bu">Principal</span> <span class="op">{</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>        Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>        b<span class="op">.</span><span class="fu">hola</span><span class="op">();</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>    <span class="op">}</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li>Imprime:</li>
</ul>
</div><div class="column">
<pre><code>Derivada</code></pre>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.1.0.3">

<ul>
<li><p>El motivo por el que el método <code>hola</code> imprime
<code>Derivada</code> y no <code>Base</code> es el siguiente:</p>
<ul>
<li><p>El método es invocado sobre un objeto de la clase
<code>Derivada</code>.</p></li>
<li><p>El método no está redefinido; tan sólo existe un método
<code>hola</code> y está en la clase <code>Base</code>.</p></li>
<li><p>Por tanto, dentro de ese método, la referencia <code
class="sourceCode java"><span class="kw">this</span></code> tiene el
tipo estático <code>Base</code>.</p></li>
<li><p>En cambio, en esa invocación concreta del método, <code
class="sourceCode java"><span class="kw">this</span></code> tiene el
tipo dinámico <code>Derivada</code>.</p></li>
<li><p>La sentencia de la línea 3 equivale a la siguiente (con el <code
class="sourceCode java"><span class="kw">this</span></code>):</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="kw">this</span><span class="op">.</span><span class="fu">nombre</span><span class="op">());</span></span></code></pre></div>
<p>en la que se invoca a <code>nombre</code> sobre un objeto cuyo tipo
dinámico es <code>Derivada</code>.</p></li>
<li><p>Por tanto, se acaba invocando al método <code>nombre</code> de
<code>Derivada</code>, que devuelve <code>Derivada</code>.</p></li>
</ul></li>
</ul>
</section>

<section id="sobreescritura-y-visibilidad"
class="title-slide slide level3" data-number="3.2.2">
<h3 data-number="3.2.2"><span class="header-section-number">3.2.2</span>
Sobreescritura y visibilidad</h3>
<ul>
<li><p><strong>La subclase no puede reducir la visibilidad del método
redefinido</strong>. Por tanto, el método que redefine debe tener, al
menos, la misma visibilidad que el método redefinido, pero nunca
menos.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Base&quot;</span><span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span>    <span class="co">// Error: reduce la visibilidad</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Derivada&quot;</span><span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Sí que se puede ampliar la visibilidad:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">hola</span><span class="op">(</span><span class="bu">String</span> s<span class="op">)</span> <span class="op">{</span>    <span class="co">// Esto sí se permite</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Hola, &quot;</span> <span class="op">+</span> s <span class="op">+</span> <span class="st">&quot;, soy la clase Derivada&quot;</span><span class="op">;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.2.0.1">

<ul>
<li><p>Esta restricción tiene sentido si recordamos que un dato de un
subtipo debe poder usarse en cualquier sitio donde se espere un dato de
un supertipo.</p></li>
<li><p>Por ejemplo, un <code>Mamífero</code> es una subclase de
<code>Animal</code> y, por tanto, debe poderse usar allí donde se espere
un <code>Animal</code>.</p>
<p>Es decir: un <code>Mamífero</code> es un
<code>Animal</code>.</p></li>
<li><p>Si pudiéramos sobreescribir un método con otro método menos
visible, entonces podríamos tener el problema de que el
<code>Mamífero</code> no podría ser capaz de hacer todo lo que puede
hacer un <code>Animal</code>.</p></li>
</ul>
</section>

<section id="sobreescritura-de-variables"
class="title-slide slide level3" data-number="3.2.3">
<h3 data-number="3.2.3"><span class="header-section-number">3.2.3</span>
Sobreescritura de variables</h3>
<ul>
<li><p>Las variables (de instancia o estáticas) de una clase se pueden
redefinir sin restricción alguna, simplemente declarando en la subclase
una variable con el mismo nombre que la variable heredada de una
superclase, sin importar el tipo.</p></li>
<li><p>Por tanto, las dos variables (la definida en la subclase y la
definida en la superclase) pueden tener el mismo nombre pero distinto
tipo.</p></li>
<li><p>Asimismo, las dos variables pueden tener cualquier visibilidad;
es decir, la visibilidad de ambas variables es independiente una de la
otra.</p></li>
<li><p>A todos los efectos, <strong>son variables completamente
diferentes</strong>.</p></li>
<li><p>Es como si la variable de la subclase <strong>hiciese
sombra</strong> a la de la superclase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.3.0.1">

<ul>
<li><p>Aquí, las dos variables de instancia <code>x</code> son distintas
e independientes:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">int</span> x<span class="op">;</span>                       <span class="co">// Esta es una variable...</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="bu">String</span> x<span class="op">;</span>                 <span class="co">// ... y esta es otra distinta</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getX</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">;</span>                       <span class="co">// Accede a la «x» de Derivada</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Base</span><span class="op">();</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        Derivada d <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        Base bd <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        b<span class="op">.</span><span class="fu">x</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span>                        <span class="co">// Accede a la «x» de Base</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="fu">x</span> <span class="op">=</span> <span class="st">&quot;Hola&quot;</span><span class="op">;</span>                   <span class="co">// Accede a la «x» de Derivada</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        bd<span class="op">.</span><span class="fu">x</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>                       <span class="co">// Accede a la «x» de Base</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">getX</span><span class="op">());</span>   <span class="co">// Imprime «Hola»</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li>Imprime:</li>
</ul>
</div><div class="column">
<pre><code>Hola</code></pre>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.3.0.2">

<ul>
<li>Con las variables no se hace <em>despacho dinámico</em>, sino
<em>ligadura temprana</em>. Por tanto, <strong>las variables se
resuelven en tiempo de compilación</strong>, lo que puede dar lugar a
resultados sorprendentes.</li>
</ul>
<div class="columns">
<div class="column">
<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> nombre <span class="op">=</span> <span class="st">&quot;Base&quot;</span><span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getNombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nombre<span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="bu">String</span> nombre <span class="op">=</span> <span class="st">&quot;Derivada&quot;</span><span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Base</span><span class="op">();</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        Derivada d <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        Base bd <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>b<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>bd<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</div><div class="column">
<ul>
<li><p>Imprime:</p>
<pre><code>Base
Base
Base</code></pre></li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.3.0.3">

<div class="columns">
<div class="column">
<ul>
<li><p>En cambio, si se redefine el método <code>getNombre</code>, el
resultado es distinto:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> nombre <span class="op">=</span> <span class="st">&quot;Base&quot;</span><span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getNombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nombre<span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="kw">extends</span> Base <span class="op">{</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="bu">String</span> nombre <span class="op">=</span> <span class="st">&quot;Derivada&quot;</span><span class="op">;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getNombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nombre<span class="op">;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Base</span><span class="op">();</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        Derivada d <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        Base bd <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>b<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>bd<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</div><div class="column">
<ul>
<li><p>Imprime:</p>
<pre><code>Base
Derivada
Derivada</code></pre></li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.3.0.4">

<ul>
<li><p>El motivo es que la ligadura temprana tiene en cuenta el
<strong>tipo estático</strong> de un objeto (no el dinámico) al resolver
una variable de instancia del objeto.</p></li>
<li><p>Recordemos que:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">getNombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nombre<span class="op">;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>equivale a:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">getNombre</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="fu">nombre</span><span class="op">;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>En el método <code>getNombre</code> de <code>Base</code>, la
referencia <code
class="sourceCode java"><span class="kw">this</span></code> tiene el
tipo estático <code>Base</code>. Por eso, el <code>getNombre</code> de
<code>Base</code> accede siempre al <code>nombre</code> de
<code>Base</code>.</p></li>
<li><p>En cambio, en el mismo método redefinido en
<code>Derivada</code>, la referencia <code
class="sourceCode java"><span class="kw">this</span></code> tiene el
tipo estático <code>Derivada</code>. Por eso, el <code>getNombre</code>
de <code>Derivada</code> accede siempre al <code>nombre</code> de
<code>Derivada</code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.3.0.5">

<ul>
<li><p>Por tanto, en el siguiente código:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Base b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Base</span><span class="op">();</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>Derivada d <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Base bd <span class="op">=</span> <span class="kw">new</span> <span class="fu">Derivada</span><span class="op">();</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>b<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span>  <span class="co">// Imprime «Base»</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span>  <span class="co">// Imprime «Derivada»</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>bd<span class="op">.</span><span class="fu">getNombre</span><span class="op">());</span> <span class="co">// Imprime «Derivada»</span></span></code></pre></div>
<p>tenemos que:</p>
<ul>
<li><p><code
class="sourceCode java">b<span class="op">.</span><span class="fu">getNombre</span><span class="op">()</span></code>
llama al método de <code>Base</code>, el cual accede al
<code>nombre</code> de <code>Base</code>.</p></li>
<li><p><code
class="sourceCode java">d<span class="op">.</span><span class="fu">getNombre</span><span class="op">()</span></code>
llama al método de <code>Derivada</code>, el cual accede al
<code>nombre</code> de <code>Derivada</code>.</p></li>
<li><p><code
class="sourceCode java">bd<span class="op">.</span><span class="fu">getNombre</span><span class="op">()</span></code>
llama al método de <code>Derivada</code>, el cual accede al
<code>nombre</code> de <code>Derivada</code>.</p></li>
</ul></li>
</ul>
</section>

<section id="super" class="title-slide slide level3"
data-number="3.2.4">
<h3 data-number="3.2.4"><span class="header-section-number">3.2.4</span>
<code>super</code></h3>
<ul>
<li><p>En Java, la palabra reservada <code
class="sourceCode java"><span class="kw">super</span></code> es una
variable especial que se puede usar dentro de una clase y que hace
referencia a un objeto de la superclase directa de la clase
actual.</p></li>
<li><p>Cuando se crea una instancia de una clase, automáticamente se
crea de forma implícita una instancia de su superclase directa, a la que
se tiene acceso a través de la variable <code
class="sourceCode java"><span class="kw">super</span></code>.</p></li>
<li><p>A través de esa variable, se puede invocar métodos de la
superclase directa o acceder a variables de instancia de la superclase
directa.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.4.0.1">

<ul>
<li><p>Acceder a una variable de instancia de la superclase directa:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">String</span> color <span class="op">=</span> <span class="st">&quot;blanco&quot;</span><span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Perro <span class="kw">extends</span> Animal <span class="op">{</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">String</span> color <span class="op">=</span> <span class="st">&quot;negro&quot;</span><span class="op">;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">imprimirColor</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>color<span class="op">);</span>       <span class="co">// imprime el color de Perro</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="kw">super</span><span class="op">.</span><span class="fu">color</span><span class="op">);</span> <span class="co">// imprime el color de Animal</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span> args<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        Perro p <span class="op">=</span> <span class="kw">new</span> <span class="fu">Perro</span><span class="op">();</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="fu">imprimirColor</span><span class="op">();</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Imprime:</p>
<pre><code>negro
blanco</code></pre></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.4.0.2">

<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><p>Ejecutar un método de instancia de la superclase directa:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">comer</span> <span class="op">()</span> <span class="op">{</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Comiendo...&quot;</span><span class="op">);</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Perro <span class="kw">extends</span> Animal <span class="op">{</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">comer</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Comiendo pan...&quot;</span><span class="op">);</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">ladrar</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Ladrando...&quot;</span><span class="op">);</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">hacer</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">super</span><span class="op">.</span><span class="fu">comer</span><span class="op">();</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ladrar</span><span class="op">();</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span> args<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        Perro p <span class="op">=</span> <span class="kw">new</span> <span class="fu">Perro</span><span class="op">();</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span><span class="fu">hacer</span><span class="op">();</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</div><div class="column" style="width:30%;">
<ul>
<li><p>Imprime:</p>
<pre><code>Comiendo...
Ladrando...</code></pre></li>
</ul>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.4.0.3">

<ul>
<li><p>Invocar al constructor de la superclase directa:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Animal</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Se ha creado un animal&quot;</span><span class="op">);</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Perro <span class="kw">extends</span> Animal <span class="op">{</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Perro</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">super</span><span class="op">();</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Se ha creado un perro&quot;</span><span class="op">);</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span> args<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        Perro p <span class="op">=</span> <span class="kw">new</span> <span class="fu">Perro</span><span class="op">();</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Imprime:</p>
<pre><code>Se ha creado un animal
Se ha creado un perro</code></pre></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.4.0.4">

<ul>
<li>El compilador introduce automáticamente una llamada a <code
class="sourceCode java"><span class="kw">super</span><span class="op">()</span></code>
como primera sentencia del constructor de la subclase si éste no incluye
ninguna llamada a <code
class="sourceCode java"><span class="kw">super</span><span class="op">()</span></code>
o <code
class="sourceCode java"><span class="kw">this</span><span class="op">()</span></code>:</li>
</ul>
<div class="columns">
<div class="column" style="width:33%;">
<div class="sourceCode" id="cb29"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bicicleta <span class="op">{</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Bicicleta</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">// sentencias</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div><div class="column" style="width:33%;">
<p>→ compilador →</p>
</div><div class="column" style="width:33%;">
<div class="sourceCode" id="cb30"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bicicleta <span class="op">{</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Bicicleta</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">super</span><span class="op">();</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">// sentencias</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<ul>
<li>Sabemos que, si una clase no tiene constructores, el compilador
introduce un constructor por defecto. En ese caso, ese constructor por
defecto también llamará a <code
class="sourceCode java"><span class="kw">super</span><span class="op">()</span></code>
como primera sentencia:</li>
</ul>
<div class="columns">
<div class="column" style="width:33%;">
<div class="sourceCode" id="cb31"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bicicleta <span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div><div class="column" style="width:33%;">
<p>→ compilador →</p>
</div><div class="column" style="width:33%;">
<div class="sourceCode" id="cb32"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bicicleta <span class="op">{</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Bicicleta</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">super</span><span class="op">();</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</section>
<section class="slide level5" data-number="3.2.4.0.5">

<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Animal <span class="op">{</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Animal</span><span class="op">(){</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Se ha creado un animal&quot;</span><span class="op">);</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Perro <span class="kw">extends</span> Animal <span class="op">{</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Perro</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Se ha creado un perro&quot;</span><span class="op">);</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Prueba <span class="op">{</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span> args<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        Perro p <span class="op">=</span> <span class="kw">new</span> <span class="fu">Perro</span><span class="op">();</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Imprime:</p>
<pre><code>Se ha creado un animal
Se ha creado un perro</code></pre></li>
</ul>
</section>

<section id="covarianza-en-el-tipo-de-retorno"
class="title-slide slide level3" data-number="3.2.5">
<h3 data-number="3.2.5"><span class="header-section-number">3.2.5</span>
Covarianza en el tipo de retorno</h3>
<ul>
<li><p>El tipo de retorno del método redefinido y del método que lo
redefine deben ser <strong>compatibles</strong>.</p></li>
<li><p>El objetivo a alcanzar es que sea seguro (desde el punto de vista
del sistema de tipos) usar un método con un determinado tipo de retorno
donde se espera usar un método con un tipo de retorno
diferente.</p></li>
<li><p>La teoría de tipos afirma que es seguro sustituir un método
<code>f</code> por otro método <code>g</code> si <code>f</code> devuelve
un valor de un tipo más general que <code>g</code>.</p></li>
<li><p>Por ejemplo, si tenemos que <code>Gato &lt;: Animal</code>, y hay
un método que devuelve un valor de tipo <code>Animal</code>, es seguro
sustituir ese método por otro que devuelva un valor de tipo
<code>Gato</code>.</p></li>
<li><p>Precisamente, lo que hace la sobreescritura de métodos es
sustituir un método por otro. Por tanto, es importante que esa
sustitución se haga de forma que resulte segura.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.1">

<ul>
<li><p>La compatibilidad entre el tipo de retorno de un método
redefinido y el de un método que lo redefine, se establece en Java por
medio de estas dos reglas:</p>
<ul>
<li><p>Si el tipo de retorno es un <strong>tipo primitivo</strong>, los
dos tipos de retorno deben ser <strong>el mismo</strong>.</p>
<p>Por ejemplo: si el tipo de retorno del método redefinido es <code
class="sourceCode java"><span class="dt">int</span></code>, el del
método que lo redefine también deberá ser <code
class="sourceCode java"><span class="dt">int</span></code>.</p></li>
<li><p>Si el tipo de retorno es un <strong>tipo referencia</strong>, el
tipo de retorno del método que redefine debe ser un
<strong>subtipo</strong> del tipo de retorno del método redefinido.</p>
<p>Por ejemplo: si el tipo de retorno del método redefinido es <code
class="sourceCode java"><span class="bu">Number</span></code>, el tipo
de retorno del método que lo redefine deberá ser un subtipo de <code
class="sourceCode java"><span class="bu">Number</span></code> (lo que
incluye al propio <code
class="sourceCode java"><span class="bu">Number</span></code>).</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.2">

<ul>
<li><p>Esto se puede resumir diciendo:</p>
<div class="caja">
<p>En Java, las clases son <strong>covariantes</strong> en el tipo de
retorno de sus métodos.</p>
</div></li>
<li><p>Es decir, que el tipo de retorno de los métodos puede cambiar en
la misma dirección que la subclase:</p>
<div class="centered">
<p><img data-src="images/herencia-retorno-covariante.svg" class="plain"
style="width:18.0%" /></p>
</div></li>
<li><p>En consecuencia, el tipo de un método redefinido puede
sustituirse en el método que lo redefine por otro tipo «más estrecho»,
es decir, por un subtipo del tipo original.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.3">

<ul>
<li><p>Es importante recordar que la covarianza sólo está permitida
entre tipos referencia, no entre tipos primitivos.</p></li>
<li><p>Más formalmente, supongamos que <code>S</code> y <code>T</code>
son dos clases que cumplen que <code>S</code> <code>&lt;:</code>
<code>T</code> y, además, ambas clases definen un método <code>m</code>
(definido en <code>T</code> y redefinido en <code>S</code>) de forma
que:</p>
<ul>
<li><p>El tipo de retorno de <code>m</code> en <code>S</code> es <span
class="math inline">R1</span>.</p></li>
<li><p>El tipo de retorno de <code>m</code> en <code>T</code> es <span
class="math inline">R2</span>.</p></li>
</ul>
<p>En tal caso, decimos que un lenguaje de programación orientado a
objetos es <strong>covariante en el tipo de retorno</strong> si se tiene
que cumplir que <span class="math inline">R1</span> <code>&lt;:</code>
<span class="math inline">R2</span>.</p></li>
<li><p>Esta regla garantiza seguridad en el tipo del método cuando se
invoca el método redefinido sobre instancias de la subclase.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.4">

<ul>
<li><p>En general, la covarianza es una propiedad que puede tener un
tipo compuesto por otros tipos.</p></li>
<li><p>Sean <span class="math inline">A</span> y <span
class="math inline">B</span> dos tipos en un sistema de tipos, y sean
<span class="math inline">T\!{\langle}A{\rangle}</span> y <span
class="math inline">T\!{\langle}B{\rangle}</span> dos tipos construidos
sobre <span class="math inline">A</span> y <span
class="math inline">B</span>, respectivamente. Si <span
class="math inline">A</span> <code>&lt;:</code> <span
class="math inline">B</span>, se dice que:</p>
<ul>
<li><p><span class="math inline">T</span> es <strong>covariante</strong>
si <span class="math inline">T\!{\langle}A{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">T\!{\langle}B{\rangle}</span>.</p></li>
<li><p><span class="math inline">T</span> es
<strong>contravariante</strong> si <span
class="math inline">T\!{\langle}B{\rangle}</span> <code>&lt;:</code>
<span class="math inline">T\!{\langle}A{\rangle}</span>.</p></li>
<li><p><span class="math inline">T</span> es <strong>invariante</strong>
si no es covariante ni contravariante.</p></li>
</ul></li>
<li><p>En este contexto, a <span class="math inline">T</span> se le
considera un <strong>constructor de tipos</strong>.</p></li>
<li><p>Nótese que si <span class="math inline">T</span> se construye con
más de un parámetro, puede ser covariante o contravariante de forma
indistinta en cada uno de ellos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.5">

<ul>
<li><p>Por ejemplo, los <em>arrays</em> en Java son tipos compuestos de
otro tipo, que es el tipo de los elementos que contiene el
<em>array</em>.</p>
<ul>
<li><p>«<em>Array</em> de enteros» (<code
class="sourceCode java"><span class="dt">int</span><span class="op">[]</span></code>)
es un tipo construido a partir del tipo <code
class="sourceCode java"><span class="dt">int</span></code>.</p></li>
<li><p>«<em>Array</em> de cadenas» (<code
class="sourceCode java"><span class="bu">String</span><span class="op">[]</span></code>)
es otro tipo construido a partir del tipo <code
class="sourceCode java"><span class="bu">String</span></code>.</p></li>
</ul></li>
<li><p>Los <em>arrays</em> en Java son covariantes, lo que significa que
si <span class="math inline">A</span> <code>&lt;:</code> <span
class="math inline">B</span>, entonces <span
class="math inline">A</span><code>[]</code> <code>&lt;:</code> <span
class="math inline">B</span><code>[]</code>.</p>
<p>Por ejemplo, como sabemos que <code
class="sourceCode java"><span class="bu">String</span></code>
<code>&lt;:</code> <code
class="sourceCode java"><span class="bu">Object</span></code>, eso
significa que <code
class="sourceCode java"><span class="bu">String</span></code><code>[]</code>
<code>&lt;:</code> <code
class="sourceCode java"><span class="bu">Object</span></code><code>[]</code>.</p>
<p>Es decir: allí donde se espera un <em>array</em> de <code
class="sourceCode java"><span class="bu">Object</span></code>, se puede
poner un <em>array</em> de <code
class="sourceCode java"><span class="bu">String</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.6">

<ul>
<li><p>El tipo que representa la signatura de un método se puede
escribir como <span
class="math inline">S{\langle}\overline{P},R{\rangle}</span>, donde:</p>
<ul>
<li><p><span class="math inline">\overline{P}</span> representa la tupla
de todos los tipos que aparecen en la lista de parámetros, en el orden
en el que aparecen.</p></li>
<li><p><span class="math inline">R</span> representa el tipo de retorno
del método.</p></li>
</ul></li>
<li><p>Podemos decir que si un método <code>f</code> tiene la signatura
<span class="math inline">S{\langle}\overline{P},R_1{\rangle}</span> y
otro método <code>g</code> tiene la signatura <span
class="math inline">S{\langle}\overline{P},R_2{\rangle}</span>, siempre
se debe cumplir que:</p>
<div class="centered">
<p>Si <span class="math inline">R_1</span> <code>&lt;:</code> <span
class="math inline">R_2</span>, entonces <span
class="math inline">S{\langle}\overline{P},R_1{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">S{\langle}\overline{P},R_2{\rangle}</span>.</p>
</div></li>
<li><p>O, dicho de otra forma: es seguro (desde el punto de vista del
sistema de tipos) sustituir el método <code>g</code> por el método
<code>f</code> ya que el tipo de retorno de <code>f</code> es un subtipo
de el de <code>g</code>.</p>
<p>Este es un resultado bien conocido de la teoría de tipos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.5.0.7">

<ul>
<li><p>El tipo de una clase <code>T</code> (que indicaremos como <span
class="math inline">T</span>) puede interpretarse como un tipo compuesto
por los tipos de sus miembros, incluyendo los de sus métodos.</p></li>
<li><p>Si la clase <code>T</code> tiene un método <code>m</code> con
signatura <span
class="math inline">S{\langle}\overline{P},R{\rangle}</span>, el tipo de
la clase lo podemos representar como <span
class="math inline">T\!{\langle}S{\langle}\overline{P},R{\rangle}{\rangle}</span>.</p>
<p>En ese caso, decimos que:</p>
<div class="centered">
<p><span
class="math inline">T\!{\langle}S{\langle}\overline{P},R_1{\rangle}{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">T\!{\langle}S{\langle}\overline{P},R_2{\rangle}{\rangle}</span> 
si  <span class="math inline">S{\langle}\overline{P},R_1{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">S{\langle}\overline{P},R_2{\rangle}</span></p>
</div>
<p>Pero:</p>
<div class="centered">
<p><span class="math inline">S{\langle}\overline{P},R_1{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">S{\langle}\overline{P},R_2{\rangle}</span>  si 
<span class="math inline">R_1</span> <code>&lt;:</code> <span
class="math inline">R_2</span></p>
</div>
<p>Por tanto:</p>
<div class="centered">
<p><span
class="math inline">T\!{\langle}S{\langle}\overline{P},R_1{\rangle}{\rangle}</span>
<code>&lt;:</code> <span
class="math inline">T\!{\langle}S{\langle}\overline{P},R_2{\rangle}{\rangle}</span> 
si  <span class="math inline">R_1</span> <code>&lt;:</code> <span
class="math inline">R_2</span></p>
</div></li>
<li><p>Es decir: una clase <code>A</code> es subtipo de otra clase
<code>B</code> si ambas tienen el mismo método pero el tipo de retorno
del método en <code>A</code> es subtipo del tipo de retorno del mismo
método en <code>B</code>.</p></li>
<li><p>Esa es precisamente la definición de <strong>covarianza</strong>:
un tipo compuesto es covariante cuando cumple la condición
anterior.</p></li>
</ul>
</section>

<section id="invarianza-en-el-tipo-de-los-argumentos"
class="title-slide slide level3" data-number="3.2.6">
<h3 data-number="3.2.6"><span class="header-section-number">3.2.6</span>
Invarianza en el tipo de los argumentos</h3>
<ul>
<li><p>Los tipos de los parámetros del método redefinido deben coincidir
exactamente con los tipos de los parámetros del método que lo redefine,
lo que se puede resumir diciendo:</p>
<div class="caja">
<p>En Java, las clases son <strong>invariantes</strong> en los tipos de
los parámetros de sus métodos.</p>
</div></li>
<li><p>Si los tipos de los parámetros no son idénticos, entonces lo que
se está haciendo es una sobrecarga en lugar de una
redefinición.</p></li>
<li><p>Por eso siempre es conveniente usar el decorador <code
class="sourceCode java"><span class="at">@Override</span></code> para
asegurarse de que no está ocurriendo ésto accidentalmente.</p></li>
</ul>
</section>

<section id="sobreescritura-de-equals" class="title-slide slide level3"
data-number="3.2.7">
<h3 data-number="3.2.7"><span class="header-section-number">3.2.7</span>
Sobreescritura de <code>equals</code></h3>
<ul>
<li><p>El método <code class="sourceCode java">equals</code> nos permite
comparar dos objetos para ver si son iguales.</p></li>
<li><p>Ese método está definido en la clase <code
class="sourceCode java"><span class="bu">Object</span></code> y, por
tanto, todos los objetos de cualquier clase en Java dispone de ese
método.</p></li>
<li><p>Muchas clases de la librería de Java redefinen ese método para
crear su propia versión del concepto de <em>igualdad</em>.</p></li>
<li><p>De la misma forma, lo normal es que las clases definidas por el
programador implementen su propia versión del método <code
class="sourceCode java">equals</code>, redefiniendo el que heredan de su
superclase.</p></li>
<li><p>Así, los objetos de una clase definida por el programador se
podrán comparar entre sí y con otros objetos de otras clases.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.1">

<ul>
<li><p>La definición que hace la clase <code
class="sourceCode java"><span class="bu">Object</span></code> del método
<code class="sourceCode java">equals</code> sólo compara referencias,
por lo que es equivalente a la siguiente:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">equals</span><span class="op">(</span><span class="bu">Object</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span> <span class="op">==</span> obj<span class="op">;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Esto significa que, de entrada, dos objetos son iguales
únicamente si son <em>idénticos</em> (es decir, si son el mismo
objeto).</p></li>
<li><p>En general, esta implementación no es conveniente y habría que
redefinirla adecuadamente en cada caso.</p></li>
<li><p>Lo habitual es comparar el valor de algunos campos de los dos
objetos.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.2">

<ul>
<li><p>Por ejemplo, supongamos una clase <code>Persona</code> con tres
campos:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> nombre<span class="op">;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> apellidos<span class="op">;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">int</span> edad<span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constructores, getters y setters</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Tenemos dos objetos que básicamente representan a la misma
persona (es decir, que son lógicamente equivalentes):</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Persona p1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Persona p2 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span></span></code></pre></div></li>
<li><p>En cambio, el método <code class="sourceCode java">equals</code>
considera que son diferentes ya que compara diferencias en lugar del
valor de sus campos:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p1<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>p2<span class="op">));</span> <span class="co">// false</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.3">

<ul>
<li><p>Existen varias condiciones que el método <code
class="sourceCode java">equals</code> debe garantizar, y que están
recogidas en la documentación de la clase <code
class="sourceCode java"><span class="bu">Object</span></code>.</p>
<p>Suponiendo que <code>x</code>, <code>y</code> y <code>z</code> son
valores referencia no nulas, siempre se tiene que cumplir:</p>
<ul>
<li><p><strong>Reflexividad</strong>: <code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>x<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code>.</p></li>
<li><p><strong>Simetría</strong>: <code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>y<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code> si y sólo si
<code
class="sourceCode java">y<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>x<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code>.</p></li>
<li><p><strong>Transitividad</strong>: si <code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>y<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code> e <code
class="sourceCode java">y<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>z<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code>, entonces
<code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>z<span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">true</span></code>.</p></li>
<li><p><strong>Consistencia</strong>: si invocamos varias veces <code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>y<span class="op">)</span></code>,
debe devolver consistentemente <code
class="sourceCode java"><span class="kw">true</span></code> o <code
class="sourceCode java"><span class="kw">false</span></code>, suponiendo
que no se ha modificado ninguna información usada en la comparación de
igualdad de los objetos.</p></li>
<li><p><strong>No nulidad</strong>: <code
class="sourceCode java">x<span class="op">.</span><span class="fu">equals</span><span class="op">(</span><span class="kw">null</span><span class="op">)</span></code>
<code>==</code> <code
class="sourceCode java"><span class="kw">false</span></code>.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.4">

<ul>
<li><p>Para crear un método que satisfaga las condiciones anteriores,
primero hay que seleccionar los campos que se van a comparar.</p></li>
<li><p>Luego, hay que realizar estos tres pasos en el método <code
class="sourceCode java">equals</code>:</p>
<ol>
<li><p>Si <code
class="sourceCode java"><span class="kw">this</span></code> y la
referencia del otro objeto son iguales, los objetos son iguales; en otro
caso, ir al paso 2.</p></li>
<li><p>Si la otra referencia es <code
class="sourceCode java"><span class="kw">null</span></code> o no tiene
el tipo adecuado, los objetos son distintos; en otro caso, ir al paso
3.</p></li>
<li><p>Si todos los campos seleccionados son iguales, los objetos son
iguales; en otro caso, son distintos.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.5">

<ul>
<li><p>Un patrón típico sería el siguiente, suponiendo que queremos
redefinir el método <code class="sourceCode java">equals</code> en la
clase <code>MiClase</code>:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">equals</span><span class="op">(</span><span class="bu">Object</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si son idénticos, son iguales:</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// No es igual a una referencia nula:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>obj <span class="op">==</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si las clases no coinciden, los objetos no son iguales:</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="fu">getClass</span><span class="op">()</span> <span class="op">!=</span> obj<span class="op">.</span><span class="fu">getClass</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Desde aquí, ya es seguro hacer el casting a MiClase:</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    MiClase otro <span class="op">=</span> <span class="op">(</span>MiClase<span class="op">)</span> obj<span class="op">;</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Aquí ya se compararían los valores de los campos:</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> campo1 <span class="op">==</span> otro<span class="op">.</span><span class="fu">campo1</span> <span class="op">&amp;&amp;</span> campo2 <span class="op">==</span> otro<span class="op">.</span><span class="fu">campo2</span> <span class="op">&amp;&amp;</span> <span class="kw">...</span><span class="op">;</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.6">

<ul>
<li><p>La condición de que las clases de los dos objetos tienen que
coincidir, a veces puede resultar demasiado fuerte y se podría
relajar.</p>
<p>Por ejemplo, se podría permitir que una clase sea subclase de la
otra:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(!(</span>obj <span class="kw">instanceof</span> MiClase<span class="op">))</span> <span class="op">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Pero para eso, es necesario que los campos que se usen para comparar
los objetos sean accesibles y no se hayan redefinido por otras distintas
(en este último caso, se usarían las variables originales, sin
redefinir).</p></li>
<li><p>Además, el operador <code
class="sourceCode java"><span class="kw">instanceof</span></code> tiene
la ventaja de que también comprueba si es una referencia nula.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.7">

<ul>
<li><p>En el ejemplo de la <code>Persona</code>, se podría hacer lo
siguiente:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Persona <span class="op">{</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> nombre<span class="op">;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> apellidos<span class="op">;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">int</span> edad<span class="op">;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// constructores, getters and setters</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">equals</span><span class="op">(</span><span class="bu">Object</span> otro<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Comprueba si son el mismo objeto:</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> otro<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Comprueba si el otro es una Persona y no nula:</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!(</span>otro <span class="kw">instanceof</span> Persona<span class="op">))</span> <span class="op">{</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Desde aquí, ya es seguro hacer el casting a Persona:</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        Persona persona <span class="op">=</span> <span class="op">(</span>Persona<span class="op">)</span> otro<span class="op">;</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Compara todos los campos necesarios:</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> edad <span class="op">==</span> persona<span class="op">.</span><span class="fu">edad</span> <span class="op">&amp;&amp;</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>               Objects<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>nombre<span class="op">,</span> persona<span class="op">.</span><span class="fu">nombre</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>               Objects<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>apellidos<span class="op">,</span> persona<span class="op">.</span><span class="fu">apellidos</span><span class="op">);</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.8">

<ul>
<li><p>En el ejemplo anterior hemos usado el método <code
class="sourceCode java">java<span class="op">.</span><span class="fu">util</span><span class="op">.</span><span class="fu">Objects</span><span class="op">.</span><span class="fu">equals</span></code>
(o, dicho de otra forma, el método <code
class="sourceCode java">equals</code> de la clase <code
class="sourceCode java">Objects</code> del paquete <code
class="sourceCode java">java<span class="op">.</span><span class="fu">util</span></code>)
para comprobar si dos cadenas son iguales, lo que nos previente de
posibles errores de <code
class="sourceCode java"><span class="bu">NullPointerException</span></code>.</p></li>
<li><p>Aquí comparamos la igualdad de tres objetos. Dos de ellos
corresponden a la misma persona:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Persona p1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span>     <span class="co">// una persona</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Persona p2 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span>     <span class="co">// la misma persona</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>Persona p3 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;María&quot;</span><span class="op">,</span> <span class="st">&quot;González&quot;</span><span class="op">,</span> <span class="dv">30</span><span class="op">);</span> <span class="co">// otra persona</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p1<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>p2<span class="op">));</span> <span class="co">// true</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p2<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>p3<span class="op">));</span> <span class="co">// false</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p3<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>p3<span class="op">));</span> <span class="co">// true (reflexividad)</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.7.0.9">

<ul>
<li><p>En Python, la identidad de un objeto se representa mediante un
número entero que se puede obtener a través de la función <code
class="sourceCode python"><span class="bu">id</span></code> y que
identifica y distingue a los objetos entre sí, de forma que dos objetos
tienen siempre distintos valores de <code
class="sourceCode python"><span class="bu">id</span></code>.</p></li>
<li><p>En Java no existe una función que devuelva la identidad de un
objeto.</p></li>
<li><p>Lo más parecido a la función <code
class="sourceCode python"><span class="bu">id</span></code> en Java es
el método <code class="sourceCode java">hashCode</code> definido en la
clase <code
class="sourceCode java"><span class="bu">Object</span></code>.</p></li>
<li><p>Ya sabemos que el <code class="sourceCode java">hashCode</code>
de un objeto en Java es el equivalente al <code
class="sourceCode python"><span class="bu">hash</span></code> de Python
y, por tanto, no se corresponde exactamente con el concepto de
<em>identidad</em>.</p></li>
<li><p>Pero la implementación que hace la clase <code
class="sourceCode java"><span class="bu">Object</span></code> del método
<code class="sourceCode java">hashCode</code> garantiza que el valor que
devuelve es distinto para cada objeto, ya que se calcula a partir de la
dirección de memoria donde está almacenado el objeto.</p></li>
<li><p>El problema está cuando tenemos que redefinir el método <code
class="sourceCode java">hashCode</code> en nuestras propias
clases.</p></li>
</ul>
</section>

<section id="sobreescritura-de-hashcode"
class="title-slide slide level3" data-number="3.2.8">
<h3 data-number="3.2.8"><span class="header-section-number">3.2.8</span>
Sobreescritura de <code>hashCode</code></h3>
<ul>
<li><p>Si se redefine el método <code
class="sourceCode java">equals</code>, es una buena práctica redefinir
también el método <code
class="sourceCode java">hashCode</code>.</p></li>
<li><p>De no hacerlo, la clase podría no funcionar correctamente al
almacenarse en colecciones (como <code
class="sourceCode java"><span class="bu">HashMap</span></code>, <code
class="sourceCode java"><span class="bu">HashSet</span></code> o <code
class="sourceCode java"><span class="bu">Hashtable</span></code>) que
usen mecanismos de <em>hashing</em> para acceder a los
elementos.</p></li>
<li><p>Estas colecciones, salvo algunas diferencias, almacenan los datos
en «<em>cajones</em>» (del inglés, <em>buckets</em>) de la siguiente
forma:</p>
<div class="centered">
<p><img data-src="images/cajones.svg" class="plain"
style="width:80.0%" /></p>
</div></li>
<li><p>Cuando se quiere guardar un objeto <code>o</code> en una
colección de este tipo, se invoca a <code>o.hashCode()</code>, lo que
devolverá un número entero que la colección usará para decidir en qué
cajón guardará ese objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.1">

<ul>
<li><p>El cajón concreto que se usará viene dado por la expresión
<code>(o.hashCode()</code>  <code>%</code>  <span
class="math inline">N</span><code>)</code>, siendo <span
class="math inline">N</span> el número de cajones de la
colección.</p></li>
<li><p>Por tanto, todos los objetos que tengan el mismo valor de
<code>hashCode()</code> se almacenarán en el mismo cajón.</p></li>
<li><p>Si se quiere recuperar el objeto que se guardó, se llama de nuevo
al método <code class="sourceCode java">hashCode</code> para determinar
en qué cajón debe estar el objeto.</p></li>
<li><p>El objetivo de guardar los datos de esta forma es lograr
almacenar y recuperar información en tiempo constante (lo cuál no ocurre
siempre, pero se acerca).</p></li>
<li><p>Para ello, hay que procurar que al guardar los elementos en la
colección, estos queden dispersos de forma uniforme en toda la
colección, de manera que queden la menor cantidad de cajones vacíos y
que no haya cajones donde se guarden muchos más elementos que
otros.</p></li>
<li><p>El que no suceda esto depende, casi siempre, del valor que
devuelva el método <code class="sourceCode java">hashCode</code> para
cada objeto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.2">

<ul>
<li><p>Cuando quiera recuperar un objeto, habrá que tener en cuenta que
puede haber varios objetos en el mismo cajón.</p></li>
<li><p>Por eso, una vez que se ha decidido en qué cajón hay que mirar,
se usa el método <code class="sourceCode java">equals</code> para
encontrar el objeto deseado dentro del cajón, mirando uno por uno y de
forma secuencial.</p>
<p>Esta nos da una pista de que los métodos <code
class="sourceCode java">equals</code> y <code
class="sourceCode java">hashCode</code> deben estar coordinados entre
sí.</p></li>
<li><p>Por ejemplo, supongamos que guardamos tres objetos en esta
estructura, y el método <code class="sourceCode java">hashCode</code> de
los tres objetos devuelve <code
class="sourceCode java"><span class="dv">0</span></code>.</p>
<p>Esto quiere decir que los tres objetos se gurdarán en el cajón <code
class="sourceCode java"><span class="dv">0</span></code>.</p></li>
<li><p>Cuando quiera recuperarlos, tendré que recorrer de forma
secuencial el cajón <code
class="sourceCode java"><span class="dv">0</span></code> e ir mirando
uno a uno todos los objetos que hay guardados en este cajón para acceder
al que quiero.</p>
<p>El acceso pasa de ser <strong>directo</strong> a ser
<strong>secuencial</strong>, que es mucho más lento.</p></li>
<li><p>Por lo tanto, ese método <code
class="sourceCode java">hashCode</code> no es útil.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.3">

<ul>
<li><p>El método <code class="sourceCode java">hashCode</code> debe
cumplir tres condiciones (o, al menos, las dos primeras):</p>
<ol>
<li><p>El <code class="sourceCode java">hashCode</code> de un objeto no
debería cambiar nunca durante la ejecución de un programa.</p></li>
<li><p>Si <span class="math inline">a</span><code>.equals(</code><span
class="math inline">b</span><code>)</code>, entonces <span
class="math inline">a</span><code>.hashCode()</code> <code>==</code>
<span class="math inline">b</span><code>.hashCode()</code>.</p></li>
<li><p>(<em>Opcional</em>) Dos objetos distintos deberían devolver un
<code class="sourceCode java">hashCode</code> distinto, pero tampoco es
estrictamente necesario.</p>
<p>Cuando tenemos dos objetos distintos que tienen el mismo <code
class="sourceCode java">hashCode</code>, decimos que se ha producido una
<strong>colisión</strong> y, aunque en general resultan inevitables,
tenemos que tratar de minimizarlas para optimizar el rendimiento de las
colecciones basadas en <em>hashing</em>.</p></li>
</ol></li>
<li><p>Vamos a ver cada condición con más detalle.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.4">

<ol>
<li><p>Siempre que se invoque en el mismo objeto más de una vez durante
la ejecución de una aplicación Java, el <code
class="sourceCode java">hashCode</code> debe devolver constantemente el
mismo número entero, mientras no se modifique ningún dato usado por
<code class="sourceCode java">equals</code> para comparar un objeto con
otro:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">hashCode</span><span class="op">();</span> <span class="co">// 400000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">hashCode</span><span class="op">();</span> <span class="co">// 400000 (bien)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">hashCode</span><span class="op">();</span> <span class="co">// 500000 (mal)</span></span></code></pre></div>
<p>Este número entero no tiene por qué permanecer igual de una ejecución
a otra de la misma aplicación.</p></li>
<li><p>Si dos objetos son iguales según el <code
class="sourceCode java">equals</code>, entonces al llamar al <code
class="sourceCode java">hashCode</code> sobre cada uno de los dos
objetos se debe producir el mismo resultado entero:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>persona2<span class="op">);</span> <span class="co">// true</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">hashCode</span><span class="op">()</span> <span class="op">==</span> persona2<span class="op">.</span><span class="fu">hashCode</span><span class="op">();</span> <span class="co">// false (mal, debe ser true)</span></span></code></pre></div></li>
<li><p>No es necesario que dos objetos no iguales devuelvan <code
class="sourceCode java">hashCode</code>s distintos, pero hacerlo mejora
el rendimiento de algunas colecciones:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>person3<span class="op">);</span> <span class="co">// false</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>persona1<span class="op">.</span><span class="fu">hashCode</span><span class="op">()</span> <span class="op">==</span> persona3<span class="op">.</span><span class="fu">hashCode</span><span class="op">();</span> <span class="co">// true (se permite)</span></span></code></pre></div></li>
</ol>
</section>
<section class="slide level5" data-number="3.2.8.0.5">

<ul>
<li><p>La implementación más simple del método <code
class="sourceCode java">hashCode</code> puede ser algo parecido a
ésto:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Override</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">hashCode</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Siempre devuelve el mismo valor y satisface las condiciones
obligatorias 1 y 2, aunque no satisface la condición opcional
3.</p></li>
<li><p>Por desgracia, este método es muy ineficiente ya que degrada
totalmente los beneficios que proporcionan las colecciones basadas en
<em>hashing</em>, puesto que provoca que todos los objetos se almacenen
en el mismo cajón de la colección.</p></li>
<li><p>Una buena función de <em>hashing</em> tiende a generar diferentes
valores <em>hash</em> para objetos que no son iguales, haciendo que los
objetos se repartan de manera uniforme entre todos los cajones de la
colección.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.6">

<ul>
<li><p>Para desarrollar un método <code
class="sourceCode java">hashCode</code> válido y efectivo, se recomienda
el algoritmo propuesto por Joshua Bloch en su libro «<em>Effective
Java</em>»:</p>
<ol>
<li><p>Crear un <code
class="sourceCode java"><span class="dt">int</span> result</code> y
asignarle un valor no cero (por ej., <code
class="sourceCode java"><span class="dv">17</span></code>).</p></li>
<li><p>Para cada campo <code>f</code> usado en el método <code
class="sourceCode java">equals</code>:</p>
<ul>
<li><p>Calcular un código <em>hash</em> para <code>f</code> y llamarlo
<code>code</code>:</p>
<ul>
<li>Si <code>f</code> es un <code
class="sourceCode java"><span class="dt">boolean</span></code>: calcular
<code
class="sourceCode java"><span class="op">(</span>f <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1</span><span class="op">)</span></code>;</li>
<li>Si <code>f</code> es un <code
class="sourceCode java"><span class="dt">byte</span></code>, <code
class="sourceCode java"><span class="dt">char</span></code>, <code
class="sourceCode java"><span class="dt">short</span></code> o <code
class="sourceCode java"><span class="dt">int</span></code>: calcular
<code
class="sourceCode java"><span class="op">(</span><span class="dt">int</span><span class="op">)</span> f</code>;</li>
<li>Si <code>f</code> es un <code
class="sourceCode java"><span class="dt">long</span></code>: calcular
<code
class="sourceCode java"><span class="op">(</span><span class="dt">int</span><span class="op">)</span> <span class="op">(</span>f <span class="op">^</span> <span class="op">(</span>f <span class="op">&gt;&gt;&gt;</span> <span class="dv">32</span><span class="op">))</span></code>;</li>
<li>Si <code>f</code> es un <code
class="sourceCode java"><span class="dt">float</span></code>: calcular
<code
class="sourceCode java"><span class="bu">Float</span><span class="op">.</span><span class="fu">floatToIntBits</span><span class="op">(</span>f<span class="op">)</span></code>;</li>
<li>Si <code>f</code> es un <code
class="sourceCode java"><span class="dt">double</span></code>: calcula
<code
class="sourceCode java"><span class="bu">Double</span><span class="op">.</span><span class="fu">doubleToLongBits</span><span class="op">(</span>f<span class="op">)</span></code>;</li>
<li>Si <code>f</code> es un objeto: usar <code
class="sourceCode java">f<span class="op">.</span><span class="fu">hashCode</span><span class="op">()</span></code>,
ó <code class="sourceCode java"><span class="dv">0</span></code> si
<code>f</code> <code>==</code> <code
class="sourceCode java"><span class="kw">null</span></code>;</li>
<li>Si <code>f</code> es un <em>array</em>: ver cada elemento como un
campo independiente y calcular el valor <em>hash</em>
recursivamente.</li>
</ul></li>
<li><p>Combinar el valor de <code>code</code> con <code>result</code>
así:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="dv">31</span> <span class="op">*</span> result <span class="op">+</span> code<span class="op">;</span></span></code></pre></div></li>
</ul></li>
<li><p>Devolver <code>result</code> como el código <em>hash</em> del
objeto.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.7">

<div class="caja">
<p>Es importante no incluir en este algoritmo ningún campo que no se
utilice en <code class="sourceCode java">equals</code>.</p>
</div>
<ul>
<li><p>Por ejemplo, una implementación más adecuada del método <code
class="sourceCode java">hashCode</code> en nuestra clase
<code>Persona</code> podría ser:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Override</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">hashCode</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="dv">17</span><span class="op">;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">31</span> <span class="op">*</span> result <span class="op">+</span> <span class="op">(</span>nombre <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> nombre<span class="op">.</span><span class="fu">hashCode</span><span class="op">());</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">31</span> <span class="op">*</span> result <span class="op">+</span> <span class="op">(</span>edad <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> apellidos<span class="op">.</span><span class="fu">hashCode</span><span class="op">());</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">31</span> <span class="op">*</span> result <span class="op">+</span> edad<span class="op">;</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Desde Java 7, se dispone del método <code
class="sourceCode java">java<span class="op">.</span><span class="fu">util</span><span class="op">.</span><span class="fu">Objects</span><span class="op">.</span><span class="fu">hash</span></code>
que permite obtener un código <em>hash</em> de forma rápida y sencilla,
ocultando todas esas constantes mágicas y todas esas comprobaciones de
nulos.</p></li>
<li><p>Gracias a ese método, nuestro <code
class="sourceCode java">hashCode</code> queda mucho más sencillo:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Override</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">int</span> <span class="fu">hashCode</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Objects<span class="op">.</span><span class="fu">hash</span><span class="op">(</span>nombre<span class="op">,</span> apellidos<span class="op">,</span> edad<span class="op">);</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.8.0.8">

<ul>
<li><p>Aquí se puede ver un ejemplo de uso del nuevo método <code
class="sourceCode java">hashCode</code> sobre tres objetos. Dos de ellos
representan a la misma persona:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>Persona p1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span>     <span class="co">// una persona</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Persona p2 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;Juan&quot;</span><span class="op">,</span> <span class="st">&quot;Pérez&quot;</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span>     <span class="co">// la misma persona</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>Persona p3 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Persona</span><span class="op">(</span><span class="st">&quot;María&quot;</span><span class="op">,</span> <span class="st">&quot;González&quot;</span><span class="op">,</span> <span class="dv">30</span><span class="op">);</span> <span class="co">// otra persona</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p1<span class="op">.</span><span class="fu">hashCode</span><span class="op">());</span> <span class="co">// 443676584</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p2<span class="op">.</span><span class="fu">hashCode</span><span class="op">());</span> <span class="co">// 443676584</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>p3<span class="op">.</span><span class="fu">hashCode</span><span class="op">());</span> <span class="co">// 1456026844</span></span></code></pre></div></li>
<li><p>Como puede comprobarse, se obtiene el mismo código <em>hash</em>
sobre objetos iguales.</p></li>
</ul>
</section>
<section id="resumen" class="title-slide slide level4"
data-number="3.2.8.1">
<h4 data-number="3.2.8.1"><span
class="header-section-number">3.2.8.1</span> Resumen</h4>
<ul>
<li><p>Si se sobreescribe el método <code
class="sourceCode java">equals</code> es recomendable sobreescribir
también el método <code class="sourceCode java">hashCode</code> para
conservar el contrato entre ambos métodos: dos objetos iguales deben
retornar el mismo valor de <em>hash</em>.</p></li>
<li><p>El método <code class="sourceCode java">equals</code> no llama al
método <code class="sourceCode java">hashCode</code> para determinar la
igualdad de dos objetos.</p></li>
<li><p>Es recomendable, por no decir obligatorio, sobreescribir el
método <code class="sourceCode java">equals</code> porque la
implementación por defecto no es de mucha ayuda.</p></li>
<li><p>Si dos objetos no son iguales, no es necesario que sus <code
class="sourceCode java">hashCode</code>s sean distintos; de hecho, dos
objetos diferentes pueden devolver el mismo valor
<em>hash</em>.</p></li>
<li><p>Si se necesita guardar los objetos en las estructuras señaladas
anteriormente (<code
class="sourceCode java"><span class="bu">HashMap</span></code> y
similares) es absolutamente indispensable sobreescribir el método <code
class="sourceCode java">hashCode</code>; de lo contrario obtendrá
resultados inesperados o no deseados cuando se realicen operaciones de
guardar, consultar o eliminar los datos.</p></li>
</ul>
</section>


</section>
<section>
<section id="restricciones" class="title-slide slide level1"
data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span>
Restricciones</h1>

</section>
<section id="clases-y-métodos-abstractos"
class="title-slide slide level2" data-number="4.1">
<h2 data-number="4.1"><span class="header-section-number">4.1</span>
Clases y métodos abstractos</h2>
<ul>
<li><p>Una <strong>clase abstracta</strong> es aquella que se define con
el modificador <code
class="sourceCode java"><span class="kw">abstract</span></code>:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">abstract</span> <span class="kw">class</span> Ejemplo <span class="op">{</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>   <span class="co">// ...</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Las clases abstractas no se pueden instanciar, por lo que su
principal utilidad es la de servir de superclase para otras
subclases:</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Ejemplo e <span class="op">=</span> <span class="kw">new</span> <span class="fu">Ejemplo</span><span class="op">();</span> <span class="co">// Error: no se puede instanciar una clase abstracta</span></span></code></pre></div></li>
<li><p>Un <strong>método abstracto</strong> es aquel que se define con
el modificador <code
class="sourceCode java"><span class="kw">abstract</span></code> y sin
cuerpo (es decir, sin un bloque de sentencias):</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">abstract</span> <span class="dt">void</span> <span class="fu">mover</span><span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">);</span></span></code></pre></div></li>
<li><p>Las clases abstractas pueden o no contener métodos
abstractos.</p></li>
</ul>
<div class="caja">
<p>Si una clase contiene al menos un método abstracto, la clase en sí
también debe definirse como abstracta.</p>
</div>
</section>
<section class="slide level5" data-number="4.1.0.0.1">

<ul>
<li><p>Ejemplo:</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">abstract</span> <span class="kw">class</span> ElementoGrafico <span class="op">{</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="dt">double</span> x<span class="op">;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="dt">double</span> y<span class="op">;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="bu">String</span> titulo<span class="op">;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getTitulo</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> titulo<span class="op">;</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setTitulo</span><span class="op">(</span><span class="bu">String</span> titulo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">titulo</span> <span class="op">=</span> titulo<span class="op">;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">abstract</span> <span class="dt">void</span> <span class="fu">mover</span><span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">);</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">abstract</span> <span class="dt">void</span> <span class="fu">dibujar</span><span class="op">();</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Las definiciones que no llevan asociadas un valor también se
denominan <strong>declaraciones</strong> (por eso, a las
<em>declaraciones de variables</em> se las denomina así).</p></li>
<li><p>La definición de un método abstracto también es, en realidad, una
<em>declaración</em>, ya que sólo se indica la
<strong>signatura</strong> del método pero no su
<strong>implementación</strong>. Por tanto, ahí no se está creando
ningún método ni asociándolo al nombre del método.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.2">

<ul>
<li><p>Cuando una clase es <strong>subclase (directa o indirecta) de una
superclase abstracta</strong>, esa subclase debe proporcionar un cuerpo
a todos los métodos abstractos que haya heredado de su superclase.</p>
<p>De lo contrario, esa subclase también se deberá definir como
abstracta.</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ventana <span class="kw">extends</span> ElementoGrafico <span class="op">{</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">mover</span><span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">x</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">y</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">dibujar</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Me estoy dibujando...&quot;</span><span class="op">);</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>El acto de proporcionar un cuerpo a un método abstracto también
se denomina <strong>implementar el método abstracto</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="4.1.0.0.3">

<ul>
<li><p>Si dejamos algún método abstracto sin implementar, la subclase
también se deberá definir como abstracta:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">abstract</span> <span class="kw">class</span> Ventana <span class="kw">extends</span> ElementoGrafico <span class="op">{</span>  <span class="co">// Debe ser abstracta</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> <span class="fu">mover</span><span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">x</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">y</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Falta la implementación del método «dibujar»</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>

<section id="clases-y-métodos-finales" class="title-slide slide level2"
data-number="4.2">
<h2 data-number="4.2"><span class="header-section-number">4.2</span>
Clases y métodos finales</h2>
<ul>
<li><p>Una <strong>clase final</strong> es aquella que se define con el
modificador <code
class="sourceCode java"><span class="dt">final</span></code>:</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="kw">class</span> Ejemplo <span class="op">{</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>   <span class="co">// ...</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p><strong>No se pueden crear subclases de una superclase
final</strong>:</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Intento <span class="kw">extends</span> Ejemplo <span class="op">{</span> <span class="co">// Error: la clase «Ejemplo» es final</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p>Un <strong>método final</strong> es aquel que se define con el
modificador <code
class="sourceCode java"><span class="dt">final</span></code>:</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">void</span> <span class="fu">mover</span><span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>   <span class="co">// ...</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
<li><p><strong>Los métodos finales no se pueden
redefinir.</strong></p></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.0.0.1">

<ul>
<li><p>Las clases finales y los métodos finales son dos conceptos que no
tienen nada que ver uno con el otro. Una clase final puede tener o no
métodos finales, y un método final puede estar o no en una clase
final.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base <span class="op">{</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">int</span> <span class="fu">capacidad</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Derivada <span class="op">{</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@Override</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="fu">capacidad</span><span class="op">()</span> <span class="op">{</span>      <span class="co">// Error: el método «capacidad» es final en «Base»</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">33</span><span class="op">;</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="4.2.0.0.2">

<ul>
<li><p>No tiene sentido aplicar las cláusulas <code
class="sourceCode java"><span class="kw">abstract</span></code> y <code
class="sourceCode java"><span class="dt">final</span></code> a la vez
sobre una clase o un método: una clase o un método no pueden ser <code
class="sourceCode java"><span class="kw">abstract</span></code> y <code
class="sourceCode java"><span class="dt">final</span></code> al mismo
tiempo.</p></li>
<li><p>Se define una clase como final cuando interesa que esa clase no
se pueda especializar con una subclase que pueda tener un comportamiento
diferente.</p></li>
<li><p>Se define un método como final cuando interesa que su
implementación no se pueda cambiar en una subclase.</p></li>
<li><p>En general, los métodos llamados desde un constructor deberían
definirse como finales.</p></li>
<li><p>Si un constructor llamada a un método no final, una subclase
podría redefinir ese método y provocar resultados sorprendentes o
indeseables.</p></li>
</ul>
</section>
</section>
<section id="bibliografía"
class="title-slide slide level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Bibliografía</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-gosling_java_2014" class="csl-entry" role="listitem">
Gosling, James, Bill Joy, Guy L. Steele, Gilad Bracha, and Alex Buckley.
2014. <em>The <span>Java</span>® Language Specification</em>. Java SE 8
edition. Upper Saddle River, NJ: Addison-Wesley.
</div>
</div>
</section>
    </div>
  </div>

  <script src="./reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="./reveal.js/plugin/notes/notes.js"></script>
  <script src="./reveal.js/plugin/search/search.js"></script>
  <script src="./reveal.js/plugin/zoom/zoom.js"></script>
  <script src="./reveal.js/plugin/reveal.js-menu/menu.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 1080,
        // The display mode that will be used to show slides
        display: 'block',

        menu: {
          hideMissingTitles: true,
        },

        dependencies: [
          { src: './reveal.js/plugin/reveal.js-quiz/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, checkAnswerText: 'Comprueba la respuesta', nextQuestionText: 'Siguiente &raquo;', backButtonText: '&laquo; Anterior', tryAgainText: 'Prueba de nuevo', preventUnansweredText: 'Selecciona una respuesta', questionCountText: 'Pregunta %current de %total', skipStartButton: true}); } }
        ],

        // reveal.js plugins
        plugins: [
          RevealMenu,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="text/javascript">
       var title = document.getElementsByClassName('title')[0];
       title = title != null ? title.innerHTML : '';
       var author = document.getElementsByClassName('author')[0];
       author = author != null ? author.innerHTML : '';
       var date = document.getElementsByClassName('date')[0];
       date = date != null ? date.innerHTML : '';
       document.getElementById('header-left').innerHTML = '<a href="#/title-slide">' + title + '</a>';
       document.getElementById('footer-left').innerHTML = '<a href="https://pro.iesdonana.org">&copy; ' + author + ' (' + date + ')</a>';

       function updateHeader(nd) {
           var hr = document.getElementById('header-right');
           while (hr.children.length > 0) {
               hr.removeChild(hr.lastChild);
           }
           buscar(nd, 3, hr);
           buscar(nd, 2, hr);
           buscar(nd, 1, hr);
           hr.style.fontSize = Math.round(50 * Reveal.getScale()) + '%';
           hr.style.fontSize = Math.max(Number.parseInt(getComputedStyle(hr).fontSize), 12) + 'px';
           var hl = document.getElementById('header-left');
           hl.style.fontSize = hr.style.fontSize;
       }

       function buscar(nd, level, hr) {
           if (!nd.classList.contains('level' + (level - 1))) {
               for (var n = nd; n != null; n = n.previousSibling) {
                   if (n.nodeType == Node.TEXT_NODE) {
                       continue;
                   }
                   var cl = n.classList;
                   if (cl.contains('level' + level)) {
                       var h = n.querySelector('h' + level);
                   } else if (cl.contains('level' + (level - 1))) {
                       break;
                   } else {
                       continue;
                   }
                   if (h == null || Reveal.getCurrentSlide().id == 'title-slide') {
                       hr.innerHTML = '';
                   } else {
                       var el = document.createElement('a');
                       var href = '#/' + n.id;
                       el.href = href;
                       el.innerHTML = h.innerHTML;
                       var a = el.querySelector('a');
                       if (a !== null) {
                           a.href = href;
                       }
                       if (hr.innerHTML != '') {
                           hr.innerHTML = ' &mdash; ' + hr.innerHTML;
                       }
                       hr.insertBefore(el, hr.firstChild);
                   }
                   break;
               }
           }
       }

       // On Reveal.js ready event, copy header/footer <div>
       // into each `.slide-background` <div>
       Reveal.on('ready', event => {
           var header = document.getElementById('header');
           document.querySelector('.reveal').appendChild(header);
           updateHeader(Reveal.getCurrentSlide());
       });

       Reveal.on('slidechanged', event => {
           // event.previousSlide, event.currentSlide, event.indexh, event.indexv
           updateHeader(event.currentSlide);
       });
    </script>
    </body>
</html>
