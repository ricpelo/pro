<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Ricardo Pérez López">
  <title>Programación funcional (II)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="./reveal.js/dist/reset.css">
  <link rel="stylesheet" href="./reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #268bd2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #cb4b16; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #d33682; } /* BaseN */
    code span.bu { color: #4070a0; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #dc322f; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #93a1a1; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #6c71c4; } /* DataType */
    code span.dv { color: #d33682; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #d33682; } /* Float */
    code span.fu { color: #4070a0; } /* Function */
    code span.im { font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #268bd2; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #a57800; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #2aa198; } /* SpecialString */
    code span.st { color: #2aa198; } /* String */
    code span.va { color: #6c71c4; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="./reveal.js/dist/theme/solarized.css" id="theme">
  <link rel="stylesheet" href="custom.css"/>
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
  <style type="text/css">
      #header-left {
          position: absolute;
          font-size: 25%;
          top: 0%;
          left: 0%;
          margin-left: 10px;
          margin-top: 10px;
      }
      #header-right {
          position: absolute;
          font-size: 25%;
          top: 0%;
          right: 0%;
          margin-right: 10px;
          margin-top: 10px;
      }
      #footer-left {
          position: absolute;
          font-size: 25%;
          bottom: 0%;
          left: 0%;
          margin-left: 10px;
          margin-bottom: 10px;
      }
  </style>
</head>
<body>
<div id="hidden" style="display:none;">
    <div id="header">
        <div id="header-left"></div>
        <div id="header-right"></div>
        <div id="footer-left"></div>
    </div>
</div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Programación funcional (II)</h1>
  <p class="author">Ricardo Pérez López</p>
  <p class="date">IES Doñana, curso 2023/2024</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<ul>
<li><a href="#/computabilidad" id="/toc-computabilidad"><span
class="toc-section-number">1</span> Computabilidad</a></li>
<li><a href="#/tipos-de-datos-recursivos"
id="/toc-tipos-de-datos-recursivos"><span
class="toc-section-number">2</span> Tipos de datos recursivos</a></li>
<li><a href="#/funciones-de-orden-superior"
id="/toc-funciones-de-orden-superior"><span
class="toc-section-number">3</span> Funciones de orden superior</a></li>
</ul>
</nav>
</section>

<section>
<section id="computabilidad" class="title-slide slide level1"
data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span>
Computabilidad</h1>

</section>
<section id="funciones-y-procesos" class="title-slide slide level2"
data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span>
Funciones y procesos</h2>
<ul>
<li><p>Los <strong>procesos</strong> son entidades abstractas que
habitan los ordenadores.</p></li>
<li><p>Conforme van evolucionando, los procesos manipulan otras
entidades abstractas llamadas <strong>datos</strong>.</p></li>
<li><p>La evolución de un proceso está dirigida por un patrón de reglas
llamado <strong>programa</strong>.</p></li>
<li><p>Los programadores crean programas para <strong>dirigir</strong> a
los procesos.</p></li>
<li><p>Es como decir que los programadores son magos que invocan a los
espíritus del ordenador (los procesos) con sus conjuros (los programas)
escritos en un lenguaje mágico (el lenguaje de programación).</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.1.0.0.1">

<ul>
<li><p>Una <strong>función</strong> describe la <em>evolución local</em>
de un <strong>proceso</strong>, es decir, cómo se debe comportar el
proceso durante la ejecución de la función.</p></li>
<li><p>En cada paso de la ejecución se calcula el <em>siguiente
estado</em> del proceso basándonos en el estado actual y en las reglas
definidas por la función.</p></li>
<li><p>Nos gustaría ser capaces de visualizar y de realizar afirmaciones
sobre el comportamiento global del proceso cuya evolución local está
definida por la función.</p></li>
<li><p>Esto, en general, es muy difícil, pero al menos vamos a describir
algunos de los modelos típicos de evolución de los procesos.</p></li>
</ul>
</section>

<section id="funciones-ad-hoc" class="title-slide slide level2"
data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span>
Funciones <em>ad-hoc</em></h2>
<ul>
<li><p>Supongamos que queremos diseñar una función llamada <code
class="sourceCode python">permutas</code> que reciba un número entero
<span class="math inline">n</span> y que calcule cuántas permutaciones
distintas podemos hacer con <span class="math inline">n</span>
elementos.</p></li>
<li><p>Por ejemplo: si tenemos 3 elementos (digamos, <em>A</em>,
<em>B</em> y <em>C</em>), podemos formar con ellos las siguientes
permutaciones:</p>
<p><span class="math display">ABC, ACB, BAC, BCA, CAB, CBA</span></p>
<p>y, por tanto, con 3 elementos podemos formar 6 permutaciones
distintas. En consecuencia, <code
class="sourceCode python">permutas(<span class="dv">3</span>)</code>
debe devolver <code
class="sourceCode python"><span class="dv">6</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.1">

<ul>
<li><p>La implementación de esa función deberá satisfacer la siguiente
especificación:</p>
<p><span class="math display">\left\{\begin{array}{ll}
  \text{\textbf{Pre}}: &amp; n \geq 0 \\[0.5em]
&amp; \texttt{permutas(\(n\):\,int)\;-&gt;\;int} \\[0.5em]
\text{\textbf{Post}}: &amp; \texttt{permutas(\(n\))} = \text{el número
de permutaciones que}\\[0.1em]
&amp; \text{podemos formar con \(n\) elementos}
\end{array}\right.</span></p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.2">

<ul>
<li><p>Un programador con poca idea de programación (o muy listillo) se
podría plantear una implementación parecida a la siguiente:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>permutas <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">2</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> ...</span></code></pre></div>
<p>que se puede escribir mejor usando la barra invertida
(<code>\</code>) para poder separar una instrucción en varias
líneas:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>permutas <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">2</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">6</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">24</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">4</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                     ...                    <span class="co"># sigue y sigue</span></span></code></pre></div></li>
<li><p>Pero este algoritmo en realidad es <em>tramposo</em>, porque no
calcula nada, sino que se limita a asociar el dato de entrada con el de
salida, que se ha tenido que calcular previamente usando otro
procedimiento.</p></li>
<li><p>Este tipo de algoritmos se denominan <strong>algoritmos
<em>ad-hoc</em></strong>, y las funciones que los implementan se
denominan <strong>funciones <em>ad-hoc</em></strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.2.0.0.3">

<ul>
<li><p>Las funciones <em>ad-hoc</em> <strong>no son
convenientes</strong> porque:</p>
<ul>
<li><p>Realmente son <strong>tramposos</strong> (no calculan
nada).</p></li>
<li><p><strong>No son útiles</strong>, porque al final el cálculo se
tiene que hacer con otra cosa.</p></li>
<li><p>Generalmente resulta <strong>imposible</strong> que una función
de este tipo abarque todos los posibles datos de entrada, ya que, en
principio, puede haber <strong>infinitos</strong> y, por tanto, su
código fuente también tendría que ser infinito.</p></li>
</ul></li>
</ul>
<div class="caja centered">
<p><strong>Usar algoritmos y funciones <em>ad-hoc</em> se penaliza en
esta asignatura.</strong></p>
</div>
</section>

<section id="funciones-recursivas" class="title-slide slide level2"
data-number="1.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span>
Funciones recursivas</h2>

</section>
<section id="definición" class="title-slide slide level3"
data-number="1.3.1">
<h3 data-number="1.3.1"><span class="header-section-number">1.3.1</span>
Definición</h3>
<ul>
<li><p>Una <strong>función recursiva</strong> es aquella que se define
en términos de sí misma.</p></li>
<li><p>Eso quiere decir que, durante la ejecución de una llamada a la
función, se ejecuta otra llamada a la misma función, es decir, que la
función se llama a sí misma directa o indirectamente.</p></li>
<li><p>La forma más sencilla y habitual de función recursiva es aquella
en la que <strong>la propia definición de la función contiene una o
varias llamadas a ella misma</strong>. En tal caso, decimos que la
función se llama a sí misma <em>directamente</em> o que hay una
<strong>recursividad directa</strong>.</p>
<p>Ese es el tipo de recursividad que vamos a estudiar.</p></li>
<li><p>Las definiciones recursivas son el mecanismo básico para ejecutar
<strong>repeticiones de instrucciones</strong> en un lenguaje de
programación funcional.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.1">

<ul>
<li><p>Por ejemplo: <span class="math display">f(n) = n + f(n +
1)</span></p></li>
<li><p>Esta función matemática es <em>recursiva</em> porque aparece ella
misma en su propia definición.</p>
<p>Para calcular el valor de <span class="math inline">f(n)</span>
tenemos que volver a utilizar la propia función <span
class="math inline">f</span>.</p></li>
<li><p>Por ejemplo: <span class="math display">f(1) = 1 + f(2) = 1 + 2 +
f(3) = 1 + 2 + 3 + f(4) = \ldots</span></p></li>
<li><p>Cada vez que una función se llama a sí misma decimos que se
realiza una <strong>llamada recursiva</strong> o <strong>paso
recursivo</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.1.0.2">

<div class="centered">
<p><img data-src="images/pintura-recursiva.jpg" class="plain"
style="width:100.0%" /></p>
</div>
</section>
<section id="ejercicio" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol class="example" type="1">
<li>Desde el principio del curso ya hemos estado trabajando con
estructuras que pueden tener una definición recursiva. ¿Cuáles son?</li>
</ol>
</section>

<section id="casos-base-y-casos-recursivos"
class="title-slide slide level3" data-number="1.3.2">
<h3 data-number="1.3.2"><span class="header-section-number">1.3.2</span>
Casos base y casos recursivos</h3>
<ul>
<li><p>Resulta importante que una definición recursiva se detenga alguna
vez y proporcione un resultado, ya que si no, no sería útil (tendríamos
lo que se llama una <strong>recursión infinita</strong>).</p></li>
<li><p>Por tanto, en algún momento, la recursión debe alcanzar un punto
en el que la función no se llame a sí misma y se detenga.</p></li>
<li><p>Para ello, es necesario que la función, en cada paso recursivo,
se vaya acercando cada vez más a ese punto.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.2.0.1">

<ul>
<li><p>Ese punto en el que la función recursiva <strong>no se llama a sí
misma</strong>, se denomina <strong>caso base</strong>, y puede haber
más de uno.</p></li>
<li><p>Los casos base, por tanto, determinan bajo qué condiciones la
función no se llamará a sí misma, o dicho de otra forma, con qué valores
de sus argumentos la función devolverá directamente un valor y no
provocará una nueva llamada recursiva.</p></li>
<li><p>Los demás casos, que sí provocan llamadas recursivas, se
denominan <strong>casos recursivos</strong>.</p></li>
</ul>
</section>

<section id="el-factorial" class="title-slide slide level3"
data-number="1.3.3">
<h3 data-number="1.3.3"><span class="header-section-number">1.3.3</span>
El factorial</h3>
<ul>
<li><p>El ejemplo más típico de función recursiva es el
<strong>factorial</strong>.</p></li>
<li><p>El factorial de un número natural <span
class="math inline">n</span> se representa por <span
class="math inline">n!</span> y se define como el producto de todos los
números desde 1 hasta <span class="math inline">n</span>: <span
class="math display">n! =
n\cdot(n-1)\cdot(n-2)\cdot\cdots\cdot1</span></p>
<p>Por ejemplo: <span class="math display">6! =
6\cdot5\cdot4\cdot3\cdot2\cdot1 = 720</span></p></li>
<li><p>Pero para calcular <span class="math inline">6!</span> también se
puede calcular <span class="math inline">5!</span> y después multiplicar
el resultado por 6, ya que: <span class="math display">6! =
6\cdot\overbrace{5\cdot4\cdot3\cdot2\cdot1}^{5!}</span> <span
class="math display">6! = 6\cdot5!</span></p></li>
<li><p>Por tanto, el factorial se puede definir de forma
<strong>recursiva</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.3.0.1">

<ul>
<li><p>Tenemos el <strong>caso recursivo</strong>, pero necesitamos al
menos un <strong>caso base</strong> para evitar que la recursión se haga
<em>infinita</em>.</p></li>
<li><p>El caso base del factorial se obtiene sabiendo que el factorial
de 0 es directamente 1 (no hay que llamar al factorial recursivamente):
<span class="math display">0! = 1</span></p></li>
<li><p>Combinando ambos casos tendríamos:</p>
<p><span class="math display">n! = \begin{cases}
         1 &amp; \text{si } n = 0 \text{\quad(caso base)} \\
         n\cdot(n-1)! &amp; \text{si } n &gt; 0 \text{\quad(caso
recursivo)}
       \end{cases}</span></p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.3.0.2">

<ul>
<li><p>La <strong>especificación</strong> de una función que calcule el
factorial de un número sería:</p>
<p><span class="math display">\left\{\begin{array}{ll}
  \text{\textbf{Pre}}: &amp; n \geq 0 \\[0.5em]
&amp; \texttt{factorial(\(n\):\,int)\;-&gt;\;int} \\[0.5em]
\text{\textbf{Post}}: &amp; \texttt{factorial(\(n\))} = n!
\end{array}\right.</span></p></li>
<li><p>Y su <strong>implementación</strong> en Python podría ser la
siguiente:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> n <span class="op">*</span> factorial(n <span class="op">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>que sería prácticamente una traducción literal de la definición
recursiva de factorial que acabamos de obtener.</p></li>
</ul>
</section>

<section id="diseño-de-funciones-recursivas"
class="title-slide slide level3" data-number="1.3.4">
<h3 data-number="1.3.4"><span class="header-section-number">1.3.4</span>
Diseño de funciones recursivas</h3>
<ul>
<li><p>El diseño de funciones recursivas se basa en:</p>
<ol>
<li><p>Identificación de casos base</p></li>
<li><p>Descomposición (reducción) del problema</p></li>
<li><p>Pensamiento optimista</p></li>
</ol></li>
</ul>
</section>
<section id="identificación-de-casos-base"
class="title-slide slide level4" data-number="1.3.4.1">
<h4 data-number="1.3.4.1"><span
class="header-section-number">1.3.4.1</span> Identificación de casos
base</h4>
<ul>
<li><p>Debemos identificar los ejemplares para los cuales hay una
solución directa que no necesita recursividad.</p></li>
<li><p>Esos ejemplares representarán los <em>casos base</em> de la
función recursiva, y por eso los denominamos <em>ejemplares
básicos</em>.</p></li>
<li><p>Por ejemplo:</p>
<ul>
<li><p>Supongamos que queremos diseñar una función (llamada <span
class="math inline">fact</span>, por ejemplo) que calcule el factorial
de un número.</p>
<p>Es decir: <span class="math inline">fact(n)</span> debe devolver el
factorial de <span class="math inline">n</span>.</p></li>
<li><p>Sabemos que <span class="math inline">0! = 1</span>, por lo que
nuestra función podría devolver directamente <span
class="math inline">1</span> cuando se le pida calcular el factorial de
<span class="math inline">0</span>.</p></li>
<li><p>Por tanto, el caso base del factorial es el cálculo del factorial
de 0: <span class="math display">fact(0) = 1</span></p></li>
</ul></li>
</ul>
</section>

<section id="descomposición-reducción-del-problema"
class="title-slide slide level4" data-number="1.3.4.2">
<h4 data-number="1.3.4.2"><span
class="header-section-number">1.3.4.2</span> Descomposición (reducción)
del problema</h4>
<ul>
<li><p>Reducimos el problema de forma que así tendremos un ejemplar
<em>más pequeño</em> del problema.</p></li>
<li><p>Un ejemplar más pequeño es aquel que está <strong>más cerca del
caso base</strong>.</p></li>
<li><p>De esta forma, cada ejemplar se irá acercando más y más al caso
base hasta que finalmente se alcanzará dicho caso base y eso detendrá la
recursión.</p></li>
<li><p>Es importante comprobar que eso se cumple, es decir, que la
reducción que le realizamos al problema produce ejemplares que están más
cerca del caso base, porque de lo contrario se produciría una
<em>recursión infinita</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.4.2.1">

<ul>
<li><p>En el ejemplo del factorial:</p>
<ul>
<li><p>El caso base es <span class="math inline">fact(0)</span>, es
decir, el caso en el que queremos calcular el factorial de 0, que ya
vimos que es directamente 1 (sin necesidad de llamadas
recursivas).</p></li>
<li><p>Si queremos resolver el problema de calcular, por ejemplo, el
factorial de 5, podríamos intentar reducir el problema a calcular el
factorial de 4, que es un número que está más cerca del caso base (que
es 0).</p></li>
<li><p>A su vez, para calcular el factorial de 4, reduciríamos el
problema a calcular el factorial de 3, y así sucesivamente.</p></li>
<li><p>De esta forma, podemos reducir el problema de calcular el
factorial de <span class="math inline">n</span> a calcular el factorial
de <span class="math inline">(n - 1)</span>, que es un número que está
más cerca del 0. Así, cada vez estaremos más cerca del caso base y, al
final, siempre lo acabaremos alcanzando.</p></li>
</ul></li>
</ul>
</section>

<section id="pensamiento-optimista" class="title-slide slide level4"
data-number="1.3.4.3">
<h4 data-number="1.3.4.3"><span
class="header-section-number">1.3.4.3</span> Pensamiento optimista</h4>
<ul>
<li><p>Consiste en suponer que la función deseada ya existe y que,
aunque no sabe resolver el ejemplar original del problema, sí que es
capaz de resolver ejemplares <em>más pequeños</em> de ese problema (este
paso se denomina <strong>hipótesis inductiva</strong> o
<strong>hipótesis de inducción</strong>).</p></li>
<li><p>Suponiendo que se cumple la <em>hipótesis inductiva</em>, y
aprovechando que ya contamos con un método para <em>reducir el ejemplar
a uno más pequeño</em>, ahora tratamos de encontrar un <em>patrón
común</em> de forma que resolver el ejemplar original implique usar el
mismo patrón en un ejemplar más pequeño.</p></li>
<li><p>Es decir:</p>
<ul>
<li><p>Al reducir el problema, obtenemos un ejemplar más pequeño del
mismo problema y, por tanto, podremos usar la función para poder
resolver ese ejemplar más pequeño (que sí sabe resolverlo, por hipótesis
inductiva).</p></li>
<li><p>A continuación, usamos dicha solución <em>parcial</em> para
tratar de obtener la solución para el ejemplar original del
problema.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.4.3.1">

<ul>
<li><p>En el ejemplo del factorial:</p>
<ul>
<li><p>Supongamos que queremos calcular, por ejemplo, el factorial de
6.</p></li>
<li><p>Aún no sabemos calcular el factorial de 6, pero suponemos (por
<em>hipótesis inductiva</em>) que sí sabemos calcular el factorial de
5.</p>
<p>En ese caso, ¿cómo puedo aprovechar que sé resolver el factorial de 5
para lograr calcular el factorial de 6?</p></li>
<li><p>Analizando el problema, observo que se cumple esta propiedad:
<span class="math display">6! =
6\cdot\overbrace{5\cdot4\cdot3\cdot2\cdot1}^{5!}=6\cdot 5!</span></p>
<p>Por tanto, he deducido un método para resolver el problema de
calcular el factorial de 6 a partir del factorial de 5: <em>para
calcular el factorial de 6 basta con calcular primero el factorial de 5
y luego multiplicar el resultado por 6</em>.</p>
<div class="caja">
<p>Dicho de otro modo: <em>si yo supiera</em> calcular el factorial de
5, me bastaría con multiplicarlo por 6 para obtener el factorial de
6.</p>
</div></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.4.3.2">

<ul>
<li><p>Generalizando para cualquier número, no sólo para el 6:</p>
<ul>
<li><p>Si queremos diseñar una función <span
class="math inline">fact(n)</span> que calcule el factorial de <span
class="math inline">n</span>, supondremos que esa función ya existe pero
que aún no sabe calcular el factorial de <span
class="math inline">n</span>, aunque <strong>sí sabe calcular el
factorial de <span class="math inline">\pmb{(n -
1)}</span></strong>.</p>
<p>Tenemos que creer en que es así y actuar como si fuera así, aunque
ahora mismo no sea verdad. <em>Ésta es nuestra <strong>hipótesis
inductiva</strong></em>.</p></li>
<li><p>Por otra parte, sabemos que: <span class="math display">n! =
n\cdot\overbrace{(n-1)\cdot(n-2)\cdot(n-3)\cdot2\cdot1}^{(n-1)!}=n\cdot(n-1)!</span></p>
<p>Por tanto, si sabemos calcular el factorial de <span
class="math inline">(n - 1)</span> llamando a <span
class="math inline">fact(n
- 1)</span>, para calcular <span class="math inline">fact(n)</span> sólo
necesito multiplicar <span class="math inline">n</span> por el resultado
de <span class="math inline">fact(n - 1)</span>.</p>
<div class="caja">
<p>Resumiendo: <strong><em>si yo supiera</em> calcular el factorial de
<span class="math inline">\pmb{(n - 1)}</span>, me bastaría con
multiplicarlo por <span class="math inline">\pmb{n}</span> para obtener
el factorial de <span class="math inline">\pmb{n}</span></strong>.</p>
</div></li>
<li><p>Así obtengo el caso recursivo de la función <em>fact</em>, que
sería: <span class="math display">fact(n) = n\cdot
fact(n-1)</span></p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.4.3.3">

<ul>
<li>Combinando todos los pasos, obtenemos la solución general:</li>
</ul>
<p><span class="math display">fact(n) = \begin{cases}
         1 &amp; \text{si } n = 0 \text{\quad(caso base)} \\
         n\cdot fact(n-1) &amp; \text{si } n &gt; 0 \text{\quad(caso
recursivo)}
       \end{cases}</span></p>
</section>


<section id="recursividad-lineal" class="title-slide slide level3"
data-number="1.3.5">
<h3 data-number="1.3.5"><span class="header-section-number">1.3.5</span>
Recursividad lineal</h3>
<ul>
<li><p>Una función tiene <strong>recursividad lineal</strong> si cada
llamada a la función recursiva genera, como mucho, otra llamada
recursiva a la misma función.</p></li>
<li><p>El factorial definido en el ejemplo anterior es un caso típico de
recursividad lineal ya que, cada vez que se llama al factorial se
genera, como mucho, otra llamada al factorial.</p></li>
<li><p>Eso se aprecia claramente observando que la definición del caso
recursivo de la función <span class="math inline">fact</span> contiene
una única llamada a la misma función <span
class="math inline">fact</span>:</p></li>
</ul>
<p><span class="math display">fact(n) = n\cdot fact(n-1)\quad \text{si }
n &gt; 0\quad \text{(caso recursivo)}</span></p>
</section>
<section id="procesos-recursivos-lineales"
class="title-slide slide level4" data-number="1.3.5.1">
<h4 data-number="1.3.5.1"><span
class="header-section-number">1.3.5.1</span> Procesos recursivos
lineales</h4>
<ul>
<li><p>La forma más directa y sencilla de definir una función que
calcule el factorial de un número a partir de su definición recursiva
podría ser la siguiente:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> n <span class="op">*</span> factorial(n <span class="op">-</span> <span class="dv">1</span>)</span></code></pre></div></li>
<li><p>Utilizaremos el modelo de sustitución para observar el
funcionamiento de esta función al calcular <span
class="math inline">6!</span>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>factorial(<span class="dv">6</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> factorial(<span class="dv">5</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> factorial(<span class="dv">4</span>)))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> factorial(<span class="dv">3</span>))))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> factorial(<span class="dv">2</span>)))))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> factorial(<span class="dv">1</span>))))))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">*</span> factorial(<span class="dv">0</span>)))))))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">*</span> <span class="dv">1</span>))))))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> <span class="dv">1</span>)))))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> (<span class="dv">3</span> <span class="op">*</span> <span class="dv">2</span>))))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">*</span> <span class="dv">6</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> (<span class="dv">5</span> <span class="op">*</span> <span class="dv">24</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> (<span class="dv">6</span> <span class="op">*</span> <span class="dv">120</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> <span class="dv">720</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.5.1.1">

<ul>
<li><p>Podemos observar un perfil de <strong>expansión</strong> seguido
de una <strong>contracción</strong>:</p>
<ul>
<li><p>La <strong>expansión</strong> ocurre conforme el proceso
construye una secuencia de operaciones a realizar
<em>posteriormente</em> (en este caso, una secuencia de
multiplicaciones).</p></li>
<li><p>La <strong>contracción</strong> se realiza conforme se van
ejecutando realmente las multiplicaciones.</p></li>
</ul></li>
<li><p>Llamaremos <strong>proceso recursivo</strong> a este tipo de
proceso caracterizado por una secuencia de <strong>operaciones
pendientes de completar</strong>.</p></li>
<li><p>Para poder ejecutar este proceso, el intérprete necesita
<strong>memorizar</strong>, en algún lugar, un registro de las
multiplicaciones que se han dejado para más adelante.</p></li>
<li><p>En el cálculo de <span class="math inline">n!</span>, la longitud
de la secuencia de operaciones pendientes (y, por tanto, la información
que necesita almacenar el intérprete), crece <em>linealmente</em> con
<span class="math inline">n</span>, al igual que el número de pasos de
reducción.</p>
<p>A este tipo de procesos lo llamaremos <strong>proceso recursivo
<em>lineal</em></strong>.</p></li>
</ul>
</section>

<section id="procesos-iterativos-lineales"
class="title-slide slide level4" data-number="1.3.5.2">
<h4 data-number="1.3.5.2"><span
class="header-section-number">1.3.5.2</span> Procesos iterativos
lineales</h4>
<ul>
<li><p>A continuación adoptaremos un enfoque diferente.</p></li>
<li><p>Podemos mantener un producto acumulado y un contador desde <span
class="math inline">n</span> hasta 1, de forma que el contador y el
producto cambien de un paso al siguiente según la siguiente regla:</p>
<p><span class="math display">\begin{array}{l}
    acumulador_{nuevo} = acumulador_{viejo} \cdot contador_{viejo}
\\[0.5em]
    contador_{nuevo} = contador_{viejo} - 1
  \end{array}</span></p></li>
<li><p>Su traducción a Python podría ser la siguiente, usando una
función auxiliar <code>fact_iter</code>:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fact_iter <span class="op">=</span> <span class="kw">lambda</span> cont, acc: acc <span class="cf">if</span> cont <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                              fact_iter(cont <span class="op">-</span> <span class="dv">1</span>, cont <span class="op">*</span> acc)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: fact_iter(n, <span class="dv">1</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.5.2.1">

<ul>
<li><p>Al igual que antes, usaremos el modelo de sustitución para
visualizar el proceso del cálculo de <span
class="math inline">6!</span>:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>factorial(<span class="dv">6</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">4</span>, <span class="dv">30</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">3</span>, <span class="dv">120</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">2</span>, <span class="dv">360</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">1</span>, <span class="dv">720</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">0</span>, <span class="dv">720</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> <span class="dv">720</span></span></code></pre></div></li>
<li><p>Este proceso no tiene expansiones ni contracciones ya que, en
cada instante, toda la información que se necesita almacenar es el valor
actual de los parámetros <code class="sourceCode python">cont</code> y
<code class="sourceCode python">acc</code>, por lo que el tamaño de la
memoria necesaria es constante.</p></li>
<li><p>A este tipo de procesos lo llamaremos <strong>proceso
iterativo</strong>.</p></li>
<li><p>El número de pasos necesarios para calcular <span
class="math inline">n!</span> usando esta función crece
<em>linealmente</em> con <span class="math inline">n</span>.</p>
<p>A este tipo de procesos lo llamaremos <strong>proceso iterativo
<em>lineal</em></strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.5.2.2">

<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 37%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Tipo de proceso</th>
<th style="text-align: left;">Número de reducciones</th>
<th style="text-align: left;">Memoria necesaria</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Recursivo</td>
<td style="text-align: left;">Proporcional a <span
class="math inline">\underline{n}</span></td>
<td style="text-align: left;">Proporcional a <span
class="math inline">\underline{n}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Iterativo</td>
<td style="text-align: left;">Proporcional a <span
class="math inline">\underline{n}</span></td>
<td style="text-align: left;">Constante</td>
</tr>
</tbody>
</table>
<p><br>* * *<br></p>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 36%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Tipo de proceso</th>
<th style="text-align: left;">Número de reducciones</th>
<th style="text-align: left;">Memoria necesaria</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Recursivo lineal</td>
<td style="text-align: left;">Linealmente<br />
proporcional a <span class="math inline">\underline{n}</span></td>
<td style="text-align: left;">Linealmente<br />
proporcional a <span class="math inline">\underline{n}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Iterativo lineal</td>
<td style="text-align: left;">Linealmente<br />
proporcional a <span class="math inline">\underline{n}</span></td>
<td style="text-align: left;">Constante</td>
</tr>
</tbody>
</table>
</section>
<section class="slide level5" data-number="1.3.5.2.3">

<ul>
<li><p>En general, un <strong>proceso iterativo</strong> es aquel que
está definido por una serie de <strong>coordenadas de estado</strong>
junto con una <strong>regla</strong> fija que describe cómo actualizar
dichas coordenadas conforme cambia el proceso de un estado al
siguiente.</p></li>
<li><p>La <strong>diferencia entre los procesos recursivo e
iterativo</strong> se puede describir de esta otra manera:</p>
<ul>
<li><p>En el <strong>proceso iterativo</strong>, los parámetros dan una
descripción completa del estado del proceso en cada instante.</p>
<p>Así, si parásemos el cálculo entre dos pasos, lo único que
necesitaríamos hacer para seguir con el cálculo es darle al intérprete
el valor de los dos parámetros.</p></li>
<li><p>En el <strong>proceso recursivo</strong>, el intérprete tiene que
mantener cierta información <em>oculta</em> que no está almacenada en
ningún parámetro y que indica qué operaciones ha realizado hasta ahora y
cuáles quedan pendientes por hacer.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.5.2.4">

<ul>
<li><p>No debe confundirse un <strong>proceso recursivo</strong> con una
<strong>función recursiva</strong>:</p>
<ul>
<li><p>Cuando hablamos de <em>función recursiva</em> nos referimos al
hecho de que la función se llama a sí misma (directa o
indirectamente).</p></li>
<li><p>Cuando hablamos de <em>proceso recursivo</em> nos referimos a la
forma en como se desenvuelve la ejecución de la función (con una
expansión más una contracción).</p></li>
</ul></li>
<li><p>Puede parecer extraño que digamos que una función recursiva (por
ejemplo, <code class="sourceCode python">fact_iter</code>) genera un
proceso iterativo.</p>
<p>Sin embargo, el proceso es realmente iterativo porque su estado está
definido completamente por dos parámetros, y para ejecutar el proceso
sólo se necesita almacenar el valor de esos dos parámetros.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.5.2.5">

<ul>
<li><p>Aquí hemos visto un ejemplo donde se aprecia claramente que
<strong>una función sólo puede tener una especificación</strong> pero
<strong>puede tener varias implementaciones</strong> distintas.</p></li>
<li><p>Eso sí: todas las implementaciones de una función deben
satisfacer su especificación.</p></li>
<li><p>En este caso, las dos implementaciones son:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> n <span class="op">*</span> factorial(n <span class="op">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>y</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fact_iter <span class="op">=</span> <span class="kw">lambda</span> cont, acc: acc <span class="cf">if</span> cont <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                              fact_iter(cont <span class="op">-</span> <span class="dv">1</span>, cont <span class="op">*</span> acc)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: fact_iter(n, <span class="dv">1</span>)</span></code></pre></div></li>
<li><p>Y aunque las dos satisfacen la misma especificación (y, por
tanto, calculan exactamente los mismos valores), lo hacen de una forma
muy diferente, generando incluso procesos de distinto tipo.</p></li>
</ul>
</section>


<section id="recursividad-múltiple" class="title-slide slide level3"
data-number="1.3.6">
<h3 data-number="1.3.6"><span class="header-section-number">1.3.6</span>
Recursividad múltiple</h3>
<ul>
<li><p>Una función tiene <strong>recursividad múltiple</strong> cuando
la misma llamada a la función recursiva puede generar más de una llamada
recursiva a la misma función.</p></li>
<li><p>El ejemplo clásico es la función que calcula los términos de la
<strong>sucesión de Fibonacci</strong>.</p></li>
<li><p>La sucesión comienza con los números 0 y 1, y a partir de éstos,
cada término es la suma de los dos anteriores:</p>
<p>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987,
1597, …</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.6.0.1">

<ul>
<li><p>Podemos definir una función recursiva que devuelva el <span
class="math inline">n</span>-ésimo término de la sucesión de
Fibonacci:</p>
<p><span class="math display">fib(n) = \begin{cases}
             0 &amp; \text{si } n = 0 \text{\quad (caso base)} \\
             1 &amp; \text{si } n = 1 \text{\quad (caso base)} \\
             fib(n - 1) + fib(n - 2) &amp; \text{si } n &gt; 1
\text{\quad (caso recursivo)}
           \end{cases}</span></p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.6.0.2">

<ul>
<li><p>La especificación de una función que devuelva el <span
class="math inline">n</span>-ésimo término de la sucesión de Fibonacci
sería:</p>
<p><span class="math display">\left\{\begin{array}{ll}
  \text{\textbf{Pre}}: &amp; n \geq 0 \\[0.5em]
&amp; \texttt{fib(\(n\):\,int)\;-&gt;\;int} \\[0.5em]
\text{\textbf{Post}}: &amp; \texttt{fib(\(n\))} = \text{el \(n\)-ésimo
término de la sucesión de Fibonacci}
\end{array}\right.</span></p></li>
<li><p>Y su implementación en Python podría ser:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fib <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">0</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> fib(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fib(n <span class="op">-</span> <span class="dv">2</span>)</span></code></pre></div>
<p>o bien, separando la definición en varias líneas:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fib <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">0</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                fib(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fib(n <span class="op">-</span> <span class="dv">2</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.6.0.3">

<ul>
<li><p>Si vemos el perfil de ejecución de <code
class="sourceCode python">fib(<span class="dv">5</span>)</code>, vemos
que:</p>
<ul>
<li><p>Para calcular <code
class="sourceCode python">fib(<span class="dv">5</span>)</code>, antes
debemos calcular <code
class="sourceCode python">fib(<span class="dv">4</span>)</code> y <code
class="sourceCode python">fib(<span class="dv">3</span>)</code>.</p></li>
<li><p>Para calcular <code
class="sourceCode python">fib(<span class="dv">4</span>)</code>, antes
debemos calcular <code
class="sourceCode python">fib(<span class="dv">3</span>)</code> y <code
class="sourceCode python">fib(<span class="dv">2</span>)</code>.</p></li>
<li><p>Así sucesivamente hasta poner todo en función de <code
class="sourceCode python">fib(<span class="dv">0</span>)</code> y <code
class="sourceCode python">fib(<span class="dv">1</span>)</code>, que se
pueden calcular directamente (son los casos base).</p></li>
</ul></li>
<li><p>En general, el proceso resultante tiene forma de árbol.</p></li>
<li><p>Por eso decimos que las funciones con recursividad múltiple
generan <strong>procesos recursivos en árbol</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.6.0.4">

<div class="centered">
<p><img data-src="images/arbol-fibonacci.svg" class="plain"
style="width:80.0%" /></p>
</div>
</section>
<section class="slide level5" data-number="1.3.6.0.5">

<ul>
<li><p>La función anterior es un buen ejemplo de recursión en árbol,
pero desde luego es un método <em>horrible</em> para calcular los
números de Fibonacci, por la cantidad de <strong>operaciones
redundantes</strong> que efectúa.</p></li>
<li><p>Para tener una idea de lo malo que es, se puede observar que
<span class="math inline">fib(n)</span> crece exponencialmente en
función de <span class="math inline">n</span>.</p></li>
<li><p>Por lo tanto, el proceso necesita una cantidad de tiempo que
crece <strong>exponencialmente</strong> con <span
class="math inline">n</span>.</p></li>
<li><p>Por otro lado, el espacio necesario sólo crece
<strong>linealmente</strong> con <span class="math inline">n</span>,
porque en un cierto momento del cálculo sólo hay que memorizar los nodos
que hay por encima.</p></li>
<li><p>En general, en un proceso recursivo en árbol <strong>el tiempo de
ejecución crece con el <em>número de nodos</em> del árbol</strong>
mientras que <strong>el espacio necesario crece con la <em>altura
máxima</em> del árbol</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.6.0.6">

<ul>
<li><p>Se puede construir un <strong>proceso iterativo</strong> para
calcular los números de Fibonacci.</p></li>
<li><p>La idea consiste en usar dos coordenadas de estado <em>a</em> y
<em>b</em> (con valores iniciales 0 y 1, respectivamente) y aplicar
repetidamente la siguiente transformación:</p>
<p><span class="math display">\begin{array}{l}
    a_{nuevo} = b_{viejo} \\[0.5em]
    b_{nuevo} = b_{viejo} + a_{viejo}
  \end{array}</span></p></li>
<li><p>Después de <span class="math inline">n</span> pasos, <em>a</em> y
<em>b</em> contendrán <span class="math inline">fib(n)</span> y <span
class="math inline">fib(n + 1)</span>, respectivamente.</p></li>
<li><p>En Python sería:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fib_iter <span class="op">=</span> <span class="kw">lambda</span> cont, a, b: a <span class="cf">if</span> cont <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> fib_iter(cont <span class="op">-</span> <span class="dv">1</span>, b, a <span class="op">+</span> b)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fib <span class="op">=</span> <span class="kw">lambda</span> n: fib_iter(n, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div></li>
<li><p>Esta función genera un proceso iterativo lineal, por lo que es
mucho más eficiente.</p></li>
</ul>
</section>

<section id="recursividad-final-y-no-final"
class="title-slide slide level3" data-number="1.3.7">
<h3 data-number="1.3.7"><span class="header-section-number">1.3.7</span>
Recursividad final y no final</h3>
<ul>
<li><p>Lo que diferencia al <code
class="sourceCode python">fact_iter</code> que genera un proceso
iterativo del <code class="sourceCode python">factorial</code> que
genera un proceso recursivo, es el hecho de que <code
class="sourceCode python">fact_iter</code> se llama a sí misma y
devuelve directamente el valor que le ha devuelto su llamada recursiva
sin hacer luego nada más.</p>
<p>En cambio, <code class="sourceCode python">factorial</code> tiene que
hacer una multiplicación después de llamarse a sí misma y antes de
terminar de ejecutarse:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Versión con recursividad final:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fact_iter <span class="op">=</span> <span class="kw">lambda</span> cont, acc: acc <span class="cf">if</span> cont <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                              fact_iter(cont <span class="op">-</span> <span class="dv">1</span>, acc <span class="op">*</span> cont)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fact <span class="op">=</span> <span class="kw">lambda</span> n: fact_iter(n, <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Versión con recursividad no final:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>factorial <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> n <span class="op">*</span> factorial(n <span class="op">-</span> <span class="dv">1</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.7.0.1">

<ul>
<li><p>Es decir:</p>
<ul>
<li><p><code class="sourceCode python">fact_iter(cont, acc)</code>
simplemente llama a:</p>
<p><code
class="sourceCode python">fact_iter(cont <span class="op">-</span> <span class="dv">1</span>, acc <span class="op">*</span> cont)</code></p>
<p>y luego devuelve directamente el valor que le entrega ésta llamada,
sin hacer ninguna otra operación posterior antes de terminar.</p></li>
<li><p>En cambio, <code class="sourceCode python">factorial(n)</code>
hace:</p>
<p><code
class="sourceCode python">n <span class="op">*</span> factorial(n <span class="op">-</span> <span class="dv">1</span>)</code></p>
<p>o sea, se llama a sí misma pero el resultado de la llamada recursiva
tiene que multiplicarlo luego por <code
class="sourceCode python">n</code> antes de devolver el resultado
final.</p></li>
</ul></li>
<li><p>Por tanto, <strong>lo último que hace <code
class="sourceCode python">fact_iter</code> es llamarse a sí
misma</strong>. En cambio, lo último que hace <code
class="sourceCode python">factorial</code> no es llamarse a sí misma,
porque tiene que hacer más operaciones (en este caso, la multiplicación)
antes de devolver el resultado.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.7.0.2">

<ul>
<li><p>Cuando lo último que hace una función recursiva es llamarse a sí
misma y devolver directamente el valor devuelto por esa llamada
recursiva, decimos que la función es <strong>recursiva final</strong> o
que tiene <strong>recursividad final</strong>.</p></li>
<li><p>En caso contrario, decimos que la función es <strong>recursiva no
final</strong> o que tiene <strong>recursividad no
final</strong>.</p></li>
<li><p><strong>Las funciones recursivas finales generan procesos
iterativos.</strong></p></li>
<li><p>La función <code>fact_iter</code> es recursiva final, y por eso
genera un proceso iterativo.</p></li>
<li><p>En cambio, la función <code>factorial</code> es recursiva no
final, y por eso genera un proceso recursivo.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.3.7.0.3">

<ul>
<li><p>En la práctica, para que un proceso iterativo consuma realmente
una cantidad constante de memoria, es necesario que el traductor
<strong>optimice la recursividad final</strong>.</p></li>
<li><p>Ese tipo de optimización se denomina <strong><em>tail-call
optimization (TCO)</em></strong>.</p></li>
<li><p>No muchos traductores optimizan la recursividad final.</p></li>
<li><p>De hecho, ni el intérprete de Python ni la máquina virtual de
Java optimizan la recursividad final.</p></li>
<li><p>Por tanto, en estos dos lenguajes, las funciones recursivas
finales consumen tanta memoria como las no finales.</p></li>
</ul>
</section>


<section id="la-pila-de-control" class="title-slide slide level2"
data-number="1.4">
<h2 data-number="1.4"><span class="header-section-number">1.4</span> La
pila de control</h2>
<ul>
<li><p>La <strong>pila de control</strong> es una estructura de datos
que utiliza el intérprete para llevar la cuenta de las <strong>llamadas
<em>activas</em></strong> en un determinado momento.</p>
<ul>
<li>Las <strong>llamadas activas</strong> son aquellas llamadas a
funciones que aún no han terminado de ejecutarse.</li>
</ul></li>
<li><p>La pila de control es, básicamente, un <strong>almacén de
marcos</strong>.</p></li>
<li><p>Cada vez que se hace una nueva llamada a una función, <strong>su
marco</strong> correspondiente <strong>se almacena en la cima de la
pila</strong> sobre los demás marcos que pudiera haber.</p></li>
<li><p>Ese marco es el primero de la secuencia de marcos que forman el
entorno de la función, que también estarán almacenados en la pila, más
abajo.</p></li>
<li><p>Los marcos se enlazan entre sí para representar los entornos que
actúan en las distintas llamadas activas.</p></li>
</ul>
</section>
<section class="slide level5" data-number="1.4.0.0.1">

<ul>
<li><p>El intérprete almacena en el marco cualquier información que
necesite para gestionar las llamadas a funciones, incluyendo:</p>
<ul>
<li><p>Las ligaduras entre los parámetros y sus valores (por
supuesto).</p></li>
<li><p>La ligadura que apunta al valor de retorno de la
función.</p></li>
<li><p>Cuál es el siguiente marco que le sigue en el entorno.</p></li>
<li><p>El punto de retorno, dentro del programa, al que debe devolverse
el control cuando finalice la ejecución de la función.</p></li>
</ul></li>
<li><p>Un marco almacenado en la pila también se denomina
<strong>registro de activación</strong>. Por tanto, también podemos
decir que la pila de control almacena registros de activación.</p></li>
<li><p>Cada llamada activa está representada por su correspondiente
marco en la pila.</p></li>
<li><p>En cuanto la llamada finaliza, su marco se saca de la pila y se
transfiere el control a la llamada que está inmediatamente debajo (si es
que hay alguna).</p></li>
</ul>
</section>
<section id="ejemplos" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejemplos</h5>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>uno <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">1</span> <span class="op">+</span> dos(<span class="dv">2</span> <span class="op">*</span> x, <span class="dv">4</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dos <span class="op">=</span> <span class="kw">lambda</span> y, z: tres(y <span class="op">+</span> z <span class="op">+</span> g)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>tres <span class="op">=</span> <span class="kw">lambda</span> w: <span class="st">&quot;W vale &quot;</span> <span class="op">+</span> <span class="bu">str</span>(w)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>uno(<span class="dv">3</span>)</span></code></pre></div>
</div><div class="column">
<div class="centered">
<figure>
<img data-src="images/pila-control.svg" class="plain"
style="width:40.0%"
alt="Pila de control con la llamada a la función tres activada" />
<figcaption aria-hidden="true">Pila de control con la llamada a la
función <code>tres</code> activada</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section class="slide level5" data-number="1.4.0.0.2">

<ul>
<li><p>Del análisis del diagrama del ejemplo anterior se pueden deducir
las siguientes conclusiones:</p>
<ul>
<li><p>En un momento dado, dentro del ámbito global se ha llamado a la
función <code class="sourceCode python">uno</code>, la cual ha llamado a
la función <code class="sourceCode python">dos</code>, la cual ha
llamado a la función <code class="sourceCode python">tres</code>, la
cual aún no ha terminado de ejecutarse.</p></li>
<li><p>El entorno en la función <code
class="sourceCode python">uno</code> empieza por el marco de <code
class="sourceCode python">uno</code>, el cual apunta al marco
global.</p></li>
<li><p>El entorno en la función <code
class="sourceCode python">dos</code> empieza por el marco de <code
class="sourceCode python">dos</code>, el cual apunta al marco
global.</p></li>
<li><p>El entorno en la función <code
class="sourceCode python">tres</code> empieza por el marco de <code
class="sourceCode python">tres</code>, el cual apunta al marco
global.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="1.4.0.0.3">

<ul>
<li><p>Si tenemos ámbitos anidados, los marcos se apuntarán entre sí en
el entorno. Por ejemplo:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>uno <span class="op">=</span> <span class="kw">lambda</span> x: dos(x <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>dos <span class="op">=</span> <span class="kw">lambda</span> y: <span class="dv">1</span> <span class="op">+</span> (<span class="kw">lambda</span> z: z <span class="op">*</span> <span class="dv">2</span>)(y <span class="op">**</span> <span class="dv">3</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>uno(<span class="dv">3</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.4.0.0.4">

<div class="centered">
<figure>
<img data-src="images/pila-control-ambitos-anidados.svg" class="plain"
style="width:30.0%"
alt="Pila de control con ámbitos anidados y la función dos activada" />
<figcaption aria-hidden="true">Pila de control con ámbitos anidados y la
función <code>dos</code> activada</figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="1.4.0.0.5">

<ul>
<li><p>Hemos dicho que habrá un marco por cada nueva llamada que se
realice a una función, y que ese marco se mantendrá en la pila hasta que
la llamada finalice.</p></li>
<li><p>Por tanto, en el caso de una función recursiva, tendremos un
marco por cada llamada recursiva.</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fact <span class="op">=</span> <span class="kw">lambda</span> n: <span class="dv">1</span> <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> n <span class="op">*</span> fact(n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fact(<span class="dv">4</span>)</span></code></pre></div>
</section>
<section class="slide level5" data-number="1.4.0.0.6">

<div class="centered">
<figure>
<img data-src="images/pila-control-factorial.svg" class="plain"
style="width:30.0%"
alt="Pila de control tras tres activaciones desde fact(4)" />
<figcaption aria-hidden="true">Pila de control tras tres activaciones
desde <code>fact(4)</code></figcaption>
</figure>
</div>
</section>
<section class="slide level5" data-number="1.4.0.0.7">

<ul>
<li><p>Los <strong>traductores que optimizan la recursividad
final</strong> lo que hacen es sustituir cada llamada recursiva por la
nueva llamada recursiva a la misma función.</p></li>
<li><p>De esta forma, el marco que genera cada nueva llamada recursiva
no se apila sobre los marcos anteriores en la pila, sino que sustituye
al marco de la llamada que la ha llamado a ella.</p></li>
<li><p>Por ejemplo, en el siguiente caso:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fact_iter <span class="op">=</span> <span class="kw">lambda</span> cont, acc: acc <span class="cf">if</span> cont <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                              fact_iter(cont <span class="op">-</span> <span class="dv">1</span>, acc <span class="op">*</span> cont)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fact <span class="op">=</span> <span class="kw">lambda</span> n: fact_iter(n, <span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fact(<span class="dv">5</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">3</span>, <span class="dv">20</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">2</span>, <span class="dv">60</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">1</span>, <span class="dv">120</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> fact_iter(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="op">=</span> <span class="dv">120</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="1.4.0.0.8">

<ul>
<li><p><code
class="sourceCode python">fact_iter(<span class="dv">4</span>, <span class="dv">5</span>)</code>
llama a <code
class="sourceCode python">fact_iter(<span class="dv">3</span>, <span class="dv">20</span>)</code>
y devuelve directamente el resultado de ésta.</p></li>
<li><p>Es decir: <code
class="sourceCode python">fact_iter(<span class="dv">4</span>, <span class="dv">5</span>) <span class="op">==</span> fact_iter(<span class="dv">3</span>, <span class="dv">20</span>)</code>,
así que hacer <code
class="sourceCode python">fact_iter(<span class="dv">4</span>, <span class="dv">5</span>)</code>
es lo mismo que hacer <code
class="sourceCode python">fact_iter(<span class="dv">3</span>, <span class="dv">20</span>)</code>.</p></li>
<li><p>Por tanto, la llamada a <code
class="sourceCode python">fact_iter(<span class="dv">4</span>, <span class="dv">5</span>)</code>
se puede sustituir por la llamada a <code
class="sourceCode python">fact_iter(<span class="dv">3</span>, <span class="dv">20</span>)</code>.</p></li>
<li><p>Un intérprete que optimiza la recursividad final no apilaría el
marco de la segunda llamada sobre el marco de la primera, sino que el
marco de la segunda sustituiría al marco de la primera dentro de la
pila.</p></li>
<li><p>Así se haría también con las demás llamadas recursivas a <code
class="sourceCode python">fact_iter(<span class="dv">2</span>, <span class="dv">60</span>)</code>,
<code
class="sourceCode python">fact_iter(<span class="dv">1</span>, <span class="dv">120</span>)</code>
y <code
class="sourceCode python">fact_iter(<span class="dv">0</span>, <span class="dv">120</span>)</code>.</p></li>
<li><p>De este modo, la pila no crecería con cada nueva llamada
recursiva.</p></li>
</ul>
</section>

<section id="un-lenguaje-turing-completo"
class="title-slide slide level2" data-number="1.5">
<h2 data-number="1.5"><span class="header-section-number">1.5</span> Un
lenguaje Turing-completo</h2>
<ul>
<li><p>El paradigma funcional que hemos visto hasta ahora (uno que nos
permite definir funciones, componer dichas funciones y aplicar
recursividad, junto con el operador ternario condicional) es un lenguaje
de programación <strong>completo</strong>.</p></li>
<li><p>Decimos que es <strong>Turing completo</strong>, lo que significa
que puede computar cualquier función que pueda computar una máquina de
Turing.</p></li>
<li><p>Como las máquinas de Turing son los ordenadores más potentes que
podemos construir (ya que describen lo que cualquier ordenador es capaz
de hacer), esto significa que nuestro lenguaje puede calcular todo lo
que pueda calcular cualquier ordenador.</p></li>
</ul>
</section>
</section>
<section>
<section id="tipos-de-datos-recursivos" class="title-slide slide level1"
data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Tipos
de datos recursivos</h1>

</section>
<section id="concepto" class="title-slide slide level2"
data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span>
Concepto</h2>
<ul>
<li><p>Un <strong>tipo de dato recursivo</strong> es aquel que puede
definirse en términos de sí mismo.</p></li>
<li><p>Un <strong>dato recursivo</strong> es un dato que pertenece a un
tipo recursivo. Por tanto, es un dato que se construye sobre otros datos
del mismo tipo.</p></li>
<li><p>Como toda estructura recursiva, un tipo de dato recursivo tiene
casos base y casos recursivos:</p>
<ul>
<li><p>En los casos base, el tipo recursivo se define directamente, sin
referirse a sí mismo.</p></li>
<li><p>En los casos recursivos, el tipo recursivo se define sobre sí
mismo.</p></li>
</ul></li>
<li><p>La forma más natural de manipular un dato recursivo es usando
funciones recursivas.</p></li>
</ul>
</section>

<section id="cadenas" class="title-slide slide level2"
data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span>
Cadenas</h2>
<ul>
<li><p>Las <strong>cadenas</strong> se pueden considerar <strong>tipos
de datos recursivos</strong>, ya que podemos decir que toda cadena <code
class="sourceCode python">c</code>:</p>
<ul>
<li><p>o bien es la cadena vacía <code
class="sourceCode python"><span class="st">&#39;&#39;</span></code>
(<em>caso base</em>),</p></li>
<li><p>o bien está formada por dos partes:</p>
<ul>
<li><p>El <strong>primer carácter</strong> de la cadena, al que se
accede mediante <code
class="sourceCode python">c[<span class="dv">0</span>]</code>.</p></li>
<li><p>El <strong>resto</strong> de la cadena (al que se accede mediante
<code class="sourceCode python">c[<span class="dv">1</span>:]</code>),
que también es una cadena (<em>caso recursivo</em>).</p></li>
</ul>
<p>En tal caso, se cumple que <code
class="sourceCode python">c <span class="op">==</span> c[<span class="dv">0</span>] <span class="op">+</span> c[<span class="dv">1</span>:]</code>.</p></li>
</ul></li>
<li><p>Eso significa que podemos acceder al segundo carácter de la
cadena (suponiendo que exista) mediante <code
class="sourceCode python">c[<span class="dv">1</span>:][<span class="dv">0</span>]</code>.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cadena <span class="op">=</span> <span class="st">&#39;hola&#39;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cadena[<span class="dv">0</span>]       <span class="co"># devuelve &#39;h&#39;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>cadena[<span class="dv">1</span>:]      <span class="co"># devuelve &#39;ola&#39;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>cadena[<span class="dv">1</span>:][<span class="dv">0</span>]   <span class="co"># devuelve &#39;o&#39;</span></span></code></pre></div></li>
</ul>
</section>

<section id="tuplas" class="title-slide slide level2" data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span>
Tuplas</h2>
<ul>
<li><p>Las <strong>tuplas</strong> (datos de tipo <code
class="sourceCode python"><span class="bu">tuple</span></code>) son una
generalización de las cadenas.</p></li>
<li><p>Una tupla es una <strong>secuencia de elementos</strong> que no
tienen por qué ser caracteres, sino que cada uno de ellos pueden ser
<strong>de cualquier tipo</strong> (números, cadenas, booleanos, …,
incluso otras tuplas).</p></li>
<li><p>Los literales de tipo tupla se representan enumerando sus
elementos separados por comas y encerrados entre paréntesis.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tupla <span class="op">=</span> (<span class="dv">27</span>, <span class="st">&#39;hola&#39;</span>, <span class="va">True</span>, <span class="fl">73.4</span>, (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), <span class="dv">99</span>)</span></code></pre></div></li>
<li><p>Si sólo tiene un elemento, hay que poner una coma detrás:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tupla <span class="op">=</span> (<span class="dv">35</span>,)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.0.0.1">

<ul>
<li><p>Las tuplas también pueden verse como un <strong>tipo de datos
recursivo</strong>, ya que toda tupla <code
class="sourceCode python">t</code>:</p>
<ul>
<li><p>o bien es la tupla vacía, representada mediante <code
class="sourceCode python">()</code> (<em>caso base</em>),</p></li>
<li><p>o bien está formada por dos partes:</p>
<ul>
<li><p>El <strong>primer elemento</strong> de la tupla (al que se accede
mediante <code
class="sourceCode python">t[<span class="dv">0</span>]</code>), que
hemos visto que puede ser de cualquier tipo.</p></li>
<li><p>El <strong>resto</strong> de la tupla (al que se accede mediante
<code class="sourceCode python">t[<span class="dv">1</span>:]</code>),
que también es una tupla (<em>caso recursivo</em>).</p></li>
</ul></li>
</ul></li>
<li><p>Según el ejemplo anterior:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tupla <span class="op">=</span> (<span class="dv">27</span>, <span class="st">&#39;hola&#39;</span>, <span class="va">True</span>, <span class="fl">73.4</span>, (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), <span class="dv">99</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tupla[<span class="dv">0</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tupla[<span class="dv">1</span>:]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>(<span class="st">&#39;hola&#39;</span>, <span class="va">True</span>, <span class="fl">73.4</span>, (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), <span class="dv">99</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tupla[<span class="dv">1</span>:][<span class="dv">0</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;hola&#39;</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="2.3.0.0.2">

<ul>
<li><p>Junto a las operaciones <code
class="sourceCode python">t[<span class="dv">0</span>]</code> y <code
class="sourceCode python">t[<span class="dv">1</span>:]</code>, tenemos
también la operación <code>+</code> (<strong>concatenación</strong>), al
igual que ocurre con las cadenas.</p></li>
<li><p>Con la concatenación se pueden crear nuevas tuplas a partir de
otras tuplas.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">+</span> (<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span></code></pre></div></li>
<li><p>Eso significa que, si <code class="sourceCode python">t</code> es
una tupla no vacía, se cumple que <br> <code
class="sourceCode python">t <span class="op">==</span> (t[<span class="dv">0</span>],) <span class="op">+</span> t[<span class="dv">1</span>:]</code>.</p>
<p>Esta propiedad es similar (aunque no exactamente igual) a la que se
cumple en las cadenas no vacías.</p></li>
</ul>
</section>

<section id="rangos" class="title-slide slide level2" data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span>
Rangos</h2>
<ul>
<li><p>Los rangos (datos de tipo <code
class="sourceCode python"><span class="bu">range</span></code>) son
valores que representan <strong>sencuencias de números
enteros</strong>.</p></li>
<li><p>Los rangos se crean con la función <code
class="sourceCode python"><span class="bu">range</span></code>, cuya
signatura es:</p>
<div class="caja">
<p><span
class="math inline">\texttt{range(\([\)\(start\):\,int,\(]\)\;\(stop\):\,int\;\([\),\;\(step\):\,int\(]\))\;-&gt;\;range}</span></p>
</div></li>
<li><p>Cuando se omite <em>start</em>, se entiende que es <code
class="sourceCode python"><span class="dv">0</span></code>.</p></li>
<li><p>Cuando se omite <em>step</em>, se entiende que es <code
class="sourceCode python"><span class="dv">1</span></code>.</p></li>
<li><p>El valor de <em>stop</em> no se alcanza nunca.</p></li>
<li><p>Cuando <em>start</em> y <em>stop</em> son iguales, representa el
<em>rango vacío</em>.</p></li>
<li><p><em>step</em> debe ser siempre distinto de cero.</p></li>
<li><p>Cuando <em>start</em> es mayor que <em>stop</em>, el valor de
<em>step</em> debería ser negativo. En caso contrario, también
representaría el rango vacío.</p></li>
</ul>
</section>
<section id="ejemplos-1" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejemplos</h5>
<ul>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">10</span>)</code>
representa la secuencia <span class="math inline">0, 1, 2, \ldots,
9</span>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">10</span>)</code>
representa la secuencia <span class="math inline">3, 4, 5, \ldots,
9</span>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">2</span>)</code>
representa la secuencia <span class="math inline">0, 2, 4, 6,
8</span>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)</code>
representa la secuencia <span class="math inline">4, 3, 2,
1</span>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">3</span>)</code>
representa el rango vacío.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">3</span>)</code>
también representa el rango vacío.</p></li>
</ul>
</section>
<section class="slide level5" data-number="2.4.0.0.1">

<ul>
<li>La <strong>forma normal</strong> de un rango es una expresión en la
que se llama a la función <code
class="sourceCode python"><span class="bu">range</span></code> con los
argumentos necesarios para construir el rango:</li>
</ul>
<div class="columns">
<div class="column">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">4</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span></code></pre></div>
</div><div class="column">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span></code></pre></div>
</div>
</div>
<ul>
<li><p>El <strong>rango vacío</strong> es un valor que no tiene
expresión canónica, ya que cualquiera de las siguientes expresiones
representan al rango vacío tan bien como cualquier otra:</p>
<ul>
<li><p><code
class="sourceCode python"><span class="bu">range</span>(<span class="dv">0</span>)</code>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span></code><code>(</code><span
class="math inline">a</span><code>,</code><span
class="math inline">\;a</span><code>)</code>, donde <em>a</em> es
cualquier entero.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span></code><code>(</code><span
class="math inline">a</span><code>,</code><span
class="math inline">\;b</span><code>,</code><span
class="math inline">\;c</span><code>)</code>, donde <span
class="math inline">a \geq b</span> y <span class="math inline">c &gt;
0</span>.</p></li>
<li><p><code
class="sourceCode python"><span class="bu">range</span></code><code>(</code><span
class="math inline">a</span><code>,</code><span
class="math inline">\;b</span><code>,</code><span
class="math inline">\;c</span><code>)</code>, donde <span
class="math inline">a \leq b</span> y <span class="math inline">c &lt;
0</span>.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">3</span>) <span class="op">==</span> <span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">3</span>) <span class="op">==</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre></div>
</section>
<section class="slide level5" data-number="2.4.0.0.2">

<ul>
<li><p>Los rangos también pueden verse como un <strong>tipo de datos
recursivo</strong>, ya que todo rango <code
class="sourceCode python">r</code>:</p>
<ul>
<li><p>o bien es el rango vacío (<em>caso base</em>),</p></li>
<li><p>o bien está formado por dos partes:</p>
<ul>
<li><p>El <strong>primer elemento</strong> del rango (al que se accede
mediante <code
class="sourceCode python">r[<span class="dv">0</span>]</code>), que
hemos visto que tiene que ser un número entero.</p></li>
<li><p>El <strong>resto</strong> del rango (al que se accede mediante
<code class="sourceCode python">r[<span class="dv">1</span>:]</code>),
que también es un rango (<em>caso recursivo</em>).</p></li>
</ul></li>
</ul></li>
<li><p>Según el ejemplo anterior:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rango <span class="op">=</span> <span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rango[<span class="dv">0</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rango[<span class="dv">1</span>:]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rango[<span class="dv">1</span>:][<span class="dv">0</span>]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div></li>
</ul>
</section>

<section id="conversión-a-tupla" class="title-slide slide level2"
data-number="2.5">
<h2 data-number="2.5"><span class="header-section-number">2.5</span>
Conversión a tupla</h2>
<ul>
<li>Las cadenas y los rangos se pueden convertir fácilmente a tuplas
usando la función <code
class="sourceCode python"><span class="bu">tuple</span></code>:</li>
</ul>
<div class="columns">
<div class="column" style="width:40%;">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="st">&#39;hola&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>(<span class="st">&#39;h&#39;</span>, <span class="st">&#39;o&#39;</span>, <span class="st">&#39;l&#39;</span>, <span class="st">&#39;a&#39;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="st">&#39;&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>()</span></code></pre></div>
</div><div class="column" style="width:60%;">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">5</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">3</span>))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="op">-</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">5</span>, <span class="op">-</span><span class="dv">6</span>, <span class="op">-</span><span class="dv">7</span>, <span class="op">-</span><span class="dv">8</span>, <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">0</span>))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>()</span></code></pre></div>
</div>
</div>
</section>
</section>
<section>
<section id="funciones-de-orden-superior"
class="title-slide slide level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span>
Funciones de orden superior</h1>

</section>
<section id="concepto-1" class="title-slide slide level2"
data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span>
Concepto</h2>
<ul>
<li><p>Sabemos que, en programación funcional, <strong>las
<em>funciones</em> también son <em>valores</em></strong>.</p>
<p>Por tanto, como pasa con cualquier otro valor, las funciones también
tienen un tipo, se pueden ligar a identificadores, etcétera.</p></li>
<li><p>Pero si las funciones son valores, eso significa que también se
pueden pasar como argumentos a otras funciones o se pueden devolver como
resultado de otras funciones.</p></li>
<li><p>Una <strong>función de orden superior</strong> es una función que
recibe funciones como argumentos o devuelve funciones como
resultado.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.1">

<ul>
<li><p>Por ejemplo, la siguiente función <strong>recibe otra función
como argumento</strong> y devuelve el resultado de aplicar dicha función
al número 5:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> aplica5 <span class="op">=</span> <span class="kw">lambda</span> f: f(<span class="dv">5</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cuadrado <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cubo <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> aplica5(cuadrado)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> aplica5(cubo)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="dv">125</span></span></code></pre></div></li>
<li><p>No hace falta crear las funciones <code
class="sourceCode python">cuadrado</code> y <code
class="sourceCode python">cubo</code> para pasárselas a la función <code
class="sourceCode python">aplica5</code> como argumento. Se pueden pasar
directamente las expresiones lambda, que también son funciones:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> aplica5(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> aplica5(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="dv">125</span></span></code></pre></div></li>
<li><p>Naturalmente, la función que se pasa a <code
class="sourceCode python">aplica5</code> debe recibir un único argumento
de tipo numérico.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.2">

<ul>
<li><p>También se puede <strong>devolver una función como
resultado</strong>.</p></li>
<li><p>Por ejemplo, la siguiente función <code
class="sourceCode python">suma_o_resta</code> recibe una cadena y
devuelve una función que suma si la cadena es <code
class="sourceCode python"><span class="st">&#39;suma&#39;</span></code>;
en caso contrario, devuelve una función que resta:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma_o_resta <span class="op">=</span> <span class="kw">lambda</span> s: (<span class="kw">lambda</span> x, y: x <span class="op">+</span> y) <span class="cf">if</span> s <span class="op">==</span> <span class="st">&#39;suma&#39;</span> <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                             (<span class="kw">lambda</span> x, y: x <span class="op">-</span> y)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma_o_resta(<span class="st">&#39;suma&#39;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>function <span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span>.<span class="op">&lt;</span><span class="bu">locals</span><span class="op">&gt;</span>.<span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span> at <span class="bn">0x7f526ab4a790</span><span class="op">&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma <span class="op">=</span> suma_o_resta(<span class="st">&#39;suma&#39;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> resta <span class="op">=</span> suma_o_resta(<span class="st">&#39;resta&#39;</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> resta(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma_o_resta(<span class="st">&#39;suma&#39;</span>)(<span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div></li>
<li><p>Tanto <code class="sourceCode python">aplica5</code> como <code
class="sourceCode python">suma_o_resta</code> son <strong>funciones de
orden superior</strong>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.3">

<ul>
<li><p>Una función es una abstracción porque agrupa lo que tienen en
común determinados casos particulares que siguen el mismo
patrón.</p></li>
<li><p>El mismo concepto se puede aplicar a casos particulares de
funciones, y al hacerlo damos un paso más en nuestro camino hacia un
mayor grado de abstracción.</p></li>
<li><p>Es decir: muchas veces observamos el mismo patrón en funciones
diferentes.</p></li>
<li><p>Para poder abstraer, de nuevo, lo que tienen en común dichas
funciones, deberíamos ser capaces de manejar funciones que acepten a
otras funciones como argumentos o que devuelvan otra función como
resultado (es decir, funciones de orden superior).</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.4">

<ul>
<li><p>Supongamos las dos funciones siguientes:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suma los enteros comprendidos entre a y b:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>suma_enteros <span class="op">=</span> <span class="kw">lambda</span> a, b: <span class="dv">0</span> <span class="cf">if</span> a <span class="op">&gt;</span> b <span class="cf">else</span> a <span class="op">+</span> suma_enteros(a <span class="op">+</span> <span class="dv">1</span>, b)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Suma los cubos de los enteros comprendidos entre a y b:</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>suma_cubos <span class="op">=</span> <span class="kw">lambda</span> a, b: <span class="dv">0</span> <span class="cf">if</span> a <span class="op">&gt;</span> b <span class="cf">else</span> cubo(a) <span class="op">+</span> suma_cubos(a <span class="op">+</span> <span class="dv">1</span>, b)</span></code></pre></div></li>
<li><p>Estas dos funciones comparten claramente un patrón común. Se
diferencian solamente en:</p>
<ul>
<li><p>El <em>nombre</em> de la función.</p></li>
<li><p>La función que se aplica a <code
class="sourceCode python">a</code> para calcular cada <em>término</em>
de la suma.</p></li>
</ul></li>
<li><p>Podríamos haber escrito las funciones anteriores rellenando los
«casilleros» del siguiente <em>patrón general</em>:</p>
<div class="line-block"><span
style="color:teal">⟨<em>nombre</em>⟩</span> =
<strong><code>lambda</code></strong> a, b: 0
<strong><code>if</code></strong> a &gt; b
<strong><code>else</code></strong> <span
style="color:teal">⟨<em>término</em>⟩</span>(a) + <span
style="color:teal">⟨<em>nombre</em>⟩</span>(a + 1, b)</div></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.5">

<ul>
<li><p>La existencia de este patrón común nos demuestra que hay una
abstracción esperando que la saquemos a la superficie.</p></li>
<li><p>De hecho, los matemáticos han identificado hace mucho tiempo esta
abstracción llamándola <strong>sumatorio de una serie</strong>, y la
expresan así: <span class="math display"> \sum _ {n=a}^b f(n)</span></p>
<p>La ventaja que tiene usar la notación anterior es que podemos
trabajar directamente con el concepto de sumatorio en vez de trabajar
con sumas concretas, y podemos sacar conclusiones generales sobre los
sumatorios independientemente de la serie particular con la que estemos
trabajando.</p></li>
<li><p>Igualmente, como programadores estamos interesados en que nuestro
lenguaje tenga la suficiente potencia como para describir directamente
el concepto de sumatorio, en vez de funciones particulares que calculen
sumas concretas.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.6">

<ul>
<li><p>En programación funcional lo conseguimos creando funciones que
conviertan los «casilleros» en parámetros que recibirían funciones:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>suma <span class="op">=</span> <span class="kw">lambda</span> term, a, b: <span class="dv">0</span> <span class="cf">if</span> a <span class="op">&gt;</span> b <span class="cf">else</span> term(a) <span class="op">+</span> suma(term, a <span class="op">+</span> <span class="dv">1</span>, b)</span></code></pre></div></li>
<li><p>De esta forma, las dos funciones <code
class="sourceCode python">suma_enteros</code> y <code
class="sourceCode python">suma_cubos</code> anteriores se podrían
definir en términos de esta <code
class="sourceCode python">suma</code>:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>suma_enteros <span class="op">=</span> <span class="kw">lambda</span> a, b: suma(<span class="kw">lambda</span> x: x, a, b)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>suma_cubos <span class="op">=</span> <span class="kw">lambda</span> a, b: suma(<span class="kw">lambda</span> x: x <span class="op">*</span> x <span class="op">*</span> x, a, b)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># O mejor aún:</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>suma_cubos <span class="op">=</span> <span class="kw">lambda</span> a, b: suma(cubo, a, b)</span></code></pre></div></li>
<li><p><code>suma</code> es una abstracción que captura el patrón común
que comparten <code>suma_enteros</code> y <code>suma_cubos</code>, las
cuales también son abstracciones que capturan sus respectivos patrones
comunes.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.1.0.0.7">

<div class="centered">
<figure>
<img data-src="images/de-particular-a-funciones-de-orden-superior.svg"
class="plain" style="width:90.0%"
alt="El camino de subida hacia una abstracción cada vez mayor" />
<figcaption aria-hidden="true">El camino de subida hacia una abstracción
cada vez mayor</figcaption>
</figure>
</div>
</section>
<section id="ejercicio-1" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="2" class="example" type="1">
<li>¿Se podría generalizar aún más la función <code
class="sourceCode python">suma</code>?</li>
</ol>
</section>

<section id="map" class="title-slide slide level2" data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span>
<code>map</code></h2>
<ul>
<li>Supongamos que queremos escribir una función que, dada una tupla de
números, nos devuelva otra tupla con los mismos números elevados al
cubo.</li>
</ul>
</section>
<section id="ejercicio-2" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="3" class="example" type="1">
<li>Inténtalo.</li>
</ol>
</section>
<section class="slide level5" data-number="3.2.0.0.1">

<ul>
<li><p>Una forma de hacerlo sería:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>elevar_cubo <span class="op">=</span> <span class="kw">lambda</span> t: () <span class="cf">if</span> t <span class="op">==</span> () <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                        (cubo(t[<span class="dv">0</span>]),) <span class="op">+</span> elevar_cubo(t[<span class="dv">1</span>:])</span></code></pre></div></li>
<li><p>¿Y elevar a la cuarta potencia?</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>elevar_cuarta <span class="op">=</span> <span class="kw">lambda</span> t: () <span class="cf">if</span> t <span class="op">==</span> () <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                          ((<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">4</span>)(t[<span class="dv">0</span>]),) <span class="op">+</span> elevar_cuarta(t[<span class="dv">1</span>:])</span></code></pre></div></li>
<li><p>Es evidente que hay un patrón subyacente que se podría abstraer
creando una función de orden superior que aplique una función <code
class="sourceCode python">f</code> a los elementos de una tupla y
devuelva la tupla resultante.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.2">

<ul>
<li><p>Esa función se llama <code
class="sourceCode python"><span class="bu">map</span></code>, y viene
definida en Python con la siguiente signatura:</p>
<div class="caja">
<p><span
class="math inline">\texttt{map(\(func\),\;\(iterable\))\;-&gt;\;Iterator}</span></p>
</div>
<p>donde:</p>
<ul>
<li><p><em>func</em> debe ser una función de un solo argumento.</p></li>
<li><p><em>iterable</em> puede ser cualquier cosa compuesta de elementos
que se puedan recorrer de uno en uno, como una <strong>tupla</strong>,
una <strong>cadena</strong> o un <strong>rango</strong> (cualquier
<em>secuencia</em> de elementos nos vale).</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="3.2.0.0.3">

<ul>
<li><p>Podemos usarla así:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">map</span>(cubo, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="bu">map</span> <span class="bu">object</span> at <span class="bn">0x7f22b25e9d68</span><span class="op">&gt;</span></span></code></pre></div></li>
<li><p>Lo que devuelve no es una tupla, sino un objeto
<strong>iterador</strong> que examinaremos con más detalle más
adelante.</p></li>
<li><p>Por ahora, nos basta con saber que un iterador es un flujo de
datos que se pueden recorrer de uno en uno.</p></li>
<li><p>Lo que haremos aquí será transformar ese iterador en la tupla
correspondiente usando la función <code
class="sourceCode python"><span class="bu">tuple</span></code> sobre el
resultado de <code
class="sourceCode python"><span class="bu">map</span></code>:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">map</span>(cubo, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">64</span>)</span></code></pre></div></li>
<li><p>Además de una tupla, también podemos usar un rango como argumento
para <code
class="sourceCode python"><span class="bu">map</span></code>:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">map</span>(cubo, <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5</span>)))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">64</span>)</span></code></pre></div></li>
<li><p>¿Cómo definirías la función <code
class="sourceCode python"><span class="bu">map</span></code> de forma
que devolviera una tupla?</p></li>
</ul>
</section>
<section id="ejercicio-3" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="4" class="example" type="1">
<li>Inténtalo.</li>
</ol>
</section>
<section class="slide level5" data-number="3.2.0.0.4">

<ul>
<li><p>Podríamos definirla así:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">map</span> <span class="op">=</span> <span class="kw">lambda</span> f, t: () <span class="cf">if</span> t <span class="op">==</span> () <span class="cf">else</span> (f(t[<span class="dv">0</span>]),) <span class="op">+</span> <span class="bu">map</span>(f, t[<span class="dv">1</span>:])</span></code></pre></div></li>
</ul>
</section>

<section id="filter" class="title-slide slide level2" data-number="3.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span>
<code>filter</code></h2>
<ul>
<li><p><code
class="sourceCode python"><span class="bu">filter</span></code> es una
<strong>función de orden superior</strong> que devuelve aquellos
elementos de una tupla (o cualquier cosa <em>iterable</em>) que cumplen
una determinada condición.</p></li>
<li><p>Su signatura es:</p>
<div class="caja">
<p><span
class="math inline">\texttt{filter(\(function\),\;\(iterable\))\;-&gt;\;Iterator}</span></p>
</div>
<p>donde <em>function</em> debe ser una función de un solo argumento que
devuelva un <em>booleano</em>.</p></li>
<li><p>Como <code
class="sourceCode python"><span class="bu">map</span></code>, también
devuelve un <em>iterador</em>, que se puede convertir a tupla con la
función <code
class="sourceCode python"><span class="bu">tuple</span></code>.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">0</span>, (<span class="op">-</span><span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">9</span>)))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span></code></pre></div></li>
</ul>
</section>

<section id="reduce" class="title-slide slide level2" data-number="3.4">
<h2 data-number="3.4"><span class="header-section-number">3.4</span>
<code>reduce</code></h2>
<ul>
<li><p><code
class="sourceCode python"><span class="bu">reduce</span></code> es una
<strong>función de orden superior</strong> que aplica, de forma
<em>acumulativa</em>, una función a todos los elementos de una tupla (en
general, a cualquier objeto <em>iterable</em>).</p></li>
<li><p>Captura un <strong>patrón muy frecuente</strong> de recursión
sobre secuencias.</p></li>
<li><p>Por ejemplo, para calcular la suma de todos los elementos de una
tupla, haríamos:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma <span class="op">=</span> <span class="kw">lambda</span> t: <span class="dv">0</span> <span class="cf">if</span> t <span class="op">==</span> () <span class="cf">else</span> t[<span class="dv">0</span>] <span class="op">+</span> suma(t[<span class="dv">1</span>:])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> suma((<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div></li>
<li><p>Y para calcular el producto:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> producto <span class="op">=</span> <span class="kw">lambda</span> t: <span class="dv">1</span> <span class="cf">if</span> t <span class="op">==</span> () <span class="cf">else</span> t[<span class="dv">0</span>] <span class="op">*</span> producto(t[<span class="dv">1</span>:])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> producto((<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span></span></code></pre></div></li>
<li><p>Como podemos observar, la estrategia de cálculo es esencialmente
la misma; sólo se diferencian en la <em>operación</em> a realizar
(<code>+</code> o <code>*</code>) y en el <em>valor inicial</em> o
<em>elemento neutro</em> (<code
class="sourceCode python"><span class="dv">0</span></code> o <code
class="sourceCode python"><span class="dv">1</span></code>).</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.1">

<ul>
<li><p>Si abstraemos ese patrón común, podemos crear una función de
orden superior que capture la idea de <strong>reducir todos los
elementos de una tupla (o cualquier iterable) a un único
valor</strong>.</p></li>
<li><p>Eso es lo que hace la función <code
class="sourceCode python"><span class="bu">reduce</span></code>.</p></li>
<li><p>Su signatura es:</p>
<div class="caja">
<p><span
class="math inline">\texttt{reduce(\(function\),\;\(sequence\)\;\([\),\;\(initial\)\(]\))\;-&gt;\;Any}</span></p>
</div>
<p>donde:</p>
<ul>
<li><p><em>function</em> debe ser una función que reciba dos
argumentos.</p></li>
<li><p><em>sequence</em> debe ser cualquier objeto iterable
(normalmente, una secuencia como una cadena, una tupla o un
rango).</p></li>
<li><p><em>initial</em>, si se indica, se usará como primer elemento
sobre el que realizar el cálculo y servirá como valor por defecto cuando
la secuencia esté vacía (si no se indica y la secuencia está vacía,
generará un error).</p></li>
</ul></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.2">

<ul>
<li><p>Para usarla, primero tenemos que <em>importarla</em> del
<em>módulo</em> <code class="sourceCode python">functools</code>:</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span></code></pre></div></li>
<li><p>No es la primera vez que importamos un módulo. Ya lo hicimos con
el módulo <code class="sourceCode python">math</code>.</p></li>
<li><p>En su momento estudiaremos con detalle qué son los módulos. Por
ahora nos basta con lo que ya sabemos: que contienen definiciones que
podemos incorporar a nuestros <em>scripts</em>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.3">

<ul>
<li><p>Por ejemplo, para calcular la suma y el producto de <code
class="sourceCode python">(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</code>,
podemos definir las funciones <code>suma_de_numeros</code> y
<code>producto_de_numeros</code> a partir de <code>reduce</code>:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>tupla <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>suma_de_numeros <span class="op">=</span> <span class="kw">lambda</span> tupla: <span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y, tupla, <span class="dv">0</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>producto_de_numeros <span class="op">=</span> <span class="kw">lambda</span> tupla: <span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">*</span> y, tupla, <span class="dv">1</span>)</span></code></pre></div></li>
<li><p>También podemos importar y usar las funciones <code>add</code> y
<code>mul</code> del módulo <code>operator</code>, las cuales actúan,
respectivamente, como el operador <code>+</code> y <code>*</code>:</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> operator <span class="im">import</span> add, mul</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>tupla <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>suma_de_numeros <span class="op">=</span> <span class="kw">lambda</span> tupla: <span class="bu">reduce</span>(add, tupla, <span class="dv">0</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>producto_de_numeros <span class="op">=</span> <span class="kw">lambda</span> tupla: <span class="bu">reduce</span>(mul, tupla, <span class="dv">1</span>)</span></code></pre></div>
<p>De esta forma, usamos <code>add</code> y <code>mul</code> en lugar de
las expresiones lambda <code
class="sourceCode python">(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y)</code>
y <code
class="sourceCode python">(<span class="kw">lambda</span> x, y: x <span class="op">*</span> y)</code>,
respectivamente.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.4">

<ul>
<li><p>En general, si <span class="math inline">iterable</span>
representa un objeto iterable que contiene los elementos <span
class="math inline">e_1, e_2, \ldots, e_n</span> (en este orden),
entonces tenemos que: <span
class="math display">\texttt{reduce(\(f\),\;\(iterable\),\;\(ini\))} =
f(\ldots{}f(f(f(ini, e_1), e_2), e_3), \ldots, e_n)</span></p></li>
<li><p>Por ejemplo, la siguiente llamada a <code>reduce</code>:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">reduce</span>(add, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">0</span>)</span></code></pre></div>
<p>realiza y devuelve el resultado del siguiente cálculo:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>add(add(add(add(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>), <span class="dv">3</span>), <span class="dv">4</span>)</span></code></pre></div>
<p>lo que, en la práctica, equivale a:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>((((<span class="dv">0</span> <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">4</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.5">

<ul>
<li><p>Si <span class="math inline">iterable</span> representa un
<strong>iterable vacío</strong>, entonces:</p>
<p><span
class="math display">\texttt{reduce(\(f\),\;\(iterable\),\;\(ini\))} =
ini</span></p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">reduce</span>(add, (), <span class="dv">0</span>)</span></code></pre></div>
<p>devuelve directamente <code
class="sourceCode python"><span class="dv">0</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.6">

<ul>
<li><p>Si <strong>no se indica un valor inicial</strong>, tenemos que:
<span class="math display">\texttt{reduce(\(f\),\;\((e_1, e_2, \ldots,
e_n)\))} = f(\ldots{}f(f(e_1, e_2), e_3), \ldots, e_n)</span></p>
<p>Es decir: se usará el primer elemento del iterable como valor
inicial.</p></li>
<li><p>Por ejemplo, la siguiente llamada a <code>reduce</code>:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">reduce</span>(add, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span></code></pre></div>
<p>realiza y devuelve el resultado del siguiente cálculo:</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>add(add(add(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">3</span>), <span class="dv">4</span>)</span></code></pre></div>
<p>lo que, en la práctica, equivale a:</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(((<span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">4</span>)</span></code></pre></div></li>
<li><p>Pero si el iterable es <strong>vacío</strong>, dará un error:</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">reduce</span>(add, ())</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: <span class="bu">reduce</span>() of empty iterable <span class="cf">with</span> no initial value</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.7">

<ul>
<li><p>Con lo que acabamos de ver, se demuestra que la implementación de
la función <code>reduce</code> en Python va reduciendo <strong>de
izquierda a derecha</strong> y que, por tanto, las operaciones se hacen
agrupándose <strong>por la izquierda</strong>.</p></li>
<li><p>Esto es algo que debemos tener muy en cuenta a la hora de diseñar
la función que se le pasa a <code>reduce</code>.</p></li>
<li><p>Se denomina <strong>iteración</strong> a cada paso que da la
función <code>reduce</code>, es decir, cada vez que <code>reduce</code>
visita un nuevo elemento del iterable (la tupla, cadena o lo que sea) y
aplica la función para calcular el resultado parcial.</p></li>
<li><p>Esa función, como ya dijimos antes, debe tener dos parámetros,
pero de forma que, en cada iteración:</p>
<ol>
<li><p>Su primer parámetro va a contener siempre el valor parcial
acumulado hasta ahora (por tanto, es un <em>acumulador</em>).</p></li>
<li><p>Su segundo parámetro va a contener el valor del elemento que en
este momento está visitando <code>reduce</code>.</p></li>
</ol></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.8">

<ul>
<li><p>Por tanto, es frecuente que el primer parámetro de esa función se
llame <code>acc</code> o algo similar, para expresar el hecho de que ahí
se va recibiendo el valor acumulado hasta el momento.</p></li>
<li><p>Por ejemplo, en la siguiente llamada:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">reduce</span>(<span class="kw">lambda</span> acc, e: acc <span class="op">+</span> e, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">0</span>)</span></code></pre></div>
<ul>
<li><p><code>acc</code> va a contener la suma parcial acumulada hasta
ahora.</p></li>
<li><p><code>e</code> va a contener el elemento que en este momento se
está visitando.</p></li>
</ul>
<p>Así, durante la ejecución del <code>reduce</code>, ésta provocará las
siguientes llamadas a la expresión lambda:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">lambda</span> acc, e: acc <span class="op">+</span> e)(<span class="dv">0</span>, <span class="dv">1</span>)   <span class="co"># acc = 0, e = 1</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">lambda</span> acc, e: acc <span class="op">+</span> e)(<span class="dv">1</span>, <span class="dv">2</span>)   <span class="co"># acc = 1, e = 2</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>(<span class="kw">lambda</span> acc, e: acc <span class="op">+</span> e)(<span class="dv">3</span>, <span class="dv">3</span>)   <span class="co"># acc = 3, e = 3</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>(<span class="kw">lambda</span> acc, e: acc <span class="op">+</span> e)(<span class="dv">6</span>, <span class="dv">4</span>)   <span class="co"># acc = 6, e = 4</span></span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.4.0.0.9">

<ul>
<li>¿Cómo podríamos definir la función <code
class="sourceCode python"><span class="bu">reduce</span></code> si
recibiera una tupla y no cualquier iterable?</li>
</ul>
</section>
<section id="ejercicio-4" class="slide level5 unnumbered unlisted">
<h5 class="unnumbered unlisted">Ejercicio</h5>
<ol start="5" class="example" type="1">
<li>Inténtalo.</li>
</ol>
</section>
<section class="slide level5" data-number="3.4.0.0.10">

<ul>
<li><p>Una forma (con valor inicial obligatorio) podría ser así:</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">reduce</span> <span class="op">=</span> <span class="kw">lambda</span> fun, tupla, ini: ini <span class="cf">if</span> tupla <span class="op">==</span> () <span class="cf">else</span> <span class="op">\</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="bu">reduce</span>(fun, tupla[<span class="dv">1</span>:], fun(ini, tupla[<span class="dv">0</span>]))</span></code></pre></div></li>
</ul>
</section>

<section id="expresiones-generadoras" class="title-slide slide level2"
data-number="3.5">
<h2 data-number="3.5"><span class="header-section-number">3.5</span>
Expresiones generadoras</h2>
<ul>
<li><p>Dos operaciones que se realizan con frecuencia sobre una
estructura iterable son:</p>
<ul>
<li><p>Realizar alguna operación sobre cada elemento (<code
class="sourceCode python"><span class="bu">map</span></code>).</p></li>
<li><p>Seleccionar un subconjunto de elementos que cumplan alguna
condición (<code
class="sourceCode python"><span class="bu">filter</span></code>).</p></li>
</ul></li>
<li><p>Las <strong>expresiones generadoras</strong> son una notación
copiada del lenguaje Haskell que nos permite realizar ambas operaciones
de una forma muy concisa.</p></li>
<li><p>El resultado que devuelve es un iterador que (como ya sabemos)
podemos convertir fácilmente en una tupla usando la función <code
class="sourceCode python"><span class="bu">tuple</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.5.0.0.1">

<ul>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(x <span class="op">**</span> <span class="dv">3</span> <span class="cf">for</span> x <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">64</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># equivale a:</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">3</span>, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">64</span>)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(x <span class="cf">for</span> x <span class="kw">in</span> (<span class="op">-</span><span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">9</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># equivale a:</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">0</span>, (<span class="op">-</span><span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">8</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">9</span>)))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.5.0.0.2">

<ul>
<li><p>Su sintaxis es:</p>
<div class="line-block"><span
style="color:teal">⟨<em>expr_gen</em>⟩</span> ::=
<strong><code>(</code></strong><span
style="color:teal">⟨<em>expresión</em>⟩</span>
(<strong><code>for</code></strong> <span
style="color:teal">⟨<em>identificador</em>⟩</span>
<strong><code>in</code></strong> <span
style="color:teal">⟨<em>secuencia</em>⟩</span>
[<strong><code>if</code></strong> <span
style="color:teal">⟨<em>condición</em>⟩</span>])<span
class="math inline">^+</span><strong><code>)</code></strong></div></li>
<li><p>Los elementos de la salida generada serán los sucesivos valores
de <span style="color:teal">⟨<em>expresión</em>⟩</span>.</p></li>
<li><p>Las cláusulas <strong><code>if</code></strong> son opcionales. Si
están, la <span style="color:teal">⟨<em>expresión</em>⟩</span> sólo se
evaluará y añadirá al resultado cuando se cumpla la <span
style="color:teal">⟨<em>condición</em>⟩</span>.</p></li>
<li><p>Los paréntesis <code>(</code> y <code>)</code> alrededor de la
expresión generadora se pueden quitar si la expresión se usa como único
argumento de una función.</p></li>
<li><p>Por ejemplo:</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sec1 <span class="op">=</span> <span class="st">&#39;abc&#39;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sec2 <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">tuple</span>((x, y) <span class="cf">for</span> x <span class="kw">in</span> sec1 <span class="cf">for</span> y <span class="kw">in</span> sec2)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>((<span class="st">&#39;a&#39;</span>, <span class="dv">1</span>), (<span class="st">&#39;a&#39;</span>, <span class="dv">2</span>), (<span class="st">&#39;a&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a> (<span class="st">&#39;b&#39;</span>, <span class="dv">1</span>), (<span class="st">&#39;b&#39;</span>, <span class="dv">2</span>), (<span class="st">&#39;b&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a> (<span class="st">&#39;c&#39;</span>, <span class="dv">1</span>), (<span class="st">&#39;c&#39;</span>, <span class="dv">2</span>), (<span class="st">&#39;c&#39;</span>, <span class="dv">3</span>))</span></code></pre></div></li>
</ul>
</section>
<section class="slide level5" data-number="3.5.0.0.3">

<ul>
<li><p>Las expresiones generadoras, al igual que las expresiones lambda,
<strong>determinan su propio <em>ámbito</em></strong>.</p></li>
<li><p>Ese ámbito abarca toda la expresión generadora, de principio a
fin.</p></li>
<li><p>Los identificadores que aparecen en la cláusula <code
class="sourceCode python"><span class="cf">for</span></code> se
consideran <em>variables ligadas</em> en la expresión
generadora.</p></li>
<li><p>Esos identificadores se van ligando, uno a uno, a cada elemento
de la secuencia indicada en la cláusula <code
class="sourceCode python"><span class="kw">in</span></code>.</p></li>
</ul>
</section>
<section class="slide level5" data-number="3.5.0.0.4">

<ul>
<li><p>Como son variables ligadas, cumplen estas dos propiedades:</p>
<ul>
<li><p>Se pueden renombrar (siempre de forma consistente) sin que la
expresión cambie su significado.</p>
<p>Por ejemplo, las dos expresiones generadoras siguientes son
equivalentes, puesto que producen el mismo resultado:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(x <span class="cf">for</span> x <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(y <span class="cf">for</span> y <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div></li>
<li><p>No se pueden usar fuera de la expresión generadora, ya que
estarían fuera de su ámbito y no serían visibles.</p>
<p>Por ejemplo, lo siguiente daría un error de nombre:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> e <span class="op">=</span> (x <span class="cf">for</span> x <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x       <span class="co"># Intento acceder a la &#39;x&#39; de la expresión generadora</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="pp">NameError</span>: name <span class="st">&#39;x&#39;</span> <span class="kw">is</span> <span class="kw">not</span> defined</span></code></pre></div></li>
</ul></li>
</ul>
</section>
</section>
<section id="bibliografía"
class="title-slide slide level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Bibliografía</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-abelson_structure_1996" class="csl-entry" role="listitem">
Abelson, Harold, Gerald Jay Sussman, and Julie Sussman. 1996.
<em>Structure and Interpretation of Computer Programs</em>. 2nd ed.
Cambridge, Mass. : New York: MIT Press ; McGraw-Hill.
</div>
</div>
</section>
    </div>
  </div>

  <script src="./reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="./reveal.js/plugin/notes/notes.js"></script>
  <script src="./reveal.js/plugin/search/search.js"></script>
  <script src="./reveal.js/plugin/zoom/zoom.js"></script>
  <script src="./reveal.js/plugin/reveal.js-menu/menu.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 1080,
        // The display mode that will be used to show slides
        display: 'block',

        menu: {
          hideMissingTitles: true,
        },

        dependencies: [
          { src: './reveal.js/plugin/reveal.js-quiz/quiz/js/quiz.js', async: true, callback: function() { prepareQuizzes({preventUnanswered: true, checkAnswerText: 'Comprueba la respuesta', nextQuestionText: 'Siguiente &raquo;', backButtonText: '&laquo; Anterior', tryAgainText: 'Prueba de nuevo', preventUnansweredText: 'Selecciona una respuesta', questionCountText: 'Pregunta %current de %total', skipStartButton: true}); } }
        ],

        // reveal.js plugins
        plugins: [
          RevealMenu,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="text/javascript">
       var title = document.getElementsByClassName('title')[0];
       title = title != null ? title.innerHTML : '';
       var author = document.getElementsByClassName('author')[0];
       author = author != null ? author.innerHTML : '';
       var date = document.getElementsByClassName('date')[0];
       date = date != null ? date.innerHTML : '';
       document.getElementById('header-left').innerHTML = '<a href="#/title-slide">' + title + '</a>';
       document.getElementById('footer-left').innerHTML = '<a href="https://pro.iesdonana.org">&copy; ' + author + ' (' + date + ')</a>';

       function updateHeader(nd) {
           var hr = document.getElementById('header-right');
           while (hr.children.length > 0) {
               hr.removeChild(hr.lastChild);
           }
           buscar(nd, 3, hr);
           buscar(nd, 2, hr);
           buscar(nd, 1, hr);
           hr.style.fontSize = Math.round(50 * Reveal.getScale()) + '%';
           hr.style.fontSize = Math.max(Number.parseInt(getComputedStyle(hr).fontSize), 12) + 'px';
           var hl = document.getElementById('header-left');
           hl.style.fontSize = hr.style.fontSize;
       }

       function buscar(nd, level, hr) {
           if (!nd.classList.contains('level' + (level - 1))) {
               for (var n = nd; n != null; n = n.previousSibling) {
                   if (n.nodeType == Node.TEXT_NODE) {
                       continue;
                   }
                   var cl = n.classList;
                   if (cl.contains('level' + level)) {
                       var h = n.querySelector('h' + level);
                   } else if (cl.contains('level' + (level - 1))) {
                       break;
                   } else {
                       continue;
                   }
                   if (h == null || Reveal.getCurrentSlide().id == 'title-slide') {
                       hr.innerHTML = '';
                   } else {
                       var el = document.createElement('a');
                       var href = '#/' + n.id;
                       el.href = href;
                       el.innerHTML = h.innerHTML;
                       var a = el.querySelector('a');
                       if (a !== null) {
                           a.href = href;
                       }
                       if (hr.innerHTML != '') {
                           hr.innerHTML = ' &mdash; ' + hr.innerHTML;
                       }
                       hr.insertBefore(el, hr.firstChild);
                   }
                   break;
               }
           }
       }

       // On Reveal.js ready event, copy header/footer <div>
       // into each `.slide-background` <div>
       Reveal.on('ready', event => {
           var header = document.getElementById('header');
           document.querySelector('.reveal').appendChild(header);
           updateHeader(Reveal.getCurrentSlide());
       });

       Reveal.on('slidechanged', event => {
           // event.previousSlide, event.currentSlide, event.indexh, event.indexv
           updateHeader(event.currentSlide);
       });
    </script>
    </body>
</html>
